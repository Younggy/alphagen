[25425:MainThread](2024-01-03 09:30:54,331) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[25425:MainThread](2024-01-03 09:30:54,627) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[25425:MainThread](2024-01-03 09:30:54,627) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/Users/yangguangyu/.qlib/qlib_data/cn_data_rolling')}
instruments: hs300
df before:                             $open      $close  ...     $psttm     $turn
datetime   instrument                          ...                     
2014-08-06 SH600000     36.678059   36.342247  ...   1.720402  0.901515
           SH600009     15.457175   15.367242  ...   4.889094  0.833367
           SH600010      4.297257    4.641038  ...   1.049635  3.491852
           SH600011      7.163883    7.211963  ...   0.627584  0.171663
           SH600015     12.955123   13.058764  ...   1.676678  0.649496
...                           ...         ...  ...        ...       ...
2019-02-19 SZ300661    107.945366  107.527779  ...  10.980824  1.395842
           SZ300750     84.660004   82.290001  ...   6.650053  4.338807
           SZ300751    174.140717  175.225296  ...  13.278975  8.478977
           SZ300759     31.355343   31.355343  ...   7.607547  0.926154
           SZ300760    114.797508  115.075615  ...  10.744785  3.528142

[251929 rows x 15 columns]
df: instrument                SH600000      SH600009  ...   SZ300759    SZ300760
datetime                                          ...                       
2014-08-06 $open      3.667806e+01  1.545718e+01  ...        NaN         NaN
           $close     3.634225e+01  1.536724e+01  ...        NaN         NaN
           $high      3.667806e+01  1.545718e+01  ...        NaN         NaN
           $low       3.604375e+01  1.523234e+01  ...        NaN         NaN
           $volume    3.605535e+07  8.106222e+06  ...        NaN         NaN
...                            ...           ...  ...        ...         ...
2019-02-19 $pctchg   -3.690030e-01  2.405108e+00  ...  10.003500    0.695292
           $pettm     5.669465e+00  2.541715e+01  ...  67.416687   40.336884
           $preclose  6.377191e+01  6.418536e+01  ...  28.503950  114.281029
           $psttm     1.847958e+00  1.172866e+01  ...   7.607547   10.744785
           $turn      9.234600e-02  7.945550e-01  ...   0.926154    3.528142

[16575 rows x 254 columns]
features: ['$open', '$close', '$high', '$low', '$volume', '$vwap', '$amount', '$isst', '$pbmrq', '$pcfncfttm', '$pctchg', '$pettm', '$preclose', '$psttm', '$turn']
dates: DatetimeIndex(['2014-08-06', '2014-08-07', '2014-08-08', '2014-08-11',
               '2014-08-12', '2014-08-13', '2014-08-14', '2014-08-15',
               '2014-08-18', '2014-08-19',
               ...
               '2019-01-30', '2019-01-31', '2019-02-01', '2019-02-11',
               '2019-02-12', '2019-02-13', '2019-02-14', '2019-02-15',
               '2019-02-18', '2019-02-19'],
              dtype='datetime64[ns]', name='datetime', length=1105, freq=None)
stock ids: Index(['SH600000', 'SH600009', 'SH600010', 'SH600011', 'SH600015', 'SH600016',
       'SH600018', 'SH600019', 'SH600023', 'SH600025',
       ...
       'SZ300450', 'SZ300454', 'SZ300496', 'SZ300498', 'SZ300628', 'SZ300661',
       'SZ300750', 'SZ300751', 'SZ300759', 'SZ300760'],
      dtype='object', name='instrument', length=254)
values: [[[3.66780586e+01 1.54571753e+01 4.29725742e+00 ...            nan
              nan            nan]
  [3.63422470e+01 1.53672419e+01 4.64103794e+00 ...            nan
              nan            nan]
  [3.66780586e+01 1.54571753e+01 4.75226116e+00 ...            nan
              nan            nan]
  ...
  [3.68273048e+01 1.54459333e+01 4.32759094e+00 ...            nan
              nan            nan]
  [1.72040200e+00 4.88909388e+00 1.04963505e+00 ...            nan
              nan            nan]
  [9.01515007e-01 8.33366990e-01 3.49185205e+00 ...            nan
              nan            nan]]

 [[3.63795586e+01 1.53784838e+01 4.99492979e+00 ...            nan
              nan            nan]
  [3.56706238e+01 1.52323427e+01 5.10615301e+00 ...            nan
              nan            nan]
  [3.64914970e+01 1.54234505e+01 5.10615301e+00 ...            nan
              nan            nan]
  ...
  [3.63422470e+01 1.53672419e+01 4.64103794e+00 ...            nan
              nan            nan]
  [1.68860805e+00 4.84617615e+00 1.15482795e+00 ...            nan
              nan            nan]
  [9.46501017e-01 8.21012020e-01 7.58347321e+00 ...            nan
              nan            nan]]

 [[3.56706238e+01 1.52211018e+01 4.95448494e+00 ...            nan
              nan            nan]
  [3.55959969e+01 1.52773094e+01 4.93426275e+00 ...            nan
              nan            nan]
  [3.58198738e+01 1.53335171e+01 5.02526331e+00 ...            nan
              nan            nan]
  ...
  [3.56706238e+01 1.52323427e+01 5.10615301e+00 ...            nan
              nan            nan]
  [1.68507600e+00 4.86048222e+00 1.11595201e+00 ...            nan
              nan            nan]
  [8.10725987e-01 4.42577988e-01 4.87579823e+00 ...            nan
              nan            nan]]

 ...

 [[6.34189339e+01 6.41853638e+01 4.41548395e+00 ... 1.70946655e+02
   2.59117756e+01 1.14430016e+02]
  [6.27129707e+01 6.27140007e+01 4.35887527e+00 ... 1.69155594e+02
   2.59117756e+01 1.12383957e+02]
  [6.38307419e+01 6.51140137e+01 4.41548395e+00 ... 1.75135742e+02
   2.59117756e+01 1.14867035e+02]
  ...
  [6.36542511e+01 6.41491852e+01 4.41548395e+00 ... 1.70976501e+02
   2.35588779e+01 1.14956421e+02]
  [1.82400298e+00 1.11906490e+01 1.04670405e+00 ... 1.28189993e+01
   6.28680897e+00 1.04934607e+01]
  [6.31899983e-02 7.11853981e-01 5.23764014e-01 ... 6.44486904e+00
   6.34297013e-01 2.12021899e+00]]

 [[6.32424431e+01 6.35341072e+01 4.38717937e+00 ... 1.68737686e+02
   2.85039501e+01 1.12413757e+02]
  [6.37719116e+01 6.41853638e+01 4.47209263e+00 ... 1.72140701e+02
   2.85039501e+01 1.14281029e+02]
  [6.39484024e+01 6.48607483e+01 4.47209263e+00 ... 1.73901901e+02
   2.85039501e+01 1.14966354e+02]
  ...
  [6.27129707e+01 6.27140007e+01 4.35887527e+00 ... 1.69155594e+02
   2.59117756e+01 1.12383957e+02]
  [1.85480297e+00 1.14531994e+01 1.07389104e+00 ... 1.30452166e+01
   6.91573191e+00 1.06705933e+01]
  [7.15290010e-02 8.19362998e-01 9.38498974e-01 ... 5.58933783e+00
   5.89383006e-01 2.88191009e+00]]

 [[6.38307419e+01 6.44989395e+01 4.44378853e+00 ... 1.74140717e+02
   3.13553429e+01 1.14797508e+02]
  [6.35365944e+01 6.57290955e+01 4.47209263e+00 ... 1.75225296e+02
   3.13553429e+01 1.15075615e+02]
  [6.44778748e+01 6.72487030e+01 4.55700588e+00 ... 1.82747742e+02
   3.13553429e+01 1.19485550e+02]
  ...
  [6.37719116e+01 6.41853638e+01 4.47209263e+00 ... 1.72140701e+02
   2.85039501e+01 1.14281029e+02]
  [1.84795797e+00 1.17286606e+01 1.07389104e+00 ... 1.32789745e+01
   7.60754681e+00 1.07447853e+01]
  [9.23459977e-02 7.94555008e-01 1.14241803e+00 ... 8.47897720e+00
   9.26154017e-01 3.52814198e+00]]], (1105, 15, 254)
instruments: hs300
df before:                             $open      $close  ...     $psttm      $turn
datetime   instrument                          ...                      
2018-08-03 SH600000     57.594746   57.830067  ...   1.745467   0.060483
           SH600009     74.151337   71.261703  ...  13.612852   0.662246
           SH600010      4.528701    4.472093  ...   1.285209   0.548638
           SH600011     10.894892   10.532657  ...   0.703142   0.260177
           SH600015     17.312105   17.288551  ...   1.426968   0.077760
...                           ...         ...  ...        ...        ...
2020-02-20 SZ300751    210.300003  221.039993  ...   9.349808   4.972300
           SZ300759     62.450001   61.599998  ...  13.984790   1.604300
           SZ300760    234.800003  234.990005  ...  18.020260   0.970900
           SZ300763     76.010002   81.680000  ...   6.418219  26.974701
           SZ300782    511.200012  551.090027  ...  49.872787   6.694400

[95573 rows x 15 columns]
df: instrument                SH600000      SH600009  ...   SZ300763    SZ300782
datetime                                          ...                       
2018-08-03 $open      5.759475e+01  7.415134e+01  ...        NaN         NaN
           $close     5.783007e+01  7.126170e+01  ...        NaN         NaN
           $high      5.871252e+01  7.482001e+01  ...        NaN         NaN
           $low       5.741825e+01  7.104678e+01  ...        NaN         NaN
           $volume    2.889323e+06  6.064585e+06  ...        NaN         NaN
...                            ...           ...  ...        ...         ...
2020-02-20 $pctchg    1.080100e+00  2.386200e+00  ...  10.006700    5.978900
           $pettm     5.595285e+00  2.796421e+01  ...  59.519810  158.490768
           $preclose  6.739198e+01  8.761156e+01  ...  74.250000  520.000000
           $psttm     1.728603e+00  1.339021e+01  ...   6.418219   49.872787
           $turn      1.304000e-01  1.518800e+00  ...  26.974701    6.694400

[5610 rows x 265 columns]
features: ['$open', '$close', '$high', '$low', '$volume', '$vwap', '$amount', '$isst', '$pbmrq', '$pcfncfttm', '$pctchg', '$pettm', '$preclose', '$psttm', '$turn']
dates: DatetimeIndex(['2018-08-03', '2018-08-06', '2018-08-07', '2018-08-08',
               '2018-08-09', '2018-08-10', '2018-08-13', '2018-08-14',
               '2018-08-15', '2018-08-16',
               ...
               '2020-02-07', '2020-02-10', '2020-02-11', '2020-02-12',
               '2020-02-13', '2020-02-14', '2020-02-17', '2020-02-18',
               '2020-02-19', '2020-02-20'],
              dtype='datetime64[ns]', name='datetime', length=374, freq=None)
stock ids: Index(['SH600000', 'SH600009', 'SH600010', 'SH600011', 'SH600015', 'SH600016',
       'SH600018', 'SH600019', 'SH600023', 'SH600025',
       ...
       'SZ300496', 'SZ300498', 'SZ300628', 'SZ300661', 'SZ300750', 'SZ300751',
       'SZ300759', 'SZ300760', 'SZ300763', 'SZ300782'],
      dtype='object', name='instrument', length=265)
values: [[[5.7594746e+01 7.4151337e+01 4.5287013e+00 ...           nan
             nan           nan]
  [5.7830067e+01 7.1261703e+01 4.4720926e+00 ...           nan
             nan           nan]
  [5.8712517e+01 7.4820015e+01 4.6136146e+00 ...           nan
             nan           nan]
  ...
  [5.7594746e+01 7.4127457e+01 4.5570059e+00 ...           nan
             nan           nan]
  [1.7454669e+00 1.3612852e+01 1.2852089e+00 ...           nan
             nan           nan]
  [6.0483001e-02 6.6224599e-01 5.4863799e-01 ...           nan
             nan           nan]]

 [[5.8653687e+01 6.9375084e+01 4.4437885e+00 ...           nan
             nan           nan]
  [5.8300705e+01 6.5613785e+01 4.4720926e+00 ...           nan
             nan           nan]
  [5.9006668e+01 6.9912415e+01 4.5287013e+00 ...           nan
             nan           nan]
  ...
  [5.7830067e+01 7.1261703e+01 4.4720926e+00 ...           nan
             nan           nan]
  [1.7596720e+00 1.2533951e+01 1.2852089e+00 ...           nan
             nan           nan]
  [6.2072001e-02 1.4520370e+00 4.8952699e-01 ...           nan
             nan           nan]]

 [[5.8477196e+01 6.4288376e+01 4.5003972e+00 ...           nan
             nan           nan]
  [5.9477310e+01 6.6879494e+01 4.6136146e+00 ...           nan
             nan           nan]
  [5.9536140e+01 6.7010841e+01 4.6419191e+00 ...           nan
             nan           nan]
  ...
  [5.8300705e+01 6.5613785e+01 4.4720926e+00 ...           nan
             nan           nan]
  [1.7951850e+00 1.2775734e+01 1.3258801e+00 ...           nan
             nan           nan]
  [7.7514999e-02 9.5824498e-01 5.6970203e-01 ...           nan
             nan           nan]]

 ...

 [[6.7270660e+01 8.6785042e+01 3.4747181e+00 ... 2.3806000e+02
   6.7629997e+01 4.7879999e+02]
  [6.7088684e+01 8.6274544e+01 3.4747181e+00 ... 2.4228999e+02
   7.0190002e+01 5.2500000e+02]
  [6.7816589e+01 8.7660187e+01 3.5031993e+00 ... 2.4489999e+02
   7.0190002e+01 5.2578998e+02]
  ...
  [6.7816589e+01 8.6991676e+01 3.4747181e+00 ... 2.4135001e+02
   6.3810001e+01 4.7798999e+02]
  [1.7024350e+00 1.2878549e+01 8.4513700e-01 ... 1.8580061e+01
   5.5153618e+00 4.7511684e+01]
  [1.0730000e-01 1.1813000e+00 7.9119998e-01 ... 7.7190000e-01
   9.2397003e+00 7.3669000e+00]]

 [[6.7209999e+01 8.6481171e+01 3.4747181e+00 ... 2.3900999e+02
   7.7000000e+01 5.1100000e+02]
  [6.7391975e+01 8.7611565e+01 3.4177554e+00 ... 2.3480000e+02
   7.4250000e+01 5.2000000e+02]
  [6.8180542e+01 8.8097755e+01 3.4747181e+00 ... 2.4198000e+02
   7.7209999e+01 5.4900000e+02]
  ...
  [6.7088684e+01 8.6274544e+01 3.4747181e+00 ... 2.4228999e+02
   7.0190002e+01 5.2500000e+02]
  [1.7024350e+00 1.2878549e+01 8.3128202e-01 ... 1.8580061e+01
   5.5153618e+00 4.7511684e+01]
  [8.9299999e-02 1.0549999e+00 6.8349999e-01 ... 1.2622000e+00
   3.0058300e+01 6.9875002e+00]]

 [[6.7755928e+01 8.7575104e+01 3.4462368e+00 ... 2.3480000e+02
   7.6010002e+01 5.1120001e+02]
  [6.8119881e+01 8.9702187e+01 3.4747181e+00 ... 2.3499001e+02
   8.1680000e+01 5.5109003e+02]
  [6.8362518e+01 9.0212685e+01 3.5031993e+00 ... 2.3780000e+02
   8.1680000e+01 5.6500000e+02]
  ...
  [6.7391975e+01 8.7611565e+01 3.4177554e+00 ... 2.3480000e+02
   7.4250000e+01 5.2000000e+02]
  [1.7286030e+00 1.3390207e+01 8.4513700e-01 ... 1.8020260e+01
   6.4182191e+00 4.9872787e+01]
  [1.3040000e-01 1.5188000e+00 8.1770003e-01 ... 9.7090000e-01
   2.6974701e+01 6.6943998e+00]]], (374, 15, 265)
instruments: hs300
/Users/yangguangyu/anaconda3/envs/quant_dev/lib/python3.9/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.activation_relu_or_gelu was not True
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
df before:                             $open      $close  ...     $psttm   $turn
datetime   instrument                          ...                   
2019-08-06 SH600000     67.331314   67.270660  ...   1.786627  0.1608
           SH600009     93.082047   95.216736  ...  15.513098  1.1181
           SH600010      4.357638    4.272194  ...   1.010858  0.9161
           SH600011      9.384294    9.624917  ...   0.625742  0.2261
           SH600015     17.344748   17.417017  ...   1.467073  0.1580
...                           ...         ...  ...        ...     ...
2023-08-11 SZ300751    963.043640  941.549194  ...  12.552358  0.7226
           SZ300759     69.619865   67.315178  ...   4.841266  2.0063
           SZ300760    280.070007  276.232025  ...  10.157454  0.3799
           SZ300763    400.967407  391.187714  ...   5.525766  2.7863
           SZ300782    654.953186  639.436157  ...  21.357079  0.4208

[259698 rows x 15 columns]
df: instrument                SH600000      SH600009  ...      SZ300763      SZ300782
datetime                                          ...                            
2019-08-06 $open      6.733131e+01  9.308205e+01  ...  3.563924e+01  2.244175e+02
           $close     6.727066e+01  9.521674e+01  ...  3.595101e+01  2.305114e+02
           $high      6.811988e+01  9.612127e+01  ...  3.603869e+01  2.342416e+02
           $low       6.654276e+01  9.209309e+01  ...  3.411936e+01  2.200391e+02
           $volume    7.452146e+06  1.013790e+07  ...  1.236556e+06  2.041850e+06
...                            ...           ...  ...           ...           ...
2023-08-11 $pctchg   -2.560600e+00 -1.463500e+00  ... -3.003800e+00 -2.017500e+00
           $pettm     4.808343e+00 -4.528377e+01  ...  2.918031e+01  8.994736e+01
           $preclose  5.499637e+01  5.872711e+01  ...  4.033022e+02  6.526021e+02
           $psttm     1.171120e+00  2.014770e+01  ...  5.525766e+00  2.135708e+01
           $turn      1.262000e-01  9.393000e-01  ...  2.786300e+00  4.208000e-01

[14640 rows x 267 columns]
features: ['$open', '$close', '$high', '$low', '$volume', '$vwap', '$amount', '$isst', '$pbmrq', '$pcfncfttm', '$pctchg', '$pettm', '$preclose', '$psttm', '$turn']
dates: DatetimeIndex(['2019-08-06', '2019-08-07', '2019-08-08', '2019-08-09',
               '2019-08-12', '2019-08-13', '2019-08-14', '2019-08-15',
               '2019-08-16', '2019-08-19',
               ...
               '2023-07-31', '2023-08-01', '2023-08-02', '2023-08-03',
               '2023-08-04', '2023-08-07', '2023-08-08', '2023-08-09',
               '2023-08-10', '2023-08-11'],
              dtype='datetime64[ns]', name='datetime', length=976, freq=None)
stock ids: Index(['SH600000', 'SH600009', 'SH600010', 'SH600011', 'SH600015', 'SH600016',
       'SH600018', 'SH600019', 'SH600023', 'SH600025',
       ...
       'SZ300496', 'SZ300498', 'SZ300628', 'SZ300661', 'SZ300750', 'SZ300751',
       'SZ300759', 'SZ300760', 'SZ300763', 'SZ300782'],
      dtype='object', name='instrument', length=267)
values: [[[6.7331314e+01 9.3082047e+01 4.3576384e+00 ... 1.5000000e+02
   3.5639236e+01 2.2441751e+02]
  [6.7270660e+01 9.5216736e+01 4.2721944e+00 ... 1.5281000e+02
   3.5951008e+01 2.3051141e+02]
  [6.8119881e+01 9.6121269e+01 4.3576384e+00 ... 1.5486000e+02
   3.6038692e+01 2.3424158e+02]
  ...
  [6.8180542e+01 9.5711212e+01 4.4430819e+00 ... 1.5336000e+02
   3.6340721e+01 2.2989305e+02]
  [1.7866271e+00 1.5513098e+01 1.0108581e+00 ... 1.2880106e+01
   3.4691250e+00 3.7655224e+01]
  [1.6080000e-01 1.1181000e+00 9.1610003e-01 ... 1.8038000e+00
   6.0237999e+00 8.1458998e+00]]

 [[6.7573952e+01 9.6060966e+01 4.2721944e+00 ... 1.5366000e+02
   3.6106892e+01 2.3068097e+02]
  [6.7149338e+01 9.5289101e+01 4.3291569e+00 ... 1.5587000e+02
   3.6905804e+01 2.3540849e+02]
  [6.7695274e+01 9.7206703e+01 4.3861194e+00 ... 1.5723000e+02
   3.7129890e+01 2.4435487e+02]
  ...
  [6.7270660e+01 9.5216736e+01 4.2721944e+00 ... 1.5281000e+02
   3.5951008e+01 2.3051141e+02]
  [1.7834049e+00 1.5524887e+01 1.0243360e+00 ... 1.3138029e+01
   3.5612590e+00 3.8455185e+01]
  [1.1190000e-01 5.5100000e-01 6.8150002e-01 ... 1.4780000e+00
   7.0065999e+00 9.9811001e+00]]

 [[6.7634613e+01 9.5747391e+01 4.3006754e+00 ... 1.5730000e+02
   3.6847347e+01 2.3936804e+02]
  [6.8301857e+01 9.7387604e+01 4.3006754e+00 ... 1.6014999e+02
   3.8143143e+01 2.5633325e+02]
  [6.8605156e+01 9.8750427e+01 4.3291569e+00 ... 1.6164999e+02
   3.8669254e+01 2.5894635e+02]
  ...
  [6.7149338e+01 9.5289101e+01 4.3291569e+00 ... 1.5587000e+02
   3.6905804e+01 2.3540849e+02]
  [1.8140150e+00 1.5866785e+01 1.0175970e+00 ... 1.3498783e+01
   3.6806569e+00 4.1873352e+01]
  [1.1830000e-01 7.5290000e-01 4.4090000e-01 ... 1.6682000e+00
   1.0978500e+01 1.4791700e+01]]

 ...

 [[5.5589321e+01 5.6406509e+01 5.4262009e+00 ... 2.8359680e+02
   3.7982211e+02 6.4784772e+02]
  [5.5959915e+01 5.6713467e+01 5.4262009e+00 ... 2.8136664e+02
   3.8198068e+02 6.4528772e+02]
  [5.5959915e+01 5.7094093e+01 5.4836211e+00 ... 2.8359680e+02
   3.8995422e+02 6.5568463e+02]
  ...
  [5.5737560e+01 5.6652077e+01 5.4262009e+00 ... 2.8054715e+02
   3.8519653e+02 6.5103473e+02]
  [1.1869850e+00 1.9745855e+01 1.2411040e+00 ... 1.0346262e+01
   5.3957109e+00 2.1552519e+01]
  [6.0600001e-02 3.3579999e-01 5.4320002e-01 ... 7.1939999e-01
   1.6925000e+00 5.4530001e-01]]

 [[5.5218727e+01 5.7155487e+01 5.4262009e+00 ... 2.8110730e+02
   3.7898511e+02 6.4037659e+02]
  [5.4996368e+01 5.8727108e+01 5.3974910e+00 ... 2.8028784e+02
   4.0330219e+02 6.5260211e+02]
  [5.5292843e+01 5.8751667e+01 5.4549108e+00 ... 2.8199939e+02
   4.1083521e+02 6.5542340e+02]
  ...
  [5.5959915e+01 5.6713467e+01 5.4262009e+00 ... 2.8136664e+02
   3.8198068e+02 6.4528772e+02]
  [1.2018960e+00 2.0446943e+01 1.2345370e+00 ... 1.0306593e+01
   5.6968908e+00 2.1796818e+01]
  [1.8009999e-01 1.2112000e+00 5.0970000e-01 ... 4.8679999e-01
   5.9432001e+00 5.0999999e-01]]

 [[5.5144608e+01 5.8763943e+01 5.4262009e+00 ... 2.8007001e+02
   4.0096741e+02 6.5495319e+02]
  [5.3588104e+01 5.7867626e+01 5.2826505e+00 ... 2.7623203e+02
   3.9118771e+02 6.3943616e+02]
  [5.5144608e+01 5.9377857e+01 5.4262009e+00 ... 2.8171930e+02
   4.0211276e+02 6.5782666e+02]
  ...
  [5.4996368e+01 5.8727108e+01 5.3974910e+00 ... 2.8028784e+02
   4.0330219e+02 6.5260211e+02]
  [1.1711200e+00 2.0147697e+01 1.2082710e+00 ... 1.0157454e+01
   5.5257659e+00 2.1357079e+01]
  [1.2620001e-01 9.3930000e-01 6.3029999e-01 ... 3.7990001e-01
   2.7862999e+00 4.2080000e-01]]], (976, 15, 267)
Using cpu device
Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.
Logging to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240103093106_1
/Users/yangguangyu/anaconda3/envs/quant_dev/lib/python3.9/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.action_masks to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.action_masks` for environment variables or `env.get_wrapper_attr('action_masks')` that will search the reminding wrappers.[0m
  logger.warn(
/Users/yangguangyu/anaconda3/envs/quant_dev/lib/python3.9/site-packages/stable_baselines3/common/save_util.py:283: UserWarning: Path '/Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240103093106' does not exist. Will create it.
  warnings.warn(f"Path '{path.parent}' does not exist. Will create it.")
Add(Constant(-0.5),Sub($low,Constant(-0.5)))
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240103093106/2048_steps
---------------------------------
| pool/              |          |
|    best_ic_ret     | 0.00326  |
|    eval_cnt        | 1        |
|    significant     | 1        |
|    size            | 1        |
| rollout/           |          |
|    ep_len_mean     | 19.9     |
|    ep_rew_mean     | -0.99    |
| test/              |          |
|    ic              | 0.0129   |
|    rank_ic         | 0.0203   |
| time/              |          |
|    fps             | 293      |
|    iterations      | 1        |
|    time_elapsed    | 6        |
|    total_timesteps | 2048     |
---------------------------------
/Users/yangguangyu/anaconda3/envs/quant_dev/lib/python3.9/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.action_masks to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.action_masks` for environment variables or `env.get_wrapper_attr('action_masks')` that will search the reminding wrappers.[0m
  logger.warn(
$amount
$pcfncfttm
$psttm
$volume
Sub(Constant(0.01),$isst)
Add($turn,Constant(10.0))
$pbmrq
Cov($pbmrq,$psttm,20)
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240103093106/4096_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.0727      |
|    eval_cnt             | 9           |
|    significant          | 7           |
|    size                 | 9           |
| rollout/                |             |
|    ep_len_mean          | 18.8        |
|    ep_rew_mean          | -0.925      |
| test/                   |             |
|    ic                   | 0.0272      |
|    rank_ic              | 0.05        |
| time/                   |             |
|    fps                  | 70          |
|    iterations           | 2           |
|    time_elapsed         | 57          |
|    total_timesteps      | 4096        |
| train/                  |             |
|    approx_kl            | 0.015935611 |
|    clip_fraction        | 0.211       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.42       |
|    explained_variance   | -2.95       |
|    learning_rate        | 0.001       |
|    loss                 | -0.342      |
|    n_updates            | 10          |
|    policy_gradient_loss | -0.021      |
|    value_loss           | 0.0823      |
-----------------------------------------
$turn
$close
Div(Constant(-1.0),$amount)
Ref($pbmrq,50)
Mean(Mul($high,Std($close,50)),10)
Min($pctchg,40)
$volume
WMA(Add(Sub(Std($amount,30),$high),Constant(0.5)),40)
Sub($amount,Sub($pbmrq,Constant(-10.0)))
$high
$psttm
Add($low,Abs(Div($preclose,Constant(2.0))))
Add(Abs(Div(Constant(0.01),$preclose)),Less($pcfncfttm,Constant(-0.5)))
EMA($close,30)
$pcfncfttm
Abs(Min($pctchg,20))
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240103093106/6144_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.0872      |
|    eval_cnt             | 16          |
|    significant          | 14          |
|    size                 | 16          |
| rollout/                |             |
|    ep_len_mean          | 17.9        |
|    ep_rew_mean          | -0.854      |
| test/                   |             |
|    ic                   | 0.0242      |
|    rank_ic              | 0.0478      |
| time/                   |             |
|    fps                  | 55          |
|    iterations           | 3           |
|    time_elapsed         | 111         |
|    total_timesteps      | 6144        |
| train/                  |             |
|    approx_kl            | 0.015466037 |
|    clip_fraction        | 0.187       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.41       |
|    explained_variance   | 5.13e-06    |
|    learning_rate        | 0.001       |
|    loss                 | -0.356      |
|    n_updates            | 20          |
|    policy_gradient_loss | -0.0163     |
|    value_loss           | 0.0121      |
-----------------------------------------
$pcfncfttm
$open
Add(EMA($pbmrq,40),Constant(-1.0))
$preclose
Mad($volume,10)
$pctchg
Sub(Constant(-30.0),$preclose)
Add(WMA($high,30),$amount)
Mul($pctchg,Abs(Sub(Constant(-0.5),$amount)))
Sub(Add(Constant(-0.5),$pcfncfttm),Greater(Div($pctchg,Constant(-2.0)),Constant(-1.0)))
Add($high,Constant(-0.01))
$volume
Add(Constant(1.0),$close)
Div(Constant(30.0),WMA(Mean($close,20),50))
$pctchg
$volume
Add(Mul(Add($volume,Constant(2.0)),Constant(0.5)),Less(Constant(1.0),$vwap))
$pctchg
$open
Div(Constant(-2.0),Log(Mean($vwap,40)))
$pctchg
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240103093106/8192_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.117       |
|    eval_cnt             | 24          |
|    significant          | 22          |
|    size                 | 24          |
| rollout/                |             |
|    ep_len_mean          | 17.5        |
|    ep_rew_mean          | -0.833      |
| test/                   |             |
|    ic                   | 0.0291      |
|    rank_ic              | 0.0371      |
| time/                   |             |
|    fps                  | 49          |
|    iterations           | 4           |
|    time_elapsed         | 166         |
|    total_timesteps      | 8192        |
| train/                  |             |
|    approx_kl            | 0.018019252 |
|    clip_fraction        | 0.297       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.39       |
|    explained_variance   | 2.32e-06    |
|    learning_rate        | 0.001       |
|    loss                 | -0.346      |
|    n_updates            | 30          |
|    policy_gradient_loss | -0.0238     |
|    value_loss           | 0.0291      |
-----------------------------------------
$open
Add(Constant(0.01),Med($pbmrq,40))
$amount
$vwap
Add(Constant(-2.0),Sub($open,$turn))
$isst
$close
$high
Add(Div(Constant(1.0),Sub($preclose,Mul(Less($volume,$psttm),$close))),Log($preclose))
Sub(Constant(5.0),Mul($pctchg,Constant(5.0)))
Add(Log(Add(Less(Constant(-0.01),Min(Log(Log(Min($preclose,30))),40)),Corr(Mean($pbmrq,30),$turn,30))),Constant(0.5))
$volume
WMA(Mean(Var(Mul(Constant(-10.0),$close),10),30),20)
$vwap
Cov(WMA(Mean($pbmrq,40),30),Add(Constant(-0.5),$close),20)
$amount
$turn
$close
Log(Abs(Add(Constant(-1.0),$preclose)))
Sub($low,$preclose)
$turn
Max(Sum(Log($pettm),40),20)
Mul($preclose,Div(Constant(30.0),$amount))
Mul($pcfncfttm,Add(Add(Sub(WMA(Sub(Sub($vwap,Sub(Constant(0.5),Mul($volume,$open))),$psttm),40),Constant(-5.0)),Constant(2.0)),Constant(2.0)))
$amount
Mean($preclose,20)
Sub(Constant(-2.0),$vwap)
Var($close,30)
$isst
Mul(Constant(-0.01),$high)
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240103093106/10240_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.123       |
|    eval_cnt             | 40          |
|    significant          | 32          |
|    size                 | 40          |
| rollout/                |             |
|    ep_len_mean          | 17.2        |
|    ep_rew_mean          | -0.787      |
| test/                   |             |
|    ic                   | 0.0336      |
|    rank_ic              | 0.0395      |
| time/                   |             |
|    fps                  | 44          |
|    iterations           | 5           |
|    time_elapsed         | 232         |
|    total_timesteps      | 10240       |
| train/                  |             |
|    approx_kl            | 0.015278118 |
|    clip_fraction        | 0.288       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.37       |
|    explained_variance   | 1.37e-06    |
|    learning_rate        | 0.001       |
|    loss                 | -0.369      |
|    n_updates            | 40          |
|    policy_gradient_loss | -0.0255     |
|    value_loss           | 0.0362      |
-----------------------------------------
$close
$volume
$close
EMA(Min(Cov(Abs(Less(Add($pctchg,$pbmrq),$pcfncfttm)),Med(Add($amount,$volume),40),10),40),20)
Sub(Std($amount,30),Constant(-2.0))
$close
Mul($high,$isst)
$preclose
$volume
Sub(Less($close,Constant(2.0)),$close)
Add(Abs(Mul(Constant(-1.0),$psttm)),$close)
Sub($amount,$preclose)
$volume
Med($psttm,30)
Mul($pbmrq,$amount)
Div(Div(Abs($high),Sub(Log(Sub(Constant(-30.0),$close)),$open)),Mad($volume,30))
Var(Sub(Constant(-0.5),$high),40)
Mul(Mean(Div(Greater(Constant(30.0),Less($preclose,$amount)),$pbmrq),20),Constant(-10.0))
$close
$amount
$pcfncfttm
$pcfncfttm
$volume
Sum(Sub(Div($pbmrq,$pcfncfttm),Corr($amount,$vwap,30)),50)
Sum(Abs($isst),30)
$pbmrq
$pcfncfttm
Sub(Constant(-1.0),$pcfncfttm)
$psttm
Abs($close)
Add($psttm,Constant(-30.0))
Min($psttm,10)
$vwap
Min(Sub(Add(Mul($pettm,$low),Mul($preclose,Ref($psttm,40))),Mul($isst,$pctchg)),40)
Add(Constant(10.0),$close)
$volume
$turn
Add(Constant(1.0),$preclose)
Log($vwap)
Log($preclose)
Mul(Std(Div($close,$pcfncfttm),30),Constant(-10.0))
$close
Mul($pettm,Constant(5.0))
Log(Log(Sub(Mul(Constant(-1.0),Log($pettm)),Ref(Mul(Add($pcfncfttm,$preclose),Constant(30.0)),30))))
$high
$vwap
$amount
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240103093106/12288_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.135       |
|    eval_cnt             | 57          |
|    significant          | 42          |
|    size                 | 57          |
| rollout/                |             |
|    ep_len_mean          | 14.4        |
|    ep_rew_mean          | -0.622      |
| test/                   |             |
|    ic                   | 0.0323      |
|    rank_ic              | 0.035       |
| time/                   |             |
|    fps                  | 39          |
|    iterations           | 6           |
|    time_elapsed         | 312         |
|    total_timesteps      | 12288       |
| train/                  |             |
|    approx_kl            | 0.016773514 |
|    clip_fraction        | 0.285       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.33       |
|    explained_variance   | 1.73e-06    |
|    learning_rate        | 0.001       |
|    loss                 | -0.345      |
|    n_updates            | 50          |
|    policy_gradient_loss | -0.0285     |
|    value_loss           | 0.0589      |
-----------------------------------------
Mul(Mul(Var($pcfncfttm,40),Constant(-0.01)),Greater($pcfncfttm,Add(Mul($pctchg,$turn),Constant(-0.5))))
Var(Abs(Add(Div(Less(Less($pbmrq,Mul($psttm,$close)),Less($close,Greater($volume,Constant(-10.0)))),$open),Constant(5.0))),40)
$pctchg
Sum($turn,20)
Corr(Div($preclose,Constant(2.0)),Sub(Constant(-30.0),Sub(Add(Log($psttm),Log($turn)),$pettm)),10)
$preclose
Mul(Constant(2.0),Log(Abs($isst)))
Delta(Mul($pctchg,Constant(0.5)),40)
Sub(Constant(-2.0),Mul($close,Div($close,Constant(-1.0))))
$vwap
$open
$close
Mul(Sub(Sub(Constant(-0.5),$preclose),Constant(-0.5)),$volume)
Sub($high,Mul($pctchg,Mul(Constant(-0.5),Abs(Std($psttm,20)))))
Mul(Constant(10.0),$amount)
Mul($vwap,Greater(Cov($close,Less(Abs($pettm),Add(Constant(-1.0),Add($open,$pcfncfttm))),20),$psttm))
Abs($amount)
Add(Less(Less($low,$amount),Constant(-5.0)),$pbmrq)
$vwap
Mul($pettm,Log(Sub($preclose,Less(Constant(0.01),Sub(Sub(Add($high,$volume),Constant(1.0)),Greater($open,Sub($turn,Constant(0.01))))))))
$open
$isst
Ref($volume,20)
Mul(Add($amount,$pbmrq),Constant(10.0))
Mul(Constant(-0.5),Var(Mul($pbmrq,$pctchg),10))
$pctchg
Mul(Div(Less(Constant(-0.5),$pettm),$pbmrq),Abs($psttm))
$pbmrq
Min(Greater(Mul($pcfncfttm,$pcfncfttm),$amount),50)
Add(Constant(5.0),$volume)
Sub(Constant(2.0),Ref($vwap,30))
Min(Mul(Constant(2.0),$psttm),20)
$volume
Add($pcfncfttm,Constant(-2.0))
Sub(Constant(2.0),$volume)
$pctchg
Mul(Constant(-0.01),Mean($pcfncfttm,30))
$close
$volume
Abs(Sub(Constant(2.0),Sum(Mul($amount,$preclose),20)))
Mul(Constant(0.5),Div(Abs($pctchg),Constant(-10.0)))
$volume
Corr($pctchg,$volume,30)
Var($close,30)
Greater(Med(Add(Greater($preclose,Constant(10.0)),$amount),40),$close)
$preclose
$volume
Div($turn,$psttm)
$turn
Add(Constant(-0.5),$open)
Div(Sub($close,$pctchg),Constant(0.01))
$isst
$close
Log($amount)
Mul(Mul(Log(Add($preclose,$preclose)),Constant(0.5)),Mul(Less($close,$pbmrq),Max($preclose,10)))
Add(Constant(1.0),$turn)
$preclose
Mul(Greater(Constant(-30.0),Add($close,Mul(Greater($amount,$preclose),Constant(-2.0)))),$volume)
$amount
Log(Max(Add(Med(Sub(Constant(-2.0),Abs(Ref($vwap,10))),40),$low),50))
Mean($volume,40)
$vwap
Min(Sub($volume,Constant(1.0)),20)
Less($volume,Add($pcfncfttm,$pcfncfttm))
$psttm
$volume
$close
$turn
Add($turn,Constant(2.0))
$pcfncfttm
$preclose
$close
$preclose
$close
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240103093106/14336_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.156       |
|    eval_cnt             | 89          |
|    significant          | 66          |
|    size                 | 89          |
| rollout/                |             |
|    ep_len_mean          | 12.5        |
|    ep_rew_mean          | -0.493      |
| test/                   |             |
|    ic                   | 0.043       |
|    rank_ic              | 0.0364      |
| time/                   |             |
|    fps                  | 32          |
|    iterations           | 7           |
|    time_elapsed         | 434         |
|    total_timesteps      | 14336       |
| train/                  |             |
|    approx_kl            | 0.016046556 |
|    clip_fraction        | 0.305       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.29       |
|    explained_variance   | 5.96e-07    |
|    learning_rate        | 0.001       |
|    loss                 | -0.335      |
|    n_updates            | 60          |
|    policy_gradient_loss | -0.0338     |
|    value_loss           | 0.0774      |
-----------------------------------------
WMA($vwap,20)
$pctchg
Var(Mul($volume,Constant(-5.0)),20)
Add(Mean(Mul(Constant(-2.0),$close),40),$pettm)
Add(Constant(1.0),$preclose)
Min($close,40)
$vwap
$close
$low
Sub(Ref(Mul(Constant(2.0),$psttm),20),Constant(-0.01))
Add($pbmrq,Sub(Div(Constant(-0.5),Add(Greater($psttm,$amount),Constant(-30.0))),Constant(-0.5)))
$pettm
$high
Sub(Greater(Sum(Add($psttm,Min(Sub(Constant(-0.5),$pbmrq),10)),20),$turn),Greater($amount,Sub(Sum($close,20),Constant(2.0))))
Sub(Constant(-0.01),$pettm)
$pbmrq
Min(Sub(Sub(Constant(10.0),$vwap),Greater($pcfncfttm,$high)),40)
$preclose
Ref($pcfncfttm,50)
$high
Div(Sum(Mul(Constant(-30.0),$high),10),$vwap)
Sum(Greater(Mul(Sub(Constant(-0.5),$vwap),$pctchg),$pcfncfttm),40)
Add(Min($turn,10),$pcfncfttm)
Add(Constant(-0.5),Sub($close,Mul($isst,$pctchg)))
Greater(Sub(Add(Constant(-2.0),$open),Corr($pctchg,$low,10)),Std(Mul(Greater($close,$turn),Cov($high,$close,20)),50))
Add(Less(Constant(30.0),Div(Mul(Sub(Mul($vwap,Constant(10.0)),$turn),Sub(Abs($turn),Constant(10.0))),$volume)),$open)
Mul(Sub(Min($close,20),Constant(-1.0)),Div(Add(Cov($high,$pcfncfttm,50),Less(EMA($preclose,40),$pcfncfttm)),$turn))
$amount
$close
Ref(Sub(Constant(-30.0),Sub($amount,Constant(-0.5))),10)
Greater(Add(Ref(Div(Sub($close,Constant(-0.5)),Constant(-0.01)),30),Constant(-1.0)),Cov($preclose,Div(Constant(30.0),$pcfncfttm),30))
Sub($pcfncfttm,$amount)
Mul(Constant(2.0),$turn)
$pbmrq
$amount
Div(Add(Constant(0.01),Sub($pbmrq,$pettm)),Log(Sum($pbmrq,30)))
$amount
Mul(Constant(2.0),$pcfncfttm)
$close
Delta(Sub(Constant(-2.0),Mad($amount,40)),30)
Min($amount,30)
Log(Sub(Var(Ref(Ref($pbmrq,40),20),20),Div($vwap,Constant(1.0))))
Var(Log(Sub($amount,$turn)),10)
Var($pcfncfttm,10)
Mul(Constant(-0.5),Sum(Log($high),30))
Cov(Mad($pettm,10),Sub(Sub($pbmrq,Add(Constant(-0.01),$isst)),Constant(-30.0)),30)
Add(Constant(1.0),Ref($volume,20))
$isst
Cov($vwap,$vwap,40)
$turn
Log(Add($vwap,Cov(Mul(Constant(-10.0),$amount),Mul(Constant(-1.0),Log(Med($pcfncfttm,10))),40)))
Mul(Constant(5.0),Add($preclose,Add($turn,Constant(-10.0))))
Cov($close,Add(Less(Greater($volume,$high),Sub(Constant(-1.0),$pctchg)),Add(Less(Constant(-1.0),$vwap),Add($preclose,Constant(-0.5)))),30)
$turn
Less(Div(Constant(0.01),$psttm),$low)
Log(Add(Add(Constant(-0.5),$pctchg),$pcfncfttm))
$preclose
Mean(Sub(Less(Greater(Constant(2.0),$pettm),$turn),Div($volume,$pbmrq)),10)
$close
Sub(Mean(Min($turn,50),20),$pctchg)
$isst
Abs(Div(Div(Constant(-0.01),$amount),Constant(2.0)))
$pettm
Mul($pcfncfttm,Constant(2.0))
Min(Sub(Div($volume,Constant(1.0)),Constant(-0.5)),40)
$amount
Std(Mul(Mad(Min($low,40),30),Abs(Div($open,Log(Sub(Less(Constant(-1.0),$close),$low))))),50)
Sub(Constant(0.5),Div($preclose,Corr($preclose,$psttm,40)))
Less(Mul(Mul(Constant(-2.0),$pbmrq),Constant(10.0)),$psttm)
$pcfncfttm
$psttm
Div(Constant(-0.01),Sub(Mul($pettm,Max(Cov($pbmrq,$vwap,40),50)),$preclose))
Abs($volume)
Var($vwap,20)
Cov($turn,Add(Constant(-5.0),Sub($vwap,Sub(Less(Constant(-0.5),Sub($isst,Constant(-0.01))),$preclose))),20)
Sub(Add(Add($pcfncfttm,Div(Sub(Constant(-30.0),$open),$pcfncfttm)),Constant(2.0)),Constant(-0.5))
$open
$amount
Div(Constant(-0.5),$preclose)
Less(Mad(Div(Constant(-5.0),$pbmrq),10),$vwap)
$volume
Sum(Div(Constant(0.5),$psttm),50)
Mul($pbmrq,$close)
Add($pcfncfttm,Constant(-0.5))
$turn
Mean(Sub(Constant(1.0),Sub(Log(Var(WMA($pbmrq,40),10)),Constant(0.01))),30)
Sub(Mad(Add($isst,$preclose),20),$amount)
Mul(Constant(0.01),Sum($high,40))
Log($close)
Ref(Sub($pctchg,$pettm),30)
Log(Sub(Less(Constant(-2.0),Sum(Add(Delta($amount,20),Mul(Sub($vwap,Constant(5.0)),Sub($pettm,Constant(10.0)))),30)),$amount))
$preclose
Cov($close,$pctchg,20)
Cov(Sub(Log(Less(Greater($pbmrq,Greater(Log($pctchg),$turn)),$pctchg)),Constant(-0.5)),WMA(EMA($pcfncfttm,10),20),40)
Div(Constant(-10.0),$amount)
Corr(Sub(Constant(0.5),Var($close,10)),EMA($pbmrq,40),20)
Div($pcfncfttm,Log(Log(Less($preclose,$close))))
$pettm
Log(Mean(Var(Add($high,Mul($psttm,Constant(-30.0))),30),20))
Mean($low,10)
$volume
Abs(Sub(Var($pettm,20),$pctchg))
$psttm
Cov(Med(EMA(Log(Div(Min($pcfncfttm,10),$preclose)),20),30),$preclose,20)
$close
Div($pctchg,Mul(Mul(Constant(-30.0),Min(Log($pcfncfttm),30)),Sub(Abs($open),Add(Add(Sub($pcfncfttm,Constant(-5.0)),Constant(10.0)),Constant(-2.0)))))
Mul($psttm,Sub(Std(Min($volume,20),40),$amount))
Sub(Constant(-1.0),Mul($close,Constant(-2.0)))
Greater(Log(Mul(Div(Constant(-0.5),Add(Add(Abs($volume),Sub($pettm,$preclose)),Constant(-2.0))),$pbmrq)),Div($vwap,Constant(-0.01)))
WMA(Div(Add(Constant(5.0),Add($vwap,Min(Log($turn),40))),$close),10)
$preclose
Sum(Sub(Constant(1.0),Div(Add(Add(Mul($pbmrq,Constant(-0.5)),$psttm),Add(Constant(5.0),$preclose)),$vwap)),10)
Var(Sub($close,$close),10)
Med($psttm,40)
$turn
$high
Mul(Add(Greater(Add(Mad(Mul(Greater($pcfncfttm,$pbmrq),$preclose),30),Constant(-30.0)),Sub(Div($pcfncfttm,Constant(0.5)),$open)),Constant(0.01)),Constant(-2.0))
Var(Div(Min(Sub(Constant(2.0),$pctchg),20),Sub($pbmrq,Less($psttm,$high))),40)
$preclose
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240103093106/16384_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.172       |
|    eval_cnt             | 150         |
|    significant          | 110         |
|    size                 | 150         |
| rollout/                |             |
|    ep_len_mean          | 11.5        |
|    ep_rew_mean          | -0.269      |
| test/                   |             |
|    ic                   | 0.0471      |
|    rank_ic              | 0.0415      |
| time/                   |             |
|    fps                  | 21          |
|    iterations           | 8           |
|    time_elapsed         | 762         |
|    total_timesteps      | 16384       |
| train/                  |             |
|    approx_kl            | 0.014907041 |
|    clip_fraction        | 0.242       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.22       |
|    explained_variance   | 7.75e-07    |
|    learning_rate        | 0.001       |
|    loss                 | -0.295      |
|    n_updates            | 70          |
|    policy_gradient_loss | -0.0347     |
|    value_loss           | 0.125       |
-----------------------------------------
Std(Div(Constant(0.5),Less($high,Sub($close,$pbmrq))),40)
Mul($pettm,Add(Med($turn,40),$turn))
$psttm
Sub(Add(Cov($isst,$turn,20),Constant(0.5)),Constant(-0.5))
Add($close,Div(Med($preclose,20),$vwap))
$pctchg
Sub($pcfncfttm,$close)
$turn
$close
$amount
$isst
Less($volume,$pctchg)
Log(Sum(Log(Med(Abs($psttm),50)),20))
Div(Add(Constant(-0.01),$high),Abs($amount))
Mul($volume,Sub($pctchg,Constant(-2.0)))
$psttm
$preclose
WMA($amount,20)
$turn
$pctchg
Corr(Div($vwap,Mul($low,Greater($pcfncfttm,Add(Mean($turn,20),Constant(2.0))))),Add(Constant(0.01),$pcfncfttm),20)
Max(Less(Sub(Add(Constant(-0.5),Cov($pcfncfttm,$pbmrq,30)),Constant(-30.0)),$close),20)
$low
Sub(Max(Sub($volume,Sub(Add(Less(Constant(-10.0),Div($pcfncfttm,Constant(1.0))),Add(Var($pettm,30),Constant(1.0))),$psttm)),30),$low)
Add(Div($psttm,Less(Constant(1.0),Sum($amount,20))),$amount)
$pcfncfttm
$vwap
$pettm
Log($high)
Max($vwap,10)
$amount
Div(Constant(0.5),Ref(Greater(Cov($amount,WMA($isst,20),20),$volume),10))
$vwap
Sub(Constant(-2.0),$pettm)
Sub(Sub(Less($high,Constant(5.0)),EMA($pbmrq,50)),Greater(Mul($close,Add(Add($low,Constant(-0.5)),$open)),Abs($pettm)))
$isst
Add(Constant(10.0),$volume)
Sub(Sub(Less(Constant(30.0),$close),Var(Corr(Cov($psttm,Sub($psttm,Constant(0.01)),10),Sum($pcfncfttm,40),40),10)),$amount)
$isst
Std(Abs($volume),10)
$psttm
Cov(Add(Less(Constant(10.0),$vwap),$high),$preclose,20)
Div(Min($pcfncfttm,20),Greater(Add(Sub($vwap,Div($turn,Constant(-1.0))),Constant(-0.01)),$pcfncfttm))
Mul($vwap,Div(Abs(Div(Constant(-30.0),$turn)),Greater(Sub(Mean($close,20),Log($low)),Add(Mul(Constant(-2.0),$amount),$turn))))
Sub(Constant(-30.0),Sub($low,Less(Max(WMA(Add(Log(Var(EMA($close,30),10)),Constant(-0.5)),30),50),Constant(10.0))))
Log(Var(Min($pbmrq,50),40))
Greater(Sub(Constant(-0.5),$turn),Var(Var($preclose,20),40))
Less($amount,Mul($volume,Constant(0.01)))
$vwap
$pctchg
$pbmrq
Cov(Log(Delta($preclose,20)),$low,20)
Sub(Constant(-0.5),$turn)
$isst
$pcfncfttm
$pettm
Mul(Add(Constant(-0.5),Add(Less($psttm,Constant(0.01)),$pctchg)),Constant(1.0))
Greater(Med(Mul(Sub(Less(Log(Add(Greater(Constant(2.0),Sub($preclose,$turn)),$pbmrq)),$close),Constant(-2.0)),$amount),20),$turn)
$psttm
Div(Constant(10.0),Add($psttm,$isst))
Sub($low,Sub(Constant(0.01),Std($preclose,50)))
Sub(Mul(Constant(10.0),$preclose),Constant(1.0))
$close
Sub(Mul($preclose,Constant(-1.0)),Constant(-0.01))
$close
$pettm
Sub(Constant(-30.0),Mul(Mul($pctchg,Add(Constant(10.0),$turn)),Constant(5.0)))
Var($close,30)
$volume
Div(Constant(10.0),$vwap)
Abs(EMA(Sub(Constant(0.01),Add($open,Constant(30.0))),40))
Sub(Constant(-5.0),$pctchg)
Sub(Constant(-0.5),$close)
Div($close,Constant(-2.0))
Sub($psttm,Greater(Greater($pettm,Constant(-0.5)),Sub($close,Constant(30.0))))
$preclose
$turn
$low
Mean(Add($pctchg,$open),40)
Mul(Greater($volume,Mul($amount,$volume)),Constant(2.0))
Cov(Sub(Constant(-10.0),$pctchg),$pettm,20)
$pctchg
$pbmrq
$pbmrq
WMA($psttm,30)
Log(Add(Constant(-0.01),$close))
$pbmrq
$volume
$pcfncfttm
Mul(Constant(-0.5),Greater($psttm,$volume))
$turn
$pctchg
$close
$close
Log(Std($isst,30))
Add(Less(Constant(2.0),$volume),$low)
$preclose
$pettm
Add(Sub($amount,Min(Sub($vwap,Constant(-30.0)),10)),Sub(Constant(-0.5),$close))
Mul(Log($isst),Div(Constant(-0.5),Mul(Log($amount),Constant(-10.0))))
Log($close)
Mul($isst,Abs(Add($preclose,Sub(Var(Mean($preclose,10),10),$pcfncfttm))))
Abs($pcfncfttm)
Mul(Mul(Constant(1.0),$volume),Mul($volume,Constant(30.0)))
Less(Div(Constant(-0.5),Corr($pbmrq,Div(Greater(Constant(2.0),$pcfncfttm),Var(Log(Greater(Med($vwap,10),$amount)),20)),20)),$pbmrq)
Log($volume)
Mul(Greater(Constant(-0.5),$low),WMA(Log($amount),40))
Mul(Constant(-2.0),Add(Mad($turn,50),Sub(Constant(-1.0),$vwap)))
$pettm
Mul(Add(Var(Mul(Mad($pctchg,30),Add(Add(Constant(1.0),$close),Constant(0.01))),10),Constant(-2.0)),Greater(Constant(30.0),$close))
$amount
Sub(Constant(-2.0),Sub($close,Constant(30.0)))
WMA(Sub(Mul(Constant(30.0),$amount),Abs(Cov($vwap,Delta(Log(Div(Constant(1.0),$psttm)),20),20))),20)
Sub(Constant(2.0),$vwap)
Sum(Sub(Min(Div(Constant(-0.01),Mul(Div(Sub($turn,$pctchg),Constant(0.5)),Med($volume,40))),30),Constant(-5.0)),40)
Add(Mean($pettm,30),Constant(2.0))
Std($vwap,10)
Mul($pcfncfttm,$turn)
$vwap
Mul(Sub($preclose,Ref($pettm,40)),Mul(Sum(Mul(Log($volume),Sub(Add($amount,Abs($open)),Constant(0.5))),20),Constant(0.01)))
Add(Constant(-0.01),EMA($pctchg,50))
$preclose
Mad(Abs(WMA(Abs(Min($preclose,10)),20)),20)
Mean($close,10)
Sub($amount,Constant(10.0))
$isst
Div(Sub(Abs(Add($open,$close)),$volume),Constant(0.01))
$vwap
$high
Less(WMA($volume,40),$psttm)
$pbmrq
Greater($preclose,$vwap)
Abs(Mul(Max(Mul(Mul(Add($pctchg,$pcfncfttm),$volume),$volume),10),$amount))
$pettm
Sub($psttm,Constant(-0.01))
Add(Less($isst,Constant(-1.0)),Add(Sub($isst,Add(Add(Ref($turn,40),Constant(-30.0)),$preclose)),$pbmrq))
Sub(Constant(-2.0),Sub(Sub($open,$turn),Add(Constant(1.0),$turn)))
$high
$pbmrq
Sub($turn,$amount)
Sub(Less(Constant(-0.01),Std(Sub(Add(Log(Abs($vwap)),$preclose),$turn),20)),$close)
$pctchg
$psttm
Greater(Div(Constant(0.01),Abs($preclose)),$pbmrq)
$preclose
$pcfncfttm
Sub(Log($amount),Add($pcfncfttm,Constant(1.0)))
$vwap
$close
Sub(Div(Ref($amount,20),Add($volume,Constant(-0.01))),Greater($open,Abs($vwap)))
Corr($amount,Sub(Constant(-30.0),$amount),20)
Log($close)
Mul(Constant(-0.5),Cov($low,$low,20))
Mul(Mul(Sub(Constant(-2.0),$close),Constant(30.0)),Mean(Div(Greater(Mul(Mul($low,$pbmrq),Constant(-0.5)),Sum($psttm,20)),$pbmrq),30))
Mul(Constant(-0.01),$preclose)
Add(Corr(Mul(Less(Constant(0.01),$pctchg),Abs($high)),Add(Add(EMA($open,10),$pcfncfttm),Mean($pcfncfttm,20)),50),$turn)
$close
$volume
Sub($high,Less(Div($pcfncfttm,Med(Mul($amount,$volume),40)),Constant(-5.0)))
Abs($pctchg)
$open
Sum(Sub(Constant(-2.0),$close),10)
Sum(Add(Log(Abs(Var($volume,10))),Min(Sub(Div(Constant(-2.0),$preclose),$volume),40)),10)
Sub(Constant(5.0),Div(WMA($vwap,40),$preclose))
$pbmrq
$turn
Greater(Add(Constant(-0.01),Less($preclose,Mul(Constant(-1.0),Max($preclose,10)))),Mad($pctchg,20))
Log(Min(Mul(Mul(Constant(0.01),Less(Sub($low,Sub(Constant(-30.0),Less($close,$psttm))),Add(Constant(10.0),$pctchg))),$pctchg),30))
Min($amount,10)
Mul(Constant(30.0),$low)
$psttm
Mul($amount,Constant(-1.0))
$pettm
$close
$pcfncfttm
Max($low,10)
$vwap
Mul(Mul(Constant(0.01),Mean($turn,40)),$preclose)
Mad(Min(Sub(Constant(-1.0),Var($turn,20)),40),10)
WMA(Sub($vwap,Constant(0.5)),20)
Sub(Constant(-5.0),$volume)
$amount
Log($volume)
Add(Cov(Mean(Sub(Constant(-10.0),Std($psttm,20)),30),$volume,10),Mul(Constant(5.0),$pctchg))
Add(Less(Constant(0.5),$close),Min($vwap,30))
Mul(Constant(-0.5),$preclose)
Min(Var($preclose,20),10)
$low
Sum($preclose,10)
Sub(Add(Cov(Med(Add(Mean($pbmrq,40),Constant(0.01)),10),$pettm,30),Constant(10.0)),Constant(2.0))
Add($preclose,Constant(-2.0))
Add(Greater(Mul(Less(Add($close,$close),Log(Mul(Constant(2.0),$pcfncfttm))),Std($pbmrq,30)),Constant(-2.0)),Mul($pbmrq,Constant(-1.0)))
Add(Constant(30.0),Abs($pcfncfttm))
Mul(Constant(-0.5),$turn)
$pcfncfttm
$psttm
$vwap
Sub(Max(Sub($pbmrq,Mul($close,Constant(-2.0))),10),$isst)
$pettm
$amount
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240103093106/18432_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.194       |
|    eval_cnt             | 227         |
|    significant          | 145         |
|    size                 | 200         |
| rollout/                |             |
|    ep_len_mean          | 8.55        |
|    ep_rew_mean          | -0.124      |
| test/                   |             |
|    ic                   | 0.0498      |
|    rank_ic              | 0.049       |
| time/                   |             |
|    fps                  | 13          |
|    iterations           | 9           |
|    time_elapsed         | 1394        |
|    total_timesteps      | 18432       |
| train/                  |             |
|    approx_kl            | 0.015317419 |
|    clip_fraction        | 0.278       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.09       |
|    explained_variance   | 4.17e-07    |
|    learning_rate        | 0.001       |
|    loss                 | -0.266      |
|    n_updates            | 80          |
|    policy_gradient_loss | -0.0391     |
|    value_loss           | 0.188       |
-----------------------------------------
$amount
$pettm
Mul(WMA(Mul(Constant(10.0),Div($preclose,Min(Add(Constant(2.0),Add($pbmrq,Add($pettm,Max($amount,20)))),10))),40),Constant(-5.0))
$volume
Abs($close)
Mul(Constant(-0.01),Mean($psttm,20))
Cov($isst,WMA($preclose,10),40)
Med(Delta($isst,40),20)
$pettm
Sub(Mul(Constant(-0.5),Mul($pettm,$preclose)),Sub($vwap,$preclose))
$pctchg
Log(Div(Constant(0.01),$preclose))
Sub($close,$psttm)
$turn
Mean(Min(Log(Mul(Constant(-2.0),$vwap)),10),20)
Add(Mul(Add(Constant(0.01),Mul($vwap,$close)),Div(Constant(0.01),Add($psttm,Constant(2.0)))),Div($pcfncfttm,$turn))
Log(Add($low,Mul(Constant(10.0),$volume)))
$close
Greater(Sub(Constant(-1.0),$pbmrq),$vwap)
Add(Mul($pcfncfttm,$low),Constant(0.5))
$close
$high
Div(Constant(-0.5),Add($close,Constant(30.0)))
Mul($volume,Sum(Sub(EMA(Sub($pcfncfttm,Sub(Mul(Abs(Mean($volume,40)),Constant(-0.01)),$pctchg)),50),Constant(-30.0)),20))
$low
$vwap
$close
$psttm
Max(Less(Log($pcfncfttm),$high),20)
Sub(Constant(-0.5),$pcfncfttm)
Sub(Sub(Constant(10.0),Corr($pctchg,$turn,40)),Sub(Log($close),Div(Constant(1.0),$pettm)))
Sum($vwap,30)
Sub(Constant(5.0),$close)
Sub(Constant(-1.0),$amount)
$pctchg
$turn
$preclose
Mul(Constant(0.01),Mul($pctchg,Add(Log(Sub(Constant(-2.0),$open)),$psttm)))
Mul(Constant(-30.0),Mean($pctchg,20))
$pcfncfttm
Sub(Constant(-5.0),Log(Div(Sub($pettm,$close),Constant(-0.01))))
Add($close,Add(Log(Var($preclose,30)),Sub(Div(WMA($turn,40),$high),Abs(Sub($preclose,Constant(2.0))))))
Sub(Constant(0.01),$open)
$preclose
Div(Var($preclose,30),$amount)
$volume
Sub(Constant(5.0),Sub($vwap,Constant(2.0)))
$pcfncfttm
Div($pcfncfttm,$volume)
Sub(Constant(-0.01),Less($preclose,$close))
$open
$open
Sub(Constant(30.0),$turn)
Div($pettm,$amount)
$pctchg
Var(Add(Constant(-0.01),$vwap),10)
Sub(Constant(10.0),Mul($volume,Constant(1.0)))
$pctchg
Sub($open,Add($turn,Min(Std($amount,20),20)))
$turn
$vwap
Div(Less($amount,Constant(-0.5)),Add($volume,$pcfncfttm))
Sub(Mul(Constant(-0.01),Div(Add($preclose,Max(Mul($pbmrq,$volume),20)),Constant(-2.0))),$high)
$close
$psttm
Min($high,10)
Sub(Constant(30.0),$isst)
$close
$amount
$close
Sub(Less(Constant(0.5),$amount),Sub(Mul($amount,$amount),$turn))
Div(Sub(Constant(0.01),Mul($turn,$psttm)),Constant(-0.5))
Mean(Div(Constant(2.0),Add(Add($close,$pcfncfttm),Cov(Abs(Max(Div($vwap,Div($high,$volume)),10)),$pbmrq,30))),10)
$close
$volume
Add(Greater(Less(Constant(2.0),Sub(Greater(Log(Sub($pettm,$amount)),Constant(0.5)),Ref($preclose,40))),$isst),$psttm)
Log($vwap)
$turn
$low
$pcfncfttm
Sub(Constant(-2.0),$vwap)
$amount
$turn
$pctchg
Add(Constant(5.0),$pctchg)
$psttm
$close
Add(Less(Constant(0.01),$pcfncfttm),$pctchg)
$close
$preclose
Add(Constant(0.01),$preclose)
$vwap
Sub(Less(Constant(-0.5),$close),$psttm)
Sub(Constant(0.01),Mul($close,Constant(0.5)))
$isst
Sub(Sub($close,Mul(Constant(-2.0),Sub(Mul($high,Constant(-30.0)),$volume))),$pcfncfttm)
$vwap
Mul(Constant(-0.01),Log(Max($vwap,10)))
$isst
Add(Greater(Constant(30.0),$psttm),$vwap)
$vwap
Add(Constant(-30.0),Sub($pbmrq,Var($preclose,50)))
Div($amount,Constant(-0.01))
Abs($vwap)
Log($pctchg)
Add(Add(Constant(10.0),Add($pcfncfttm,$close)),$turn)
Less($vwap,$isst)
Max(Min(Mean($turn,50),20),10)
$amount
Corr(Sub(Max($close,20),Mul(Greater($close,Constant(0.5)),$preclose)),Add($turn,$close),20)
$pbmrq
$preclose
Add(Constant(-5.0),Sub($high,Constant(-30.0)))
$high
Max(Mul(Constant(30.0),$pbmrq),30)
Abs($volume)
$close
Greater(Var($pcfncfttm,20),Min($volume,10))
Add(Constant(-1.0),Greater($open,Sub(Add(Abs(Abs($pbmrq)),Constant(-1.0)),Constant(0.01))))
Add($pettm,Abs(Mul(Constant(30.0),$open)))
$close
Sub(Sum(Less($turn,$pctchg),40),Constant(-5.0))
Log($vwap)
Log($preclose)
$close
$open
Add($vwap,$pcfncfttm)
Sub(Constant(10.0),Abs(Cov($amount,Std($volume,40),10)))
$volume
$pctchg
Sum(Sub(Sub($pbmrq,$low),Constant(10.0)),20)
$psttm
$psttm
Add(Constant(-1.0),$close)
$psttm
Sub($turn,$amount)
$preclose
Sub(Constant(10.0),Mul(Add(Ref($amount,50),$volume),WMA(Div(Sub(Log(Div($isst,Constant(0.01))),Constant(30.0)),Constant(-30.0)),20)))
Mul($close,Sub($pettm,Log(Mul(Log($preclose),Less(Mean(Std($close,20),40),$pctchg)))))
$volume
Add($pcfncfttm,Constant(-0.5))
Div(Constant(-30.0),$pctchg)
$volume
$turn
$pcfncfttm
$preclose
Log($volume)
$close
$turn
Max(EMA($high,40),20)
$pbmrq
$preclose
$isst
$vwap
Sub(Constant(10.0),Mul($isst,Sub($amount,Constant(-0.5))))
Less(Sub(WMA(Sub(Mul($pctchg,$preclose),Std($pbmrq,50)),30),$close),Mul($pettm,$amount))
Mul(Greater(Constant(1.0),Add(Add(Log($psttm),Constant(0.01)),Constant(-0.5))),$amount)
Log($vwap)
Abs($vwap)
$close
Add(Log($pbmrq),Add(Less(Constant(-0.5),Div($amount,Add(Constant(-0.5),EMA($turn,20)))),Log(Min(Log($close),40))))
Sub(Constant(5.0),$psttm)
Var(Sub(Mul(Constant(30.0),Div($turn,$pcfncfttm)),Constant(0.5)),30)
Min(Sub(Add(Sub($vwap,Constant(30.0)),Div(Mean(Log($preclose),40),Sub($isst,Constant(10.0)))),Constant(1.0)),20)
Med($psttm,20)
Div(Constant(-1.0),$open)
Sub(Mul($vwap,Sub(Constant(5.0),Div(Less($volume,Greater(Constant(2.0),Var(Div($turn,Constant(-30.0)),20))),$turn))),WMA($volume,30))
Max($psttm,30)
Sub($vwap,$turn)
Med(Sub($pctchg,Constant(0.01)),10)
$high
Cov(Abs(Add(Constant(0.01),$open)),Div(Add($volume,$volume),$vwap),10)
Sub(Sub(Constant(10.0),$low),Abs(Sub($volume,Constant(5.0))))
Ref(Sub(Add(Constant(-0.01),Sum($vwap,10)),$close),50)
Mul(Constant(10.0),$psttm)
$low
$isst
Mul(Constant(2.0),$pbmrq)
$amount
$low
Less($high,Div($pettm,Constant(-0.5)))
$preclose
Mul(Constant(-2.0),$psttm)
$pbmrq
$preclose
Sub(Constant(5.0),$turn)
Max($amount,20)
$amount
$turn
Div(Constant(-0.5),Mul(Greater(Mul($open,$close),$amount),Constant(-0.5)))
$volume
Mul(Constant(0.01),Add(Greater($close,Constant(1.0)),Var($close,20)))
Sub($pctchg,$open)
$close
$high
Sub(Greater($isst,Constant(-5.0)),$close)
Add(Constant(5.0),$pcfncfttm)
Mul(Constant(-5.0),Add($pettm,Constant(-0.5)))
WMA($close,10)
Div($volume,Greater($psttm,Mul(Constant(1.0),$open)))
$vwap
$amount
Sub(Constant(5.0),$turn)
$pcfncfttm
Div(Constant(0.01),$amount)
Sub($pettm,$vwap)
$pcfncfttm
Add($vwap,Less($close,Mean(Abs($preclose),20)))
Sub($pcfncfttm,$vwap)
$volume
Sum(Div($volume,Mul(Constant(0.01),Abs(Div($isst,$pcfncfttm)))),50)
$preclose
Max(Sub(Constant(-0.5),Sub(Cov($pcfncfttm,$vwap,10),$preclose)),50)
Mul(Constant(-2.0),$volume)
Min(Mul(Constant(2.0),$vwap),30)
$close
$amount
$pctchg
Std(Cov(Sub(Constant(30.0),Div($pcfncfttm,Constant(2.0))),Div(Add(Constant(-0.5),Mean($preclose,30)),Add($amount,Constant(0.01))),30),20)
Add(Constant(-10.0),$pbmrq)
Mul(Constant(5.0),$close)
Sub(Mul(Less(Constant(-30.0),$open),$pettm),Constant(2.0))
$pettm
Mul(Greater(Sub(Constant(-0.5),$turn),Constant(0.5)),Mean(Mad(Sub($pbmrq,Less($low,Constant(2.0))),20),10))
$close
$isst
Mul(Constant(-1.0),Med($turn,40))
$psttm
$turn
Std($amount,30)
Sub(Constant(-0.5),Mean(Log(Abs(Sum(Sub($low,Sub(Div($turn,Ref($close,20)),Constant(0.01))),10))),30))
Mul(Constant(-10.0),$pbmrq)
Sub($low,$high)
Mul(Constant(-2.0),Log(Log(Add(Greater($psttm,Min($high,30)),$volume))))
Add(Add(Constant(0.5),Mul($vwap,$volume)),$preclose)
Sub($turn,$close)
Mul(Constant(1.0),WMA(Sub(Mul(Add($preclose,Greater(Add(Add($low,Sub(Constant(1.0),$open)),Constant(0.5)),$pcfncfttm)),$pctchg),Constant(-5.0)),30))
$volume
$volume
Add(Constant(-1.0),Abs($volume))
Sub($pettm,$psttm)
$close
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240103093106/20480_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.222       |
|    eval_cnt             | 327         |
|    significant          | 174         |
|    size                 | 200         |
| rollout/                |             |
|    ep_len_mean          | 7.83        |
|    ep_rew_mean          | -0.0906     |
| test/                   |             |
|    ic                   | 0.0529      |
|    rank_ic              | 0.0454      |
| time/                   |             |
|    fps                  | 9           |
|    iterations           | 10          |
|    time_elapsed         | 2231        |
|    total_timesteps      | 20480       |
| train/                  |             |
|    approx_kl            | 0.016661024 |
|    clip_fraction        | 0.226       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.92       |
|    explained_variance   | 3.58e-07    |
|    learning_rate        | 0.001       |
|    loss                 | -0.251      |
|    n_updates            | 90          |
|    policy_gradient_loss | -0.034      |
|    value_loss           | 0.175       |
-----------------------------------------
Mul($pcfncfttm,$isst)
Sub(Constant(-0.5),Less($amount,$preclose))
Mul(Sum(Var(Sub(Sum(Add(Constant(10.0),$amount),50),Div(Constant(0.01),$vwap)),50),30),Greater($vwap,Sub($open,Constant(2.0))))
$pcfncfttm
$amount
$close
Sub(Greater(Constant(1.0),$pettm),$pcfncfttm)
$pcfncfttm
$pbmrq
$preclose
Sub(Sub(Constant(-30.0),$turn),Add(Constant(-0.5),$vwap))
Add(Constant(0.01),Greater($pbmrq,Sub($close,Min($vwap,20))))
$open
Mul(Constant(-0.01),$pettm)
$volume
$pcfncfttm
Mul(Constant(-1.0),$psttm)
$pcfncfttm
Max($vwap,10)
Sub(Constant(2.0),Mul($pctchg,Constant(10.0)))
Sub($amount,$close)
Sub(Less(Constant(-0.5),$preclose),$pcfncfttm)
Greater($close,$vwap)
$pettm
Mul(Sub(Constant(0.01),Min(Add(Abs(Log($preclose)),$volume),10)),Constant(30.0))
$psttm
$amount
Sub($amount,$vwap)
Log($preclose)
Log(Add(Constant(-10.0),$preclose))
$pbmrq
Sub(Constant(-0.5),Sum(Sub(Sub(Mad($psttm,30),$preclose),Cov($high,$close,40)),50))
Add(Constant(-0.5),Var($high,50))
$preclose
$low
Add(Constant(0.01),$low)
Mul(Constant(5.0),Div($volume,Add(Less(Add($amount,$amount),Constant(-0.01)),$pcfncfttm)))
Div(Add(Greater(Constant(-5.0),$pctchg),Mean($volume,40)),Constant(-0.5))
$pbmrq
$volume
Add(Constant(0.01),WMA(WMA($high,40),40))
Add(Constant(0.01),$psttm)
Sub($close,Constant(0.01))
$pctchg
$turn
$close
$isst
$open
Sub(Constant(10.0),$low)
Log($volume)
$pettm
Corr($psttm,$amount,20)
Sub(Constant(30.0),Mul($amount,$amount))
$high
Max($isst,20)
Add(Constant(2.0),Div(Ref($close,50),Mul(Constant(2.0),Log(Log($pcfncfttm)))))
Var($pettm,30)
$high
$preclose
Sub(Constant(2.0),Log($amount))
$preclose
$preclose
Mul(Constant(30.0),Sub(Mean(Div(Sub(Min($volume,50),$pcfncfttm),Constant(0.5)),20),Div($turn,Add(Mul($close,Constant(2.0)),Constant(-1.0)))))
$turn
$volume
$pctchg
Std($psttm,40)
Div(Constant(10.0),Med($vwap,50))
$volume
Add(Constant(-0.01),Sum($pcfncfttm,10))
$amount
Sub(Less(Constant(-0.5),Mul(Mul($close,WMA($close,20)),Constant(-30.0))),Abs($close))
$close
Ref($pcfncfttm,30)
Add(Constant(-0.5),$preclose)
Sub($high,$close)
Sub(Constant(-2.0),$turn)
$preclose
$volume
$amount
Min(Abs(Mul(Constant(-30.0),Med(Min($low,10),40))),40)
Sub(Less(Constant(-1.0),$psttm),$vwap)
Sub(Less(Constant(-0.01),Add($preclose,$vwap)),Sum($amount,50))
Sub(Constant(-2.0),Mean(Abs(Abs($psttm)),20))
$open
Div(Constant(-2.0),Log(Log($vwap)))
$pbmrq
Mul(Constant(30.0),$low)
Div(Constant(-5.0),$amount)
Div(Constant(-0.5),$high)
$open
Sub(Constant(30.0),WMA($pctchg,20))
Mul(Constant(0.01),Add(EMA(Mean($amount,10),20),Constant(0.01)))
Add(Constant(1.0),$vwap)
Sub($pcfncfttm,$vwap)
$low
Mul($vwap,Constant(2.0))
Mul(Less(Constant(1.0),Div(Mul(Mad(Abs(Sub($isst,Constant(-0.5))),50),$psttm),$isst)),Mul(Log(Div($low,$open)),Constant(2.0)))
Mean($close,10)
$pctchg
$vwap
Add(Constant(-2.0),$preclose)
$turn
$pcfncfttm
$preclose
Log($turn)
$psttm
Add(Constant(-0.01),$psttm)
$volume
$preclose
$isst
$high
$pettm
Add(Constant(-0.01),$vwap)
Add(Constant(-10.0),$isst)
$close
$close
$pcfncfttm
Mul(Add($pctchg,Constant(-2.0)),$volume)
$preclose
$close
$vwap
WMA(Div($open,Add(Constant(-0.5),Mul($volume,Var($pcfncfttm,50)))),20)
Mul($open,$psttm)
$close
Max(Div(Constant(-10.0),$pettm),40)
$vwap
$high
Max(Add($amount,$pcfncfttm),20)
Add(Constant(2.0),$pbmrq)
Log(Sub(Constant(-0.01),$pctchg))
Mul(Constant(-5.0),Max($turn,40))
Sub(Sub($turn,Add($turn,Constant(-5.0))),$high)
Add(Constant(-2.0),Sum(Add(Sub($pctchg,$pctchg),Constant(-2.0)),40))
$turn
$close
Mul($amount,Constant(-1.0))
Div(EMA(Add(Constant(-1.0),Add($vwap,$pettm)),40),Constant(30.0))
$volume
Div(Constant(-10.0),$vwap)
Add(Delta($close,10),Sum($low,20))
$preclose
Mul(Constant(1.0),$volume)
$pettm
$pbmrq
$pcfncfttm
Mul(Constant(5.0),$pbmrq)
$amount
Add($pcfncfttm,$volume)
$pcfncfttm
$high
Div(Less(Constant(1.0),$preclose),$low)
WMA(Add(Abs($turn),$psttm),40)
Sub($turn,$vwap)
$high
$isst
Sub($preclose,$low)
$pettm
Mul(Constant(-2.0),Mean(Mul(Mean($preclose,20),Constant(2.0)),40))
Div(Constant(1.0),$pcfncfttm)
$amount
$preclose
$low
Sub(Constant(0.5),$vwap)
$pcfncfttm
Mul(Mul(Sub(Mul(Constant(-0.01),$amount),Constant(1.0)),$volume),EMA($preclose,10))
$volume
Div($turn,Constant(30.0))
Sub(Constant(-2.0),$amount)
Sub(Med($volume,10),Constant(-0.01))
Delta($pettm,50)
$pbmrq
$vwap
Div($isst,Log($psttm))
Less(Sum($pctchg,20),$close)
Sub($high,Constant(-0.01))
Abs($pcfncfttm)
$open
$volume
$isst
$amount
$pcfncfttm
Mad($open,30)
$turn
Sub(Constant(-10.0),Div(Mul($isst,Constant(-0.5)),Constant(0.01)))
$volume
Corr(WMA(Sub($amount,$volume),50),Mul($pbmrq,$close),30)
Add($amount,$pettm)
$pettm
Mul(Constant(-0.5),$vwap)
EMA(Add(Add(Add(Constant(-10.0),Cov($isst,Med($amount,10),20)),Constant(-0.01)),Constant(-10.0)),40)
$pettm
Sum(Sum(Add(Constant(2.0),Add(Var($pbmrq,20),Div($preclose,Log(Log(Min(Add($isst,Constant(0.5)),20)))))),10),50)
Mul(Constant(-0.01),$preclose)
$preclose
Sub($preclose,$vwap)
Med(Add(Sub(Greater(Constant(30.0),$close),$turn),Constant(10.0)),20)
$pctchg
$turn
$pcfncfttm
$pettm
$volume
$psttm
Sub(Constant(-1.0),Abs($open))
Sub(Constant(-0.01),WMA($pctchg,40))
$volume
$preclose
$close
$pcfncfttm
Mean($amount,20)
$low
$close
Log(Div(Constant(-0.5),$psttm))
$close
Add(Constant(30.0),Cov($vwap,$high,30))
Max(Add(Mul($psttm,$close),$pctchg),30)
Sub(Greater($amount,Constant(0.01)),$isst)
Sub(Constant(10.0),Sub($volume,Mul(Add($isst,$vwap),Div(Sub($turn,Less($pbmrq,$close)),$open))))
Corr($turn,Add(Mul(Div(Div($high,Add(Constant(5.0),$pcfncfttm)),$pcfncfttm),$pcfncfttm),Min($turn,50)),40)
$preclose
$close
$isst
Add(Constant(-2.0),Add($amount,Sum(Mul($vwap,Constant(10.0)),10)))
EMA($volume,20)
Mul(Sub($preclose,Add(Add(Mul(Delta($open,40),Constant(-2.0)),Constant(-10.0)),Constant(0.01))),Constant(-30.0))
$preclose
$pettm
Add(Constant(1.0),Log(Abs($pbmrq)))
Mul(Sub(Constant(-30.0),$close),$turn)
Div(Less(Constant(30.0),Abs(Sub(Add($psttm,$preclose),Div(Div(Constant(2.0),$pettm),Constant(-0.5))))),Sub($pbmrq,Constant(-2.0)))
Mul(Constant(30.0),Div($pbmrq,Sub(Abs(Sub($preclose,Log(WMA($pcfncfttm,10)))),Add(Constant(-0.5),$pcfncfttm))))
$psttm
$volume
$high
Sub(Less(Constant(2.0),Sub(Mul($close,$open),$turn)),$preclose)
Abs($pettm)
Cov($turn,$psttm,20)
$amount
Mul(Constant(-1.0),Sub($pettm,Constant(-2.0)))
$volume
Cov($pcfncfttm,$close,10)
Sub(Constant(2.0),$amount)
Mul(Constant(0.01),Cov(Div(Div($psttm,$pctchg),Constant(10.0)),$volume,50))
Mul(Constant(-0.5),Max($close,20))
Mul(Constant(-2.0),WMA($pcfncfttm,50))
$psttm
$close
$pcfncfttm
Div(Greater(Constant(-0.01),Corr($pcfncfttm,Log($amount),10)),$open)
$psttm
$open
Add(Sub(Constant(-0.5),$psttm),$preclose)
Log(Std(Med($vwap,50),20))
Log(Sub(Constant(0.01),$psttm))
Div(Log($amount),$pcfncfttm)
$amount
$isst
$amount
Mul(Sub($vwap,$preclose),Log($turn))
EMA($pbmrq,20)
$high
Mul(Div(Constant(-0.5),$vwap),Abs($turn))
$close
Sub(Constant(2.0),$open)
$pcfncfttm
Add(Greater(Constant(10.0),$pcfncfttm),$pbmrq)
Mul(Constant(-0.01),$pcfncfttm)
Add(Constant(-1.0),Sub(Abs($high),$amount))
$amount
Sub(Greater(Greater(Constant(-5.0),$open),$pettm),$turn)
Log(Add(Mul(Add(Log(Mul(Constant(-2.0),WMA(Add($vwap,$close),10))),Min(Mean($psttm,10),40)),Constant(-30.0)),Constant(-1.0)))
$volume
Mul(Greater(Less(Constant(1.0),Med($low,40)),Sub($pctchg,$high)),$vwap)
Div(Add(Constant(-0.01),Abs($vwap)),$pcfncfttm)
Abs($pettm)
$psttm
Add($pcfncfttm,Constant(-10.0))
$close
Std($pettm,20)
Add(Greater(Greater(Std($low,30),Constant(2.0)),Sub($pbmrq,$open)),Add($high,Mad($pettm,30)))
$preclose
$pctchg
Sub($pcfncfttm,$high)
Add(Max(Sub(Abs(Add(Sub(Constant(2.0),$psttm),$pettm)),Constant(0.5)),20),$vwap)
$open
Sub(Constant(10.0),$isst)
Add(Sub(Constant(-10.0),Add($psttm,Constant(10.0))),Abs($amount))
Mul($preclose,Constant(-0.5))
Min($psttm,20)
WMA($preclose,10)
Add(Less(Constant(0.01),Log($open)),$pbmrq)
Abs(Sub(Log(Less(Mul(Constant(2.0),Add($high,Constant(-2.0))),Max($volume,40))),$close))
$pcfncfttm
$pcfncfttm
$isst
Mul(Constant(-1.0),$preclose)
$close
$volume
$amount
Less(Mul(Add(Constant(10.0),Sub($preclose,Mul(Min($high,20),Constant(-0.5)))),$vwap),Div($pcfncfttm,Max($pcfncfttm,40)))
Sub(Sub(Greater(Constant(-0.5),Add(Add($vwap,Log(Mean(Ref($volume,50),40))),Constant(0.01))),$volume),Constant(-10.0))
$close
Sub(Constant(-0.5),$vwap)
$close
$open
$pettm
Add(Div(Log(Sub(Log($turn),$close)),Less($volume,$psttm)),Mean(Sub(EMA($turn,50),$turn),30))
Abs(Add($close,$high))
$high
Add($close,$pettm)
$isst
Log(EMA($pctchg,10))
Div(Constant(30.0),$isst)
Sub(Min(Mul(Greater($volume,Constant(10.0)),$close),20),Constant(-0.5))
$close
$close
Greater(Mul(Constant(-2.0),Max($pctchg,40)),$pcfncfttm)
$psttm
$psttm
Med(Div(Constant(-5.0),Add(Abs(Sub($pctchg,Div(Constant(0.01),Abs($isst)))),Constant(2.0))),20)
Min($open,10)
Mul(Constant(-0.5),$high)
$preclose
$amount
$low
Sub(Constant(0.01),$vwap)
$volume
Mul($close,Log(Sub($close,Less(Constant(-2.0),$pcfncfttm))))
$close
$psttm
$volume
Div(Constant(-0.5),Sub($open,$volume))
$open
Mul(Constant(-2.0),Sub(Abs(Sub(Min($close,20),Div(Sub($open,Constant(-0.5)),$pcfncfttm))),Constant(0.5)))
$pcfncfttm
Add(Constant(10.0),WMA(Max(Mul($pcfncfttm,$pcfncfttm),50),20))
Div(Sub(Sub(Constant(-30.0),$close),$preclose),$vwap)
Add(Constant(30.0),$close)
$psttm
Mul(Div($psttm,Constant(-1.0)),Constant(2.0))
Div(Constant(-10.0),$low)
$vwap
$open
$pettm
Add(Constant(-0.01),Max($close,10))
Add(Mul(Constant(2.0),Add(Less($high,Constant(-0.01)),$psttm)),$pcfncfttm)
Mul(Constant(-1.0),$volume)
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240103093106/22528_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.233       |
|    eval_cnt             | 485         |
|    significant          | 192         |
|    size                 | 200         |
| rollout/                |             |
|    ep_len_mean          | 5.82        |
|    ep_rew_mean          | 0.0659      |
| test/                   |             |
|    ic                   | 0.0529      |
|    rank_ic              | 0.0478      |
| time/                   |             |
|    fps                  | 6           |
|    iterations           | 11          |
|    time_elapsed         | 3256        |
|    total_timesteps      | 22528       |
| train/                  |             |
|    approx_kl            | 0.013897318 |
|    clip_fraction        | 0.218       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.82       |
|    explained_variance   | 7.75e-07    |
|    learning_rate        | 0.001       |
|    loss                 | -0.227      |
|    n_updates            | 100         |
|    policy_gradient_loss | -0.0335     |
|    value_loss           | 0.169       |
-----------------------------------------
$close
$pettm
$pcfncfttm
$low
WMA($pettm,20)
Add($volume,$preclose)
Log($amount)
Div(Max(Sub(Greater(Constant(-0.01),$close),$pettm),20),Greater(Constant(10.0),$turn))
$psttm
Sub($isst,Add($amount,Constant(5.0)))
$close
$amount
$psttm
$pcfncfttm
Var(Sub(Constant(0.5),Add(Cov(Mul($open,Constant(-0.5)),$close,20),$open)),50)
$close
Max(Std($preclose,30),10)
Div(Constant(-30.0),$pctchg)
$close
Add(Sub(Less(Less(Var($low,10),Constant(0.5)),Ref(Log(Mul($isst,Mul(Constant(-30.0),$amount))),40)),$open),Constant(-30.0))
Min($close,20)
Mul(Less(Sub(Min($volume,20),Constant(2.0)),Constant(2.0)),$close)
Log($volume)
$psttm
$low
Sub(Constant(-30.0),Add($pcfncfttm,Log($pcfncfttm)))
Log($close)
$vwap
$vwap
Sub($turn,Less($volume,Sub($isst,Constant(-0.01))))
EMA(Add(Constant(30.0),Mad($pcfncfttm,20)),20)
$pcfncfttm
$preclose
Corr($amount,Div(Constant(-30.0),Mul(Var(Med($high,20),20),$volume)),50)
Div(Constant(0.5),$isst)
Std($open,30)
Max($volume,10)
Mean(Min(Sub(Constant(-2.0),$volume),20),40)
$open
Max($pctchg,20)
Mul(Log($preclose),$pcfncfttm)
Sub(EMA(Sub(Add(Constant(30.0),Mul($vwap,Add(Sub($volume,Constant(-5.0)),Constant(0.01)))),Add($vwap,Div($turn,Constant(5.0)))),20),Constant(10.0))
$turn
Mul(Less(Constant(-2.0),Var($psttm,30)),$vwap)
$pcfncfttm
$pettm
Sub(Constant(10.0),$close)
Mul(Constant(-2.0),$psttm)
$volume
$preclose
$preclose
Std(Mul(Sub(Var($pcfncfttm,10),$pctchg),Constant(-0.5)),20)
Cov($amount,$amount,40)
$preclose
Min(Less(Sub(Constant(-0.01),WMA(Sub($pbmrq,Log(Var($pcfncfttm,20))),50)),$open),50)
$isst
Mul(Constant(2.0),Add($amount,Constant(5.0)))
Greater($preclose,$pcfncfttm)
$vwap
$pcfncfttm
$close
$psttm
$pcfncfttm
$volume
Div($preclose,Log($pbmrq))
$isst
$preclose
WMA(Mul(Constant(-0.5),$close),50)
Std(Add(Div(Less(Greater($vwap,Constant(5.0)),$vwap),$pcfncfttm),Constant(-10.0)),50)
WMA(Div($psttm,$pctchg),40)
$close
Mul(Constant(-2.0),Std($vwap,40))
$low
$preclose
$close
Sub(Greater(Ref(Mul(Constant(0.01),$psttm),20),Constant(0.01)),$open)
Add(Constant(-0.01),Mul(Div($close,Div(Constant(0.01),$close)),Constant(-5.0)))
Div(Constant(-5.0),$close)
$pbmrq
Sub(Constant(5.0),$turn)
Add(Cov(Min($close,10),Ref(Mul(Constant(-2.0),$volume),50),40),Sum($turn,30))
Log(Sub(Constant(-0.5),$amount))
Div($turn,Mul(Add(Constant(0.5),Sub($psttm,Mul(Add($high,Corr($open,Add($turn,Constant(0.01)),20)),$pbmrq))),Constant(-0.5)))
Add($volume,$pcfncfttm)
Sub(Constant(1.0),Mul(Mad($pbmrq,20),Constant(-10.0)))
Max(Div(Constant(0.01),Div($turn,Constant(-0.01))),30)
Add($close,$open)
$close
$amount
Std(Add($vwap,Constant(5.0)),40)
Sub($pcfncfttm,$pettm)
EMA($preclose,50)
Sub(Mul(Constant(-2.0),$open),$high)
$pettm
Add($isst,Constant(-10.0))
Sub(Constant(0.5),$turn)
Sub(Constant(-0.5),Log($close))
Delta($open,30)
Div(Constant(-2.0),$pcfncfttm)
$vwap
Cov($pettm,$low,10)
$isst
Sub(Add(Constant(-0.5),Mul($pctchg,$pctchg)),$amount)
Mean($amount,10)
Mul(Constant(2.0),Add(Cov(Med($pctchg,50),$isst,40),$pcfncfttm))
Min($vwap,10)
$preclose
Sub(Less(Constant(-1.0),$psttm),$vwap)
WMA(Mul(Constant(1.0),Mul(Div(EMA(Greater($isst,$turn),40),$psttm),Div($amount,Constant(-10.0)))),10)
$preclose
$close
$pcfncfttm
$low
Max($pctchg,20)
$vwap
$open
Div(Less(Constant(-0.01),$psttm),$close)
EMA(Var(Sub(Constant(2.0),$pettm),30),40)
$isst
Mul(Greater(Constant(0.01),Add($volume,Constant(2.0))),$open)
$pettm
Mul(WMA(Var(Add($volume,Add(Mul($volume,Mean($preclose,50)),Add($pctchg,Constant(-1.0)))),10),10),$preclose)
$preclose
Add(Greater(Constant(-30.0),Log($preclose)),$pettm)
Mul(Constant(-1.0),Std($close,50))
Div($turn,Div(Constant(2.0),$psttm))
$pbmrq
Mul(Constant(10.0),$pbmrq)
$turn
$close
EMA($amount,30)
$pctchg
$low
Mul(Div($pbmrq,Log($vwap)),EMA($turn,30))
Div(Greater(Constant(-0.5),$close),$turn)
Var(Div(Constant(-10.0),$turn),10)
$vwap
Mul(Constant(0.5),$pctchg)
Abs($pctchg)
Add(Less(Constant(10.0),Add(Add($pcfncfttm,Constant(1.0)),Add($pbmrq,Max($close,20)))),$low)
Div(Less(Greater(Constant(-30.0),Delta($open,30)),$amount),Add($pcfncfttm,Mul($amount,$high)))
$pctchg
$pcfncfttm
$close
$volume
Mul(Add($amount,Constant(-2.0)),Constant(-30.0))
Less($open,$turn)
Sum($volume,20)
Log(Sub(Corr($vwap,$pcfncfttm,50),$high))
$turn
$close
Add(Constant(0.5),Add(Div($pbmrq,Constant(1.0)),$open))
Add(Constant(1.0),$preclose)
Sub(Constant(-2.0),$pcfncfttm)
$close
Log($pbmrq)
$psttm
Sub(Mul(Constant(2.0),Mul($vwap,$pctchg)),Constant(-10.0))
$psttm
$volume
Div(Constant(-0.5),Var($pbmrq,20))
Div(Mul(Less(Less(Constant(-10.0),Med(Greater($vwap,$amount),20)),Mean($preclose,20)),Log($turn)),Constant(-0.5))
$pbmrq
Mul($pettm,Constant(30.0))
$pctchg
Mul(Sub(Var(Ref(Less($high,$preclose),20),20),$vwap),$amount)
$pcfncfttm
Mul($close,$amount)
$close
EMA(Sub(Constant(2.0),$close),40)
$turn
EMA($psttm,10)
Log($vwap)
Mul(Add(Constant(2.0),$pettm),$close)
Min(Sub(Constant(0.5),Sub($psttm,$pctchg)),40)
Ref($pcfncfttm,50)
$turn
$close
$pettm
Sub(Less(Greater($high,Constant(10.0)),$preclose),$vwap)
Add(EMA($pcfncfttm,20),Constant(1.0))
Log(Sub(Greater(Constant(-5.0),Log(Sum(Greater($pcfncfttm,$close),20))),$vwap))
Max(Log(Sub(Constant(1.0),$amount)),50)
$turn
$pettm
Mul(Log(Sub($vwap,Less(Constant(0.5),$pbmrq))),$pcfncfttm)
Add(Constant(2.0),$pcfncfttm)
$open
$amount
Sum(Add(Sum(Div(Greater(Constant(-2.0),$pettm),$turn),40),Mul(Add($vwap,$isst),$preclose)),20)
$vwap
$high
$preclose
Div(Mul(Mad(Log(Mul(Constant(0.01),$isst)),50),$amount),Constant(2.0))
Div(Constant(-1.0),$vwap)
$vwap
Mad(Sum(Med($close,30),50),10)
$isst
$preclose
$volume
$volume
Div(Mul($high,Abs(Med($amount,40))),Max(Div($pettm,Max(Div(Mean($volume,20),Constant(0.5)),50)),50))
Add(Constant(-0.5),Mad(Div(Log($close),Constant(-10.0)),20))
$pcfncfttm
$open
Cov(Add(Sub(Constant(1.0),Min(Var($isst,30),30)),$volume),Ref(Mean($open,20),10),20)
Less($psttm,Add(Constant(-0.01),$preclose))
Add(Sub($pcfncfttm,Constant(-2.0)),$open)
$turn
Max($high,30)
Div(Less(Constant(-0.5),$isst),Sub($high,$pcfncfttm))
Mul(Constant(-1.0),$pettm)
$close
Log(Delta($volume,20))
Mul(Constant(2.0),Mul(Mul(Sub($vwap,Constant(-0.01)),$high),Add($high,$pcfncfttm)))
Div(Constant(-0.01),$vwap)
Add($low,$turn)
Mul(Add(Constant(-30.0),$preclose),Constant(1.0))
Add(Less(Constant(-0.01),Cov(Abs(EMA($volume,20)),$pcfncfttm,20)),$turn)
$pcfncfttm
Sub(Constant(-1.0),Mad($pctchg,20))
$pcfncfttm
Add($close,Constant(-1.0))
Std($vwap,20)
Add(Constant(0.01),$pcfncfttm)
Sub(Max($pbmrq,50),Constant(-2.0))
$isst
Max(Add(Max($preclose,20),$turn),40)
$volume
Mad(Greater(Log($psttm),$preclose),20)
Add(Mul($volume,Max($isst,10)),$psttm)
Max($pctchg,50)
Add(Constant(-0.5),$pctchg)
$vwap
$turn
Mul(Constant(-10.0),$low)
Log($volume)
Sub($pettm,$preclose)
Sub(Greater($pcfncfttm,Constant(10.0)),Abs(EMA($open,10)))
Less($preclose,$psttm)
Sub(Constant(1.0),Std($psttm,20))
$close
$pettm
Sub(Constant(10.0),Add(Mul($close,$low),Constant(0.01)))
$amount
$pbmrq
$turn
Sub(Constant(1.0),$pettm)
Add(Constant(-2.0),$turn)
Div(Constant(10.0),$preclose)
Add(Constant(-5.0),Var($pettm,20))
Mul(Constant(-2.0),Var(Mad($amount,30),10))
Sub(Constant(-10.0),$turn)
Abs(Sub(Constant(-30.0),$vwap))
Div(Constant(10.0),Mul($turn,$psttm))
Med($preclose,20)
Abs($open)
$amount
$pbmrq
Log($pcfncfttm)
Abs(Sub(Constant(-5.0),Sub(Add($pettm,Log($vwap)),Mul($pcfncfttm,Constant(-0.5)))))
Add(Less(Greater($vwap,Constant(-10.0)),$close),Log(Max(Abs($preclose),40)))
$pettm
$high
$volume
Sum(Add(Constant(0.01),$vwap),20)
Sub(Greater(Constant(0.5),$psttm),Sub($preclose,$pctchg))
Sub(Constant(30.0),$open)
$open
$pcfncfttm
Abs(Mul(Greater(Constant(2.0),$amount),$vwap))
$pettm
Sub(Add(Constant(5.0),$isst),Constant(-0.01))
Sub(Constant(2.0),Var(Add(Mean($close,10),$pcfncfttm),40))
Mul($pctchg,Med($high,20))
Div(Constant(-0.01),Add($isst,Sub($preclose,Constant(1.0))))
Mad($pcfncfttm,20)
Sub($vwap,$isst)
$vwap
$turn
$pettm
$open
$vwap
Abs(Mad($volume,30))
$pctchg
Log($vwap)
$pettm
$psttm
$volume
Mul(Greater(Constant(10.0),$open),$close)
$preclose
Sub($close,Constant(-0.5))
$pcfncfttm
$close
$vwap
$volume
Sub(Var(Mean(Div(Greater(Constant(1.0),$amount),Log(Log(Add($amount,$pctchg)))),30),40),Constant(0.01))
$close
$pcfncfttm
$isst
$close
Add(Constant(1.0),$amount)
$high
Add(Constant(10.0),$high)
$vwap
Sub($pcfncfttm,Max(Med(Add(Add($high,$preclose),Abs($pettm)),10),50))
$pcfncfttm
$amount
Add(Constant(1.0),$isst)
Max(Sum($close,20),20)
Sub(Cov($isst,$pcfncfttm,50),Constant(-0.5))
$pbmrq
Div(Constant(0.01),$open)
Mul(Constant(-30.0),Var(Max(Sub(Cov(Log($open),$amount,20),Constant(0.01)),30),20))
$preclose
$vwap
Mul(Greater(Constant(1.0),Add(Div(Mul(Div(Sub($psttm,$preclose),Less(Constant(1.0),$close)),$preclose),$high),Constant(-0.5))),Delta($pettm,40))
$pettm
$volume
Add(Constant(-30.0),$pettm)
$volume
Mul(Min($pcfncfttm,40),$close)
Delta($vwap,50)
$amount
$psttm
Max(Mul(Constant(-0.5),Max($pbmrq,50)),40)
Corr(Mul($turn,$volume),Sub(Add(Constant(0.01),$close),Constant(-2.0)),50)
Log(Var($pettm,10))
Add(Add($pettm,Mean($high,30)),$close)
$amount
Add(Constant(2.0),Mean($preclose,30))
$amount
$high
Mul(Constant(-0.5),$close)
Var($pettm,40)
$vwap
$volume
Add(Constant(-2.0),$high)
$pcfncfttm
Mean(Sub(Less($turn,Constant(0.5)),$pcfncfttm),30)
Max($vwap,20)
Sub(Constant(10.0),$pettm)
$amount
$turn
Mul(Constant(-2.0),Sum($turn,10))
Sub(Constant(-30.0),Div($turn,$preclose))
$close
$isst
$volume
$open
Max($preclose,30)
$isst
Cov(Div(Constant(-5.0),$pcfncfttm),$high,20)
Log(Sub(Mul(Constant(-0.5),$volume),Constant(1.0)))
$pcfncfttm
$close
Greater($psttm,Mad($close,50))
$turn
Med($volume,20)
Max(Sub(Sub(Greater(Add(Constant(-2.0),WMA($vwap,40)),Constant(2.0)),Add($open,Less(Constant(-0.01),$turn))),Constant(1.0)),20)
$vwap
Mean(Sub(Constant(-10.0),Abs($vwap)),40)
Cov(Mul(Constant(-5.0),$high),Add($amount,$turn),30)
$isst
Div(Constant(0.01),$pcfncfttm)
Cov(Sub($amount,$preclose),Log($volume),20)
$close
Cov(Div(Constant(-10.0),$pcfncfttm),$open,50)
Div(Constant(-2.0),Sub(Sub($low,Constant(10.0)),Greater(Log($volume),$vwap)))
$turn
$close
$turn
$open
Sub(Sub(Constant(-5.0),$pettm),Constant(0.01))
Mul(Add(Constant(0.01),$pbmrq),$pcfncfttm)
$close
Med($preclose,20)
Greater(Abs(Mul(Mul(Greater(Constant(0.01),$vwap),Sub($high,Constant(5.0))),$vwap)),Add($pcfncfttm,Add(Constant(0.01),$vwap)))
Add(Constant(-1.0),$pbmrq)
Add(Constant(10.0),$turn)
$vwap
Sub(Constant(-30.0),$preclose)
Div(Constant(0.01),Var(Div($psttm,$high),40))
Mul(Constant(-10.0),Max(Div($high,$close),30))
Mul(Constant(-0.01),Min($pettm,10))
$pettm
Mul(Greater(Constant(-1.0),Div($volume,Constant(-30.0))),Log($vwap))
$pcfncfttm
$open
$isst
Log(Div(Constant(0.01),$close))
Div(Constant(5.0),Ref($close,20))
Mul(Constant(-0.5),Log($vwap))
$vwap
$turn
$vwap
$isst
$psttm
$isst
Mul(Less(Less(Greater(Sub(Mean(Add($high,Constant(-1.0)),20),$preclose),Constant(-1.0)),$psttm),$pcfncfttm),Mean($close,40))
$volume
Div(Constant(-0.5),$close)
$pcfncfttm
Var(Div(Constant(10.0),Abs(Ref($pcfncfttm,30))),40)
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240103093106/24576_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.246       |
|    eval_cnt             | 779         |
|    significant          | 200         |
|    size                 | 200         |
| rollout/                |             |
|    ep_len_mean          | 4.96        |
|    ep_rew_mean          | 0.181       |
| test/                   |             |
|    ic                   | 0.0601      |
|    rank_ic              | 0.0516      |
| time/                   |             |
|    fps                  | 4           |
|    iterations           | 12          |
|    time_elapsed         | 5298        |
|    total_timesteps      | 24576       |
| train/                  |             |
|    approx_kl            | 0.010417771 |
|    clip_fraction        | 0.151       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.7        |
|    explained_variance   | 3.99e-06    |
|    learning_rate        | 0.001       |
|    loss                 | -0.218      |
|    n_updates            | 110         |
|    policy_gradient_loss | -0.0207     |
|    value_loss           | 0.128       |
-----------------------------------------
Greater(Min($pcfncfttm,10),$turn)
Sub($volume,Constant(0.5))
$vwap
Mad($psttm,30)
WMA($vwap,30)
Add($high,$pbmrq)
$preclose
Add(Constant(30.0),$low)
Sub(Constant(-0.01),$close)
$isst
Abs(Sub(Mul($open,Add($vwap,Constant(-0.01))),Var(Sub(Constant(-30.0),$close),50)))
Mul(Constant(-10.0),$close)
$open
Add(Constant(-2.0),Cov($pettm,$pcfncfttm,20))
Sub(Constant(-0.5),Log($psttm))
$amount
$low
Add($close,$vwap)
Max($open,50)
Add(Constant(2.0),$turn)
Corr(Add(Add(Constant(5.0),Sub($psttm,$pcfncfttm)),$preclose),$open,10)
Sub($high,Constant(5.0))
$pcfncfttm
Sub(Constant(5.0),$turn)
EMA($open,40)
Mul($high,Constant(-0.5))
Add(Constant(-2.0),$pbmrq)
$pctchg
Max(Mul(Sub(Constant(2.0),$pettm),$pcfncfttm),40)
Div(Greater(Constant(2.0),$vwap),$pcfncfttm)
Sub(Mul($high,Constant(1.0)),Max(Add($high,$pbmrq),30))
$close
Add($pettm,$open)
Add(Var(Add(Constant(2.0),Sub($open,Constant(-30.0))),20),Abs(Div(Mul($turn,Constant(-0.5)),$psttm)))
$amount
Mul($turn,$isst)
$pcfncfttm
$turn
Add(Mul(Constant(0.01),$volume),Constant(2.0))
Add(Add(Constant(-2.0),Mul($low,$preclose)),Constant(2.0))
Std(Delta(Sub(Div(Constant(-10.0),Div($vwap,Constant(-2.0))),Constant(-0.01)),30),30)
Mul(Add(Greater(Constant(5.0),Var(Less(Mul($pcfncfttm,Constant(-1.0)),$vwap),50)),Max($vwap,40)),$pcfncfttm)
Sub(Constant(-0.01),$volume)
Div($preclose,Log($vwap))
Var(Add(Constant(30.0),Log($turn)),20)
$close
Mul(Constant(-10.0),$isst)
Sub(Constant(-0.01),$isst)
$low
Mad($pbmrq,30)
$close
Log($close)
Sub(Add(WMA(Ref(Add(Sub(Constant(30.0),Med(Mul($high,Constant(30.0)),30)),$vwap),50),20),Constant(5.0)),$pettm)
Min($turn,20)
$preclose
$vwap
Abs($pettm)
$pctchg
$close
Div($pctchg,Constant(-0.5))
Log($high)
Var(Add(Constant(-1.0),$pettm),40)
Log(Sub(Constant(-30.0),Mul($amount,$vwap)))
Sub(Mul(Constant(0.5),$open),$pettm)
Add(Constant(30.0),$amount)
$vwap
Div($pcfncfttm,Constant(-0.01))
Var(Less($psttm,$close),20)
Mul(Less(Constant(-5.0),Abs(Mul(Mad($psttm,50),$pcfncfttm))),$psttm)
Sub(Add(Constant(-10.0),Log($pcfncfttm)),$amount)
Div($high,Constant(-0.01))
Add($amount,Mad(Ref($open,30),30))
$close
Add(Constant(5.0),Var(Sub(Div(Mul(Abs($pcfncfttm),Constant(-0.5)),Mul(Mean($preclose,40),$volume)),Constant(0.01)),30))
Mul(Constant(-0.5),$pettm)
Sub(Constant(30.0),$high)
Log($pcfncfttm)
Mul(Sum(Delta($preclose,30),40),Constant(10.0))
Add(Add(Max(Std($turn,30),10),Constant(10.0)),Add(Constant(-0.5),$pcfncfttm))
Div(Constant(-1.0),$preclose)
Min(Abs(Add($volume,Constant(-0.5))),30)
Mul(Constant(-0.5),$close)
Add($pctchg,$close)
Mul(Sub(Constant(-0.01),$high),$pcfncfttm)
$pcfncfttm
Log(Add(Constant(-0.5),$vwap))
Add(Sub(Mad(Sub(Constant(10.0),$pettm),10),$preclose),Constant(1.0))
$amount
$amount
$pctchg
$pbmrq
Sub($high,Constant(0.01))
Med(Add(Constant(0.01),Less(Div($psttm,Constant(-0.5)),$isst)),20)
Sub($turn,Greater(Constant(-30.0),$pbmrq))
Mul(Sub(Constant(-0.5),Mean(Mul($low,Sub(Constant(2.0),Sub($amount,Constant(-10.0)))),10)),Sub($pbmrq,Constant(-1.0)))
$preclose
$volume
Sub(Add(Mul(Greater(Constant(30.0),Add(Div($open,Log($pcfncfttm)),$preclose)),$close),$pettm),Constant(-0.5))
$isst
$close
Mul($volume,Constant(-10.0))
Var(Mean(Sub($volume,$psttm),20),50)
Mean($amount,20)
$pcfncfttm
$isst
Corr(Sub(Constant(2.0),$low),$pettm,20)
$pbmrq
Mul(Constant(-2.0),$turn)
Sum(Sum(Abs(Mul(Mul(Var(Greater($vwap,Log($pbmrq)),40),Constant(5.0)),$open)),20),20)
$vwap
Abs(Sub($volume,Sub(Constant(10.0),Mul($volume,Add($isst,Add(Div(Constant(-0.01),$vwap),Constant(-0.5)))))))
Mul(Sub(Mul($pcfncfttm,$high),Cov($vwap,$pctchg,10)),Constant(0.01))
Div(Constant(2.0),$turn)
Min(Add(Sum(Sub(Less(Add(Constant(-0.5),Add($close,$turn)),$close),$psttm),20),$high),20)
EMA(Sum($open,20),50)
Div(Constant(-30.0),Var(Sub($close,Constant(-1.0)),20))
Mad(Mul(Constant(2.0),Mul($close,Add($close,Sub(Sub($isst,$pbmrq),$pcfncfttm)))),20)
Sub(Constant(0.5),Log(Less(Max(Add(Abs($pettm),$open),20),Log(Log($pcfncfttm)))))
$amount
$vwap
$open
Mean($isst,30)
Sub(Constant(2.0),$low)
Sum(Med($isst,40),50)
Div($pettm,Sub(Constant(-1.0),$pcfncfttm))
Mul(Greater($pbmrq,Constant(1.0)),$amount)
Abs($pcfncfttm)
Add(Div(Sub(Std($vwap,40),Mean(Min($amount,20),30)),Constant(10.0)),Sub(Sub($psttm,Constant(-0.01)),Min($amount,30)))
$turn
$close
Mul(Constant(1.0),Max($isst,10))
Mul(Sub(Constant(30.0),$pcfncfttm),Ref(Add($amount,Log($pcfncfttm)),10))
Div(Constant(5.0),$amount)
Sum($pctchg,30)
$amount
Div(Constant(1.0),$turn)
EMA($pbmrq,20)
$turn
Sub(Greater(Constant(-10.0),$isst),Add($amount,Less($pcfncfttm,Div(Constant(1.0),$isst))))
$pcfncfttm
$close
Add($vwap,$vwap)
Add(Greater($close,Sub(Constant(30.0),$open)),$pctchg)
Div(Greater(Constant(5.0),Log($low)),Div($close,Add(Add($preclose,$psttm),Constant(0.01))))
Add(Log(Mul($low,Corr(Sub($pbmrq,Constant(2.0)),$close,10))),$volume)
Med(Sub(Greater(Less(Constant(0.01),$pctchg),Sum(Abs(Log(Sub($pcfncfttm,Constant(5.0)))),10)),Sub($amount,Constant(10.0))),20)
$preclose
$pbmrq
Log(Sub(Constant(10.0),Mul($close,Constant(5.0))))
Add(Constant(-1.0),$pbmrq)
Add(Less($amount,Constant(-0.01)),$open)
Mul(Less(Constant(30.0),Abs($vwap)),Mul(Mul($open,Constant(10.0)),$low))
Mad(Div(Greater($pettm,Constant(-0.5)),$pcfncfttm),20)
Mul($high,$pbmrq)
$pctchg
$vwap
Add(Add(Constant(30.0),Less(Abs(Max($vwap,20)),Abs(Min(Sub($amount,Constant(10.0)),20)))),$amount)
$preclose
$amount
$close
Div(Constant(2.0),$amount)
Mul(Add(Constant(-5.0),Max($close,40)),$pettm)
Mul(Constant(-5.0),$pettm)
Mad(Add(Constant(-30.0),$turn),20)
Med(Add(Constant(-10.0),$pctchg),20)
$pbmrq
Std(Mul(Constant(-5.0),Div($psttm,$pbmrq)),40)
$vwap
Mul(Constant(-30.0),$pctchg)
Sub(Constant(0.5),Sub(Sub($high,$isst),$close))
$close
$psttm
Max(Mul(Var(Med($close,20),20),Constant(-30.0)),30)
$volume
Sub(Min($close,50),Constant(10.0))
Div(Log(Med($isst,50)),$volume)
Add(Greater(Add(Constant(-0.5),$pcfncfttm),Constant(0.01)),$psttm)
$turn
Div(Less(Sub(Sub($pbmrq,$volume),Constant(-1.0)),Constant(1.0)),Med($low,10))
$open
$close
$pbmrq
$volume
Sub(Constant(-10.0),Mul(Sub($pettm,$amount),Mul(Var($volume,20),Constant(30.0))))
$volume
Sub(Div(Greater(Constant(0.5),$preclose),$amount),Constant(-0.5))
Sub($vwap,$pbmrq)
Std(Less(Max(Less(Div(Constant(-5.0),Div($turn,$pctchg)),$close),10),$pbmrq),20)
$open
Sub(Constant(-30.0),Mul($pcfncfttm,Constant(-5.0)))
$isst
$high
Abs(Med($high,30))
Mul(Less(Constant(-0.5),Sub(Sub($close,Log(Mad($close,10))),$psttm)),$volume)
Sub(Mul(Greater(Div($vwap,$vwap),Constant(-1.0)),$pcfncfttm),Sub($amount,Constant(-30.0)))
$close
Max(Sub(Delta(Div(Mul(Constant(-10.0),$volume),Sub($isst,Constant(-1.0))),10),Div($psttm,$pctchg)),50)
Log(Mul(Log($psttm),Constant(10.0)))
Div(Less(Constant(-0.5),Sub($vwap,$open)),$isst)
Min(Mul(Constant(-0.5),Add($preclose,Constant(10.0))),40)
Greater($psttm,Add($turn,$turn))
$turn
Sub(Constant(10.0),$amount)
Greater($pcfncfttm,$pbmrq)
Var(EMA(Max(Log(Sub($vwap,Constant(10.0))),20),10),20)
Sub($volume,Add(Constant(5.0),$pctchg))
$high
Sub(Greater(Constant(-2.0),$vwap),$open)
Mul($preclose,Constant(-0.01))
$vwap
$pctchg
Mul(Greater(Greater(Constant(0.01),$low),Less($open,Greater($pcfncfttm,Log(Add($preclose,Constant(-5.0)))))),$close)
Add(Constant(5.0),$low)
$close
Sub(Constant(0.01),$psttm)
Mul(Mul(Constant(-0.01),$close),Sub(WMA($close,20),Constant(30.0)))
Mul(Greater(Constant(1.0),$low),Max($isst,10))
Add(Constant(10.0),$close)
Add(Min(Div($pcfncfttm,Constant(-10.0)),40),$vwap)
Add(Constant(-1.0),Mad($pbmrq,20))
Abs($pcfncfttm)
$low
Mul(Med(Var(Mul($vwap,Constant(30.0)),20),20),Min($amount,20))
Sub(Div(Constant(-1.0),$pcfncfttm),Sub($pbmrq,$vwap))
Mul(Constant(-2.0),$volume)
$pcfncfttm
$pbmrq
Div(Constant(-0.01),Cov(Min($pettm,40),$close,40))
$turn
Mul($pettm,$psttm)
$pcfncfttm
Mul(Constant(-0.5),$pbmrq)
Mul(Sub(Constant(0.5),$psttm),Sub($volume,Constant(0.01)))
Div(Div(Constant(-5.0),$pettm),Constant(-30.0))
Add(Add(Constant(10.0),$pcfncfttm),Constant(10.0))
Mean(Add(Constant(1.0),$psttm),30)
Ref(Mean(Mul(Constant(0.5),Add(Ref($close,20),$isst)),10),20)
Max($preclose,40)
Sum(Mad(Sub(Sub($vwap,Min(Sub(Add(Greater(Constant(5.0),$open),$close),$turn),20)),Add($psttm,Constant(10.0))),30),20)
$pbmrq
$psttm
Greater(Sub(Constant(1.0),$psttm),$preclose)
$vwap
$psttm
Mean($high,20)
$pctchg
$volume
Div(Constant(1.0),$pbmrq)
$vwap
Add(Constant(1.0),$volume)
Sub(Div(Constant(1.0),Max(EMA(Sub($pctchg,$pcfncfttm),20),40)),Sub($vwap,$preclose))
Mul(Constant(2.0),$close)
$high
Add($amount,Add($isst,$close))
Log(Add(Sub(Div(Constant(5.0),$pcfncfttm),$isst),Abs(Sub(Constant(-0.5),$pctchg))))
$turn
$amount
Mul(Constant(0.01),$psttm)
$pcfncfttm
Add(Constant(5.0),Std($open,20))
Add(Constant(1.0),$psttm)
Add($close,Constant(30.0))
$pcfncfttm
Std($pcfncfttm,50)
Sub(Greater(Add(Constant(-5.0),$pettm),Constant(1.0)),$turn)
$turn
$volume
Sub(Constant(0.01),$psttm)
Add(Max(Cov($amount,$pettm,10),20),$amount)
$close
Sub(Div(Max(Add(Constant(-1.0),$pcfncfttm),50),$isst),$amount)
Max(Mul(Sub(Less(Constant(2.0),Max($pcfncfttm,40)),$open),$pbmrq),20)
WMA(Cov(Add(Add(Constant(2.0),Abs($vwap)),$amount),$close,50),20)
Div(Constant(-1.0),$close)
$amount
Add(Constant(-30.0),$vwap)
Std(Sub(Constant(-2.0),$isst),50)
Max($isst,20)
Mul(Less(Mul(Constant(-0.01),$amount),Greater(Add($pcfncfttm,Constant(-0.5)),Constant(0.01))),$low)
Add(Constant(-0.5),$vwap)
Add(Mad($low,20),$vwap)
Var($pcfncfttm,20)
$vwap
$amount
Div(Constant(2.0),Mul(Mul($open,Sub($low,$isst)),Constant(10.0)))
Mul(Constant(1.0),Log(Mad($volume,20)))
Mul(Less(Constant(0.01),Max($pcfncfttm,30)),$open)
Mul(Constant(1.0),Delta(Add($pbmrq,$vwap),40))
Div(Less(Constant(10.0),Log(Add(Mul(Sub($pcfncfttm,Constant(2.0)),Constant(-0.01)),Constant(30.0)))),$pettm)
Mean(Add(Constant(-1.0),$vwap),50)
$isst
Div(Less(Add(Constant(0.5),Sub($preclose,$isst)),Constant(5.0)),Min($close,10))
Sub(Constant(30.0),$volume)
Sub(Constant(-30.0),Greater(WMA($pettm,20),$vwap))
Add(Sub(Constant(10.0),$close),Constant(10.0))
Mul(Mul(Mul(Constant(-30.0),$vwap),$pctchg),$pbmrq)
Mul($vwap,$pcfncfttm)
Add(Sub(Constant(-1.0),$close),Sub($volume,$pbmrq))
$open
Add(Max($volume,20),Constant(30.0))
Sub(Constant(-2.0),Add(Add($high,Constant(10.0)),Sub(Constant(-1.0),Corr($pettm,Corr($turn,Greater($pcfncfttm,Ref($pcfncfttm,40)),10),40))))
WMA(Div(Constant(-2.0),$pctchg),20)
Less(Sub(Greater(Abs($high),Constant(10.0)),Abs($close)),EMA(EMA($volume,10),40))
$open
Mul(WMA(Add(Constant(1.0),$vwap),20),Constant(-2.0))
$pcfncfttm
$amount
$psttm
$amount
$preclose
$close
Mean(Add(Constant(1.0),Sub(Mul($amount,$psttm),Var(Mad(Sub(Add(Constant(30.0),$open),Constant(2.0)),40),30))),20)
Log(Sub(Constant(-2.0),$open))
$pcfncfttm
Mul($volume,Div(Constant(0.01),Mul($low,Add($vwap,$pcfncfttm))))
$vwap
Sub(Min(Mul(Constant(10.0),Add($pcfncfttm,Constant(-1.0))),20),$psttm)
$pettm
Sub($open,Constant(0.01))
Min(Mul(Mul($preclose,$turn),Greater(Mul(Greater(Med($preclose,30),$close),Constant(0.01)),$pctchg)),20)
$volume
$pbmrq
$pcfncfttm
$open
Abs($pctchg)
Mul(Constant(-1.0),$vwap)
Mean(Log($vwap),10)
$vwap
Sum(Sub($volume,$open),20)
Min($open,40)
Mul(Constant(5.0),Sub(Less($pcfncfttm,Constant(5.0)),$close))
$close
Mean(Mul(Greater(Constant(-1.0),$close),$pbmrq),10)
$pcfncfttm
Mul(Constant(2.0),$vwap)
Sub(Constant(-30.0),Log($isst))
Sub(Constant(-30.0),$pcfncfttm)
$high
Mul($open,Constant(0.01))
$open
Mul(Constant(2.0),Abs($turn))
Sub(Constant(2.0),$turn)
WMA($vwap,50)
Less(Min(Mul(Constant(10.0),Log(Abs($pcfncfttm))),40),$pcfncfttm)
$pbmrq
$close
$pettm
Mean($turn,30)
Min($pcfncfttm,10)
$pettm
Add(Mul(Constant(-5.0),Mul(Corr($volume,Add(Less(Constant(-5.0),$high),$isst),30),Log($vwap))),Constant(-2.0))
Sub(Mul(Constant(-2.0),Div($isst,Constant(-0.5))),Add($pctchg,Add(Sub(Constant(5.0),$volume),$amount)))
Sub(Less(Constant(1.0),$pbmrq),$high)
$volume
$pettm
$pbmrq
$preclose
Mul(Constant(10.0),Log(Mul($high,$high)))
Var($amount,20)
$psttm
$low
Div(Constant(1.0),Max(Sub($vwap,Constant(0.01)),50))
$preclose
Sub($pctchg,Constant(0.01))
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240103093106/26624_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.253       |
|    eval_cnt             | 1078        |
|    significant          | 200         |
|    size                 | 200         |
| rollout/                |             |
|    ep_len_mean          | 5.69        |
|    ep_rew_mean          | 0.19        |
| test/                   |             |
|    ic                   | 0.0598      |
|    rank_ic              | 0.0527      |
| time/                   |             |
|    fps                  | 3           |
|    iterations           | 13          |
|    time_elapsed         | 7338        |
|    total_timesteps      | 26624       |
| train/                  |             |
|    approx_kl            | 0.019145586 |
|    clip_fraction        | 0.197       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.66       |
|    explained_variance   | -2.74e-06   |
|    learning_rate        | 0.001       |
|    loss                 | -0.233      |
|    n_updates            | 120         |
|    policy_gradient_loss | -0.0125     |
|    value_loss           | 0.0528      |
-----------------------------------------
$vwap
Add(Constant(-0.5),$volume)
$pbmrq
Min(Sub(Greater(Constant(2.0),$pcfncfttm),Abs(Max(Abs($vwap),10))),20)
$preclose
Max(Div(Constant(30.0),$low),10)
$close
Log(Max($preclose,20))
Mul(Less(Constant(-0.01),$amount),Abs($turn))
$pettm
Mul(Constant(-10.0),Mad($pcfncfttm,10))
$pcfncfttm
Mean($vwap,50)
$isst
$volume
$volume
Mul(Div(Constant(-0.01),Var($volume,20)),WMA($vwap,50))
Div(Constant(-2.0),$amount)
$high
Div(Constant(30.0),Add($low,Constant(2.0)))
$pettm
Div(Constant(2.0),$open)
Log($low)
Add(Constant(-1.0),$preclose)
$low
Mul(Constant(-30.0),$close)
Mul(Constant(1.0),Max(Div(Med(Log(Mul($pctchg,Constant(-1.0))),30),$low),40))
Add(Constant(0.01),$turn)
$preclose
Add($amount,Constant(-0.01))
Add(Constant(0.01),$pcfncfttm)
$pettm
Greater(Mean(Max(Add(Abs(Mul(Constant(-1.0),Add(Log($open),$open))),Constant(-2.0)),20),20),$amount)
Add(Constant(0.01),$pcfncfttm)
$high
Mad($close,30)
EMA($turn,40)
Sub(Constant(5.0),Log($volume))
Sub(Constant(0.5),Corr(Add($close,Constant(-5.0)),$pettm,10))
Add(Constant(0.01),Mul($high,Med($low,10)))
Var(Div(Constant(-0.5),Add(Mul($preclose,Constant(0.5)),$pbmrq)),10)
Abs(Med(Mul(Sub(Constant(0.01),Add(Abs($pbmrq),Mul($vwap,Constant(1.0)))),$pcfncfttm),20))
Div(Sub(Constant(0.01),$amount),$vwap)
Log(Sub(Constant(-0.5),Med($pcfncfttm,30)))
Sub(Constant(-0.5),$pctchg)
$close
$isst
$low
$preclose
$pcfncfttm
Sub(Greater(Constant(0.01),$preclose),Mul($amount,Constant(2.0)))
Add($close,$high)
Med($close,20)
Sum(Mul(Less(Abs(Add(Constant(-2.0),Max($pcfncfttm,30))),Constant(-0.01)),Log($vwap)),30)
Div($psttm,$high)
Min(Add(Constant(1.0),$vwap),30)
$close
Delta($close,40)
$open
EMA($volume,20)
Add(Constant(0.01),Mul(Add($psttm,$low),$amount))
Add(Less(Constant(30.0),$vwap),Mul($high,Constant(0.01)))
$pctchg
$pcfncfttm
Div(Mul(Less(Constant(0.01),$amount),Add(EMA($pcfncfttm,40),Constant(-30.0))),$low)
Add(Sub($volume,$low),Constant(5.0))
$high
$isst
Sub($psttm,$pcfncfttm)
$high
Div(Sub(Sub(Constant(-30.0),$pctchg),$close),Constant(30.0))
$volume
$volume
Log($amount)
$preclose
Sub(Constant(-10.0),Max(Log($isst),40))
Sum($close,20)
$pbmrq
$psttm
Min($vwap,40)
Mul(Add(Constant(-5.0),$vwap),Add(Constant(0.01),Div($turn,Constant(-2.0))))
$pctchg
$high
Mul($pcfncfttm,$isst)
EMA(Log(Add(Constant(0.01),$amount)),10)
Add(Constant(-2.0),Sub($open,Constant(2.0)))
Mul(Constant(2.0),Abs($close))
$pctchg
Greater($psttm,$pcfncfttm)
$amount
$pcfncfttm
$vwap
Mul(Constant(-0.01),Mul(Greater($preclose,Constant(-1.0)),Var(Mul(Log(Mul(EMA(Var($turn,10),20),$low)),Constant(0.5)),50)))
Sub(Constant(-2.0),Med($pettm,20))
Log(Sub(Constant(-30.0),Sub($pettm,$pbmrq)))
$pcfncfttm
Div(Constant(10.0),$psttm)
$close
Mul($psttm,$vwap)
Var(Mul(Constant(0.01),Log(Min($vwap,20))),30)
$pcfncfttm
$pettm
Sub(Sub(Constant(-30.0),$turn),$pbmrq)
Div(Greater(Constant(10.0),$amount),$pbmrq)
Div(Max($preclose,10),Add($pbmrq,Max($amount,50)))
Min($pctchg,30)
$pettm
Greater($open,$high)
$pettm
Mad($open,20)
$open
$amount
$psttm
Add(Constant(0.01),$amount)
$turn
Sub(Less(Constant(10.0),$psttm),$low)
Sub($pettm,Constant(1.0))
Sub(Constant(-5.0),Var($amount,10))
$close
Sum(Mean($pcfncfttm,20),50)
$amount
$close
$vwap
Sub(Add(Greater(Constant(-0.01),$close),$open),$amount)
$pettm
Mul(Div(Constant(-30.0),$psttm),$pettm)
$open
$close
$pbmrq
$pbmrq
Sub($pctchg,Constant(2.0))
Greater(Add(Sub(Constant(-10.0),$low),Max($preclose,10)),Div(Less($volume,Constant(-30.0)),$volume))
Mul(Greater(Abs($pcfncfttm),$open),Sub($high,$amount))
Sub($close,Sub($pbmrq,Constant(-30.0)))
Add($preclose,Div($amount,$pbmrq))
Mul(Constant(0.01),$isst)
Add(Less(Constant(-5.0),$preclose),$pcfncfttm)
$turn
Sub(Mad(Sub($pbmrq,Add(Constant(-10.0),$pettm)),10),Greater(Sub(Constant(30.0),Log(Corr($pcfncfttm,$volume,10))),Constant(-30.0)))
Sub(Constant(-0.01),$open)
Sub(Sub(Sub($preclose,$preclose),Sub(Std(Sub($pcfncfttm,Constant(-10.0)),10),Log(Log($volume)))),$volume)
$vwap
Sub(Constant(10.0),$turn)
Std($preclose,10)
$high
Add(Constant(-0.01),$preclose)
$close
$pettm
Min($preclose,40)
Add(Constant(30.0),Mul(Max(Sub($volume,Add(Constant(-1.0),$pcfncfttm)),20),$pcfncfttm))
$pbmrq
$volume
Mad($open,40)
$high
Mul(Constant(-0.01),$open)
$isst
Mul(Constant(5.0),$amount)
$low
Med($preclose,20)
Corr(Sub(Constant(-30.0),$low),Mad($close,30),10)
Var(Max($psttm,10),30)
$amount
Mul(Constant(-0.5),$vwap)
Sub(Constant(-0.5),$close)
Add(Constant(10.0),Mad(Add(Abs($volume),Constant(-1.0)),10))
Add(Constant(10.0),Var($pbmrq,40))
$pcfncfttm
$preclose
Div(Constant(-0.5),Add(Sub($close,Constant(0.01)),Constant(-10.0)))
$pcfncfttm
Log(Sub(Constant(-10.0),$volume))
$close
$pettm
Add(Mul(Sub(Less(Constant(-0.5),$high),Div(Div($pcfncfttm,$turn),Sub($vwap,Constant(0.01)))),Add(Constant(10.0),$pcfncfttm)),$vwap)
Mul(Constant(-30.0),EMA($high,30))
Sub(Less($open,Constant(30.0)),Abs($volume))
$preclose
Mul(Less(Sub(Constant(-0.5),$pettm),Constant(10.0)),Add(Mad($pcfncfttm,40),Constant(-30.0)))
$vwap
Div(Constant(2.0),Mul($vwap,Constant(-5.0)))
$vwap
$vwap
Less($psttm,Add($low,$high))
$amount
Add(Constant(0.5),$open)
Sub(Constant(-2.0),$amount)
$psttm
Add(Constant(1.0),$preclose)
Mul($close,$pbmrq)
Div(Constant(-1.0),$pettm)
Sub(Constant(-0.01),Sub($amount,$turn))
Abs(Max($preclose,40))
Sub(Mean($close,30),$preclose)
Add($low,$pettm)
$preclose
Add(Constant(10.0),$pbmrq)
Mul(Constant(30.0),EMA(Less(Less($pcfncfttm,$high),$pbmrq),50))
$pettm
Div(Constant(5.0),$pctchg)
Add($low,Log($amount))
Div($pcfncfttm,$psttm)
Mul(Sub(Constant(-30.0),$amount),Constant(0.01))
$volume
Div(Constant(10.0),$psttm)
Add(Sub(Greater(Constant(-30.0),$high),$high),$high)
Sub(Sub(Div($amount,$isst),Constant(-30.0)),Less($vwap,Constant(-5.0)))
$volume
$open
Mul(Constant(10.0),Log($low))
Div($pbmrq,$high)
Add(Constant(0.01),$volume)
Sum($low,20)
$pbmrq
Sub(Greater(Constant(30.0),Max($pctchg,30)),Add(Sub($pbmrq,Constant(-0.5)),$close))
$turn
Log(Sub(Constant(0.5),$close))
Var(Add(Add(Constant(0.01),$open),Constant(-2.0)),40)
Mul(Greater(Less(Constant(-30.0),Sub(Mul(Log(Sub($preclose,Constant(-0.5))),$low),Constant(2.0))),Ref($volume,10)),$preclose)
$vwap
$isst
WMA(Add(Sub($pcfncfttm,Constant(2.0)),$pbmrq),40)
Sub(Log($volume),Var(Greater($low,$isst),50))
Add($preclose,Sum(Sub($isst,Less($close,Sub(Mul(Constant(10.0),$vwap),$turn))),30))
Sub(Greater(Constant(5.0),$high),Log(Mul($pcfncfttm,Sum($volume,20))))
Cov($high,$high,50)
Log(Mad($amount,10))
Mul($pcfncfttm,$close)
Mean($close,50)
$low
Var(Sub($psttm,Div(Sub(Constant(-2.0),$amount),$pcfncfttm)),30)
Sub(Mul(Sub(Div(Abs(Add($turn,$vwap)),$amount),$psttm),Constant(-0.5)),Var(WMA($pettm,20),50))
Sub(Constant(-30.0),$amount)
WMA(Sub(Constant(-10.0),$pbmrq),20)
Add(Mul(Constant(30.0),Less(Abs(Sub($isst,Med(Sub($psttm,$close),30))),$isst)),Constant(-30.0))
Add(Greater(Greater(Add($pctchg,$vwap),Constant(-0.5)),$high),$close)
Sub(Constant(-0.5),$close)
$pcfncfttm
Add($close,Constant(10.0))
Mul(Div(Sub(Less($volume,Constant(30.0)),$close),Add(Constant(1.0),$close)),Constant(-2.0))
Sub(Delta($pbmrq,30),$pettm)
Mul($pcfncfttm,$vwap)
$close
$psttm
Var($pbmrq,50)
Add(Var($low,10),Constant(10.0))
$amount
Div($close,Mul(Sub(Constant(2.0),$pbmrq),Less($pcfncfttm,$high)))
Min(Mul(Constant(5.0),Mul(Var(Max(Max($pcfncfttm,10),50),50),$amount)),10)
Std($pettm,30)
Mul(Constant(-30.0),Cov(Cov(Log($isst),$turn,20),$pcfncfttm,30))
Sub(Constant(10.0),$psttm)
$volume
Abs(Div(Constant(-0.01),Add($close,$preclose)))
Sub(Constant(2.0),Var($vwap,50))
Mean(Sub(Constant(-0.5),Mul($preclose,Constant(0.01))),30)
Mul(Add($pcfncfttm,Constant(-0.5)),Sub($pcfncfttm,Sub($high,$open)))
$low
Sub(Constant(10.0),$pcfncfttm)
$volume
Mul(Constant(-0.01),$pettm)
Add(Mul(Constant(-1.0),$pctchg),Constant(0.01))
Div(Constant(-0.01),Mul(Add($amount,$close),Constant(0.01)))
Min(Sub(Constant(-0.01),$pcfncfttm),40)
$pctchg
Add(Mul(Constant(0.5),Add(Div($vwap,$pbmrq),Log(Sub($pbmrq,Constant(30.0))))),Mul($amount,Min($pcfncfttm,10)))
$pettm
$isst
Cov(Sub(Constant(0.01),$open),Sub($isst,$high),20)
Mul(Sub(Constant(10.0),$preclose),Max($low,30))
Mul(Constant(5.0),$volume)
Add(Constant(0.5),Sub($close,$pctchg))
$low
$volume
$amount
Sub(Sub(Add(Constant(10.0),$preclose),Constant(0.01)),$pettm)
Add(Constant(-1.0),$vwap)
$vwap
$close
$amount
Cov(Mul(Constant(-10.0),$turn),Var(EMA(Sub(Constant(0.01),$close),50),40),10)
$close
Mul($pctchg,Constant(-30.0))
Sub(Constant(-0.01),Sub($vwap,EMA($turn,50)))
Sub(Constant(-1.0),$pbmrq)
Sub(Constant(-10.0),Div(Abs(Greater($high,$volume)),$low))
Sub(Constant(2.0),Delta($high,20))
$isst
EMA(Sub(Constant(-0.01),Sub(Sub(Add($amount,Add($pcfncfttm,Abs($amount))),Add(Constant(5.0),Mul($amount,$pcfncfttm))),$low)),10)
Add(Constant(-2.0),$pcfncfttm)
Mul(Log(Mul(Constant(5.0),Abs(Add($preclose,Add(Constant(2.0),Mul(Sub($close,$high),$isst)))))),$high)
Sub(Constant(-0.5),$vwap)
Sub(Greater(Constant(0.5),Add($pcfncfttm,Less($vwap,Constant(0.01)))),Div(Div($close,Constant(5.0)),$close))
$amount
$turn
$pcfncfttm
Add(Constant(1.0),$pbmrq)
Mul(Constant(-30.0),Mad($vwap,50))
Div(Constant(-0.5),Corr($pcfncfttm,Add($amount,Max(Sub(Constant(0.5),Log($pcfncfttm)),40)),20))
Mul(Constant(-0.5),Add(Div($close,$pcfncfttm),$isst))
Add(Mul(Greater(Constant(5.0),$amount),Corr($amount,$pctchg,40)),$close)
EMA($pctchg,50)
$pbmrq
$amount
$pettm
Div($turn,$pcfncfttm)
$turn
Corr(Sub(Sub(Constant(-0.01),Std($high,40)),Constant(-0.5)),$open,20)
Mul(Constant(-1.0),$high)
Add(Med(Div(Constant(2.0),$pcfncfttm),40),Constant(-10.0))
Mad(Log($pbmrq),30)
Less(Add(Constant(2.0),$amount),Mul($low,Constant(-30.0)))
Log($close)
$volume
$pettm
Sub(Constant(-5.0),Add($isst,$preclose))
Abs(Sub($low,Ref(Sub(Sub($close,$pcfncfttm),Mul($volume,Constant(-30.0))),10)))
Div(Constant(-0.5),EMA($low,20))
Add(Max(Log(Mul($low,$open)),20),Constant(-30.0))
$amount
$turn
Add(Constant(10.0),$amount)
Max($pcfncfttm,30)
Add(EMA(Mul(Constant(5.0),$pcfncfttm),30),Div($amount,$pcfncfttm))
$vwap
$pettm
$isst
Mul(Sub(Greater($pctchg,Constant(-2.0)),Sub($low,Less(Greater(Abs($pcfncfttm),$pettm),Constant(2.0)))),Mul($psttm,Constant(1.0)))
$close
Greater($vwap,$vwap)
Log(Mul(Sum(Med($high,40),20),Constant(10.0)))
Delta(Sub(Constant(-2.0),$pettm),20)
Mul(Constant(-0.5),$preclose)
$amount
Div(Max(Abs(Sub(Less(Constant(-5.0),$psttm),Mean(Log($low),10))),20),Mul(Constant(-0.01),$isst))
Abs(Add($pbmrq,$volume))
$pcfncfttm
$vwap
$amount
Sub(Constant(10.0),Var(Mul(Mul($vwap,Constant(10.0)),$turn),50))
Div(Constant(0.5),Add(Greater(Mad($preclose,40),Constant(30.0)),$open))
Sub(Greater(Max(Log($open),30),Constant(30.0)),Cov($high,EMA($vwap,30),30))
$pbmrq
Sub($open,$pbmrq)
Delta($turn,40)
$amount
Sub(Greater($pettm,Add(Div($high,Constant(0.01)),Constant(-30.0))),$psttm)
Mul(Var(Sub(Mul(Mul(Greater(Constant(2.0),$turn),Mul($vwap,$pettm)),$psttm),Constant(-1.0)),20),$vwap)
$turn
Mul(Std(Ref($psttm,20),40),Constant(10.0))
Sub(Sub(Constant(30.0),Div($preclose,Mad(Less(Sub(Constant(-0.01),$pcfncfttm),$vwap),10))),$open)
EMA(Sub(Constant(0.01),Mul($close,$pcfncfttm)),20)
Log(Add(Constant(0.01),Log($turn)))
$high
Add(Constant(30.0),Add(Mul(Sub(Ref($high,20),Constant(0.01)),$high),Sub(Sub(Constant(-0.5),$close),$isst)))
$low
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240103093106/28672_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.262       |
|    eval_cnt             | 1382        |
|    significant          | 200         |
|    size                 | 200         |
| rollout/                |             |
|    ep_len_mean          | 6.36        |
|    ep_rew_mean          | 0.184       |
| test/                   |             |
|    ic                   | 0.0628      |
|    rank_ic              | 0.053       |
| time/                   |             |
|    fps                  | 3           |
|    iterations           | 14          |
|    time_elapsed         | 9356        |
|    total_timesteps      | 28672       |
| train/                  |             |
|    approx_kl            | 0.014973212 |
|    clip_fraction        | 0.251       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.6        |
|    explained_variance   | -1.78e-05   |
|    learning_rate        | 0.001       |
|    loss                 | -0.279      |
|    n_updates            | 130         |
|    policy_gradient_loss | -0.0221     |
|    value_loss           | 0.0287      |
-----------------------------------------
Add(Sub($close,Constant(5.0)),$amount)
$volume
$pbmrq
Less($open,Div(Constant(30.0),$preclose))
$preclose
$close
Add($psttm,Constant(2.0))
$vwap
Add(Constant(10.0),$psttm)
Sub(Constant(-2.0),Log(Add($pcfncfttm,$pcfncfttm)))
$isst
$close
Div(Abs(Sub(Constant(1.0),$pcfncfttm)),$close)
Add(Constant(10.0),$psttm)
Div(Constant(2.0),$pcfncfttm)
$psttm
Div(Constant(-10.0),$turn)
$vwap
$close
$isst
$high
Sub(Constant(0.01),$pcfncfttm)
Sub(Mul(Constant(-30.0),Std(Var(Sub($volume,Delta($close,20)),30),20)),$preclose)
$amount
Log($low)
$pctchg
Max(Max(Less($open,$pettm),40),30)
Mul(EMA($pbmrq,30),Constant(10.0))
$low
Add(Constant(-5.0),Add(Add(Min($close,20),Add($amount,Constant(30.0))),$vwap))
Add(Constant(-1.0),$close)
Mul(Add($volume,Add(Constant(-10.0),$close)),Constant(-2.0))
$low
$pbmrq
$close
Sub(Constant(-1.0),$low)
Mad($psttm,20)
Mad(Div(Constant(10.0),$pettm),30)
Add($high,Constant(-2.0))
Add(Add(Constant(0.01),$psttm),$preclose)
$open
Add(Constant(-30.0),$low)
$volume
Div(Add(Add($pbmrq,Sub($pettm,Constant(30.0))),Constant(2.0)),Add($pettm,$psttm))
Min(Med(Sub(Less(Constant(-0.01),$high),$turn),50),20)
Add(Greater(Greater(Constant(1.0),$pbmrq),$vwap),Delta($pcfncfttm,20))
$isst
Mad($psttm,20)
$vwap
$preclose
Mean(Sub(Constant(0.01),Var($low,20)),10)
Abs(Mul($psttm,$turn))
Div(WMA($close,10),$turn)
Sub(Mul(Add(Constant(1.0),Div($pcfncfttm,Constant(-0.5))),$open),$turn)
Add(Greater(Mul(Sub($isst,Mul(Constant(-2.0),$preclose)),$high),Constant(-2.0)),$open)
Add(Constant(0.01),$pcfncfttm)
Sub($pcfncfttm,Constant(-30.0))
Add(Std($low,20),$high)
WMA($pctchg,20)
$vwap
Sub(Add(Constant(2.0),$vwap),Constant(-30.0))
$volume
$high
EMA($preclose,50)
Sum(Sub(Mad($close,30),Constant(-10.0)),20)
Med($open,40)
EMA($high,30)
$preclose
$vwap
Mul(Constant(-1.0),$pettm)
$turn
$pcfncfttm
$turn
Mul($pcfncfttm,$volume)
Var(Sum(Corr($high,Add(Constant(-30.0),Mul($open,$psttm)),40),20),30)
Abs(Log(Med(Sub(Mul(Constant(-5.0),$pbmrq),Mul(Constant(30.0),$turn)),20)))
Mul(Less(Constant(1.0),Less(Add($pettm,Constant(-2.0)),Abs(Add(Mad(Log(Mul($vwap,$pcfncfttm)),10),$high)))),$preclose)
$pcfncfttm
Mul(Med(Mul($pcfncfttm,$pbmrq),20),$amount)
Add(Constant(5.0),$volume)
Log(Add(Constant(-0.01),$amount))
$turn
$open
Sub(Constant(-0.5),Mul(Add($turn,Log($close)),$isst))
$psttm
Mul($pcfncfttm,Constant(-0.5))
EMA(Greater(Std($turn,10),Add(Constant(-30.0),$turn)),20)
$pctchg
$amount
Div(Constant(-2.0),$low)
Mul($pcfncfttm,Constant(-2.0))
$preclose
Add(Constant(30.0),$high)
Sub(Greater(Constant(-2.0),$high),$preclose)
Log(Sub(Mad($low,20),Constant(0.01)))
$pctchg
Max(Sub($open,$turn),30)
$pbmrq
$vwap
Mul($pcfncfttm,$isst)
$vwap
Sub($amount,Constant(-30.0))
Log(EMA(Div(Less($high,Constant(-1.0)),Add($preclose,Div($vwap,Constant(-10.0)))),30))
$amount
$close
$amount
Sub($pettm,Constant(-10.0))
$close
Min(Sub(Constant(-1.0),Less($psttm,$vwap)),50)
$high
Less(Sub(Less(Constant(30.0),$amount),Cov(Add($pbmrq,Sub(Constant(2.0),$psttm)),$vwap,40)),$isst)
Mul(Less(Constant(-10.0),Abs(Add(Less($preclose,Constant(5.0)),$pbmrq))),$high)
Mul(Less(Constant(-1.0),$high),$pcfncfttm)
$vwap
Log(Log(Add(Constant(-5.0),$pbmrq)))
$high
Sub(Constant(30.0),$close)
$close
Sub(Constant(-10.0),Mul($close,Constant(1.0)))
Sub(Mul(Constant(-0.01),Sum($amount,20)),Constant(-30.0))
Div(Constant(5.0),Div(Div(Add(Sub(Mul($amount,$vwap),$pettm),$volume),Add($high,$pcfncfttm)),Max($vwap,10)))
Sum($vwap,10)
$pcfncfttm
$amount
$close
$isst
Sub($close,Sub(Abs(Max($pcfncfttm,10)),Greater(Constant(-2.0),$pbmrq)))
Mad(Sub(Constant(10.0),$open),20)
$pcfncfttm
Mul(Constant(-0.01),$vwap)
Mul(Cov($close,$pcfncfttm,40),Constant(5.0))
$low
Abs($high)
$vwap
Mul(Constant(-10.0),Add(Mul($open,$psttm),Constant(-30.0)))
$low
$volume
$amount
Sub(Add(Greater(Add(Constant(0.5),$preclose),Constant(1.0)),$vwap),Sub($pettm,$volume))
Log(Std(Mul($volume,$turn),20))
Mul(Constant(-30.0),EMA($pcfncfttm,30))
Mul(Constant(-30.0),$pcfncfttm)
Ref($pbmrq,30)
Sub(Mul(Constant(2.0),$pbmrq),Constant(-10.0))
Sub($psttm,Constant(-2.0))
Max($pcfncfttm,40)
$psttm
Mul(Less(Constant(-0.5),$pcfncfttm),Mul($high,Add($high,$low)))
Sub(Mul(Constant(-0.5),$isst),Greater($pcfncfttm,Constant(2.0)))
Div(Constant(-0.5),Div($close,Greater(Constant(2.0),Add(Cov($pettm,$preclose,40),$amount))))
$vwap
Div(Constant(-0.5),EMA(Div($volume,Constant(-0.01)),10))
Add(Mul(Less($pettm,Constant(10.0)),$psttm),$close)
Min($pettm,40)
Sub(Constant(30.0),Sub(Corr($psttm,Log($amount),10),$pctchg))
$pcfncfttm
$turn
Mad(Mul(Constant(0.01),Log(Sub($pcfncfttm,Constant(1.0)))),20)
Sub(Greater(Mul(Greater(Constant(-2.0),Div($vwap,Add($close,Div(Constant(-1.0),$volume)))),$preclose),$high),Constant(-0.5))
$pettm
Add($pctchg,Less(Min(Div(Constant(-30.0),$volume),20),Sub($vwap,$psttm)))
$psttm
$preclose
Mul(Greater(Constant(30.0),$volume),Sub($pcfncfttm,Constant(-1.0)))
$isst
$pcfncfttm
Mul($vwap,$pbmrq)
$pbmrq
Add(Log(Mul(Sub(Constant(-10.0),$turn),Constant(2.0))),$pcfncfttm)
Mean(Sum($high,20),30)
Sub(Constant(-10.0),Log($isst))
Add(Mul(Less(Constant(10.0),$pbmrq),$open),Sum(Div($pbmrq,$isst),30))
$vwap
$close
$low
Mad(Sub(Constant(-1.0),Add($vwap,$volume)),10)
$open
$open
Div(Max(Var($pcfncfttm,20),10),$pcfncfttm)
Log($preclose)
Add(Constant(1.0),Log(Add($close,Constant(-0.01))))
Add(Sub($preclose,$high),$isst)
Cov(Sub($pettm,Div(Sub($pbmrq,Abs($open)),Constant(10.0))),$isst,10)
Add($amount,$amount)
$vwap
$pcfncfttm
$vwap
$close
$pcfncfttm
$preclose
$low
Add($vwap,$vwap)
Med(Sum(Add(Sub(Constant(-1.0),$pettm),Med($low,10)),20),40)
Med(Div(Constant(-30.0),$vwap),30)
Abs($amount)
Mul($high,$low)
Abs(Std($pettm,40))
Max($isst,10)
$pctchg
Sub(Constant(10.0),$close)
$volume
Ref(Mul(Constant(-2.0),Add(Mul($pcfncfttm,Sub(Constant(5.0),Add($low,Constant(30.0)))),$pettm)),10)
$low
Add(Mad(Abs(Add(Log($preclose),Constant(-2.0))),10),$open)
$pcfncfttm
$pctchg
Max(Add(Constant(-2.0),$close),40)
Max(Add(Constant(10.0),$turn),10)
Sub($volume,$pettm)
Mul(Constant(-10.0),Mad(Min($pettm,20),40))
Add(Div(EMA(Sub($pettm,Constant(-1.0)),30),Constant(-2.0)),$low)
Mad(Mul(Constant(-0.01),$turn),50)
Add(Constant(-0.01),Max(Var($amount,10),30))
$psttm
Log($open)
Div(Constant(-10.0),$psttm)
Div(Sub(Greater(Constant(-30.0),$open),$isst),Constant(2.0))
Delta(Add(Constant(2.0),$vwap),40)
$volume
Sub(Sub(Less(Add(Add(Add($pbmrq,Constant(-10.0)),Std($isst,30)),Constant(-30.0)),Constant(-1.0)),$amount),$turn)
Max($volume,30)
$close
$isst
Mul(Constant(2.0),$open)
$vwap
Add(Sub($high,$pbmrq),Constant(-1.0))
Mul(Constant(-2.0),Add($high,$psttm))
Add(Constant(0.5),Abs(Add($volume,$open)))
Mul(Mad(Add($turn,$close),30),$vwap)
Sum(Sub(Sub(Constant(-30.0),$preclose),$preclose),20)
Log(Add(Div(Mul(Div($isst,Constant(10.0)),Abs($pcfncfttm)),Constant(-2.0)),$amount))
Sub(Constant(-1.0),$preclose)
$pcfncfttm
Med(Sub(Sub(Mul(Sub(Sub(Constant(-1.0),$preclose),Constant(1.0)),Corr($pcfncfttm,$pcfncfttm,30)),Constant(-0.01)),Constant(1.0)),20)
$amount
$high
$pettm
Var($pettm,10)
Sub(Less($close,Constant(-30.0)),$high)
Sub($isst,Add($pettm,$pcfncfttm))
Log(Sub(Constant(-0.5),$psttm))
$pbmrq
$volume
Mul($amount,Constant(1.0))
EMA(Add(Less(Constant(10.0),Sub($high,Constant(5.0))),Add($open,Mul($low,$pettm))),50)
Div(Constant(-2.0),$close)
Log(Mean($pcfncfttm,20))
$pcfncfttm
Mul(Constant(-0.5),Add($turn,$high))
$low
$pcfncfttm
$high
Add($turn,Mul(Corr(Mul($open,$turn),$turn,40),Constant(2.0)))
Mul(Constant(1.0),Sub($close,Constant(-1.0)))
Med($pettm,20)
Div(Add(Constant(1.0),Mul($pctchg,$low)),$close)
Sub(Constant(-30.0),Mul($low,Constant(0.01)))
Abs($amount)
Div(Constant(-0.5),Div(Var($psttm,40),Log($isst)))
Add(Constant(-10.0),$low)
$vwap
$pcfncfttm
Add(Greater(Mul(Constant(1.0),$preclose),Constant(5.0)),$pcfncfttm)
Add(Mul(Constant(2.0),$open),$pctchg)
Sub(Constant(-10.0),$pettm)
Log(Sub(Add(Less(Constant(-0.01),Add(Log($low),Max($low,10))),$open),Abs($close)))
Add(Constant(-10.0),$pbmrq)
Max(Sub(Constant(5.0),$high),20)
Greater(Sub(Constant(-10.0),Abs($pcfncfttm)),Ref(Sub(Constant(-5.0),$preclose),50))
Mul(Constant(30.0),$volume)
Mul($vwap,Constant(-30.0))
$close
Add(Sub(Sub(Constant(-2.0),Sub(Sub($amount,Mul($vwap,Constant(-2.0))),$pettm)),Div($pcfncfttm,$low)),Constant(-1.0))
Sub(EMA($close,10),Constant(-0.5))
Log(Mul(Constant(-0.5),$close))
Mul(Constant(30.0),$high)
Div($low,Add($pbmrq,$turn))
Add($high,$vwap)
$low
$close
$close
$pctchg
$isst
Sub($preclose,Add($pbmrq,$pbmrq))
Add(Constant(-10.0),$close)
Mul(Greater(Constant(10.0),$low),Add($pcfncfttm,Constant(-1.0)))
$preclose
Sum(Mul(Constant(5.0),Add($amount,$volume)),30)
$pbmrq
$isst
Max($close,40)
$preclose
Sub(Constant(-1.0),$pcfncfttm)
Med(Add(Sub(Add(Constant(-30.0),$close),$low),Add($low,$preclose)),20)
Log($pcfncfttm)
$psttm
Sub(Sub(Constant(-2.0),$pcfncfttm),Constant(-2.0))
Add(Mul(Less(Constant(-30.0),Div($volume,$pbmrq)),Min($amount,30)),Sub(Constant(1.0),$pcfncfttm))
$amount
Div($open,Max(Mul(Div(Sub(Mul($pettm,Sub(Constant(30.0),$psttm)),$close),$vwap),Mad($preclose,30)),40))
Sub(Constant(0.01),Mul($high,Constant(2.0)))
Log(Sub(Constant(-30.0),$pcfncfttm))
Sub(Greater(Constant(-2.0),$high),$pcfncfttm)
Mul($volume,Constant(10.0))
$turn
Mul(Sub($pbmrq,$open),Constant(-10.0))
Sub(Sub($low,$pcfncfttm),$high)
Sub(Min(Min(Mad(Add(Constant(-5.0),Sub($psttm,Constant(30.0))),20),20),10),Std($open,10))
Sub(Less(Constant(1.0),$volume),$low)
$pbmrq
Sub(Constant(-0.01),$turn)
$high
Sub(Less(Constant(-0.5),$turn),$pbmrq)
Abs(Sub(Greater(Constant(-2.0),Std($pcfncfttm,50)),Mul(Sub($isst,$low),Mul($preclose,Constant(0.01)))))
$amount
Add($psttm,Constant(1.0))
$pbmrq
Var(Sub(Sub($vwap,$pcfncfttm),$close),50)
Sub(Constant(-1.0),Mul($close,$open))
$low
Mean(Add(Constant(2.0),$pctchg),10)
$isst
Div(Constant(5.0),Min($isst,40))
Sub(Constant(10.0),Div($low,$isst))
$amount
Sub(Constant(-2.0),Sub($pcfncfttm,Mul(Constant(-1.0),$amount)))
Add(Add(Constant(1.0),Div($high,Constant(-5.0))),$pctchg)
Sub(Greater(Greater($pettm,Constant(2.0)),Add(Ref($low,30),$open)),$close)
$preclose
Min(Add(Constant(-2.0),Add($vwap,$pettm)),30)
$vwap
$volume
Mul(Greater($close,Constant(5.0)),$isst)
Sub(Constant(10.0),$close)
$vwap
$vwap
$low
$isst
Mul($pettm,$pettm)
$high
$preclose
$close
Less($low,Div(Min($psttm,10),$open))
$psttm
$isst
Mean(Sub(Constant(1.0),Log(Sum(Sub($vwap,$pcfncfttm),20))),30)
$high
$low
$open
Div(Constant(-1.0),$vwap)
$close
Add(Constant(1.0),$amount)
Add($high,$pcfncfttm)
Sub(Constant(-30.0),$volume)
Min(Div(Constant(-0.5),$close),30)
Div(Div(Constant(0.01),$pcfncfttm),Add($psttm,$isst))
$preclose
Sub(Abs(Add(Constant(-10.0),$pettm)),Constant(-1.0))
Min(Add(Greater($close,Constant(2.0)),$volume),40)
Sub(Constant(30.0),$low)
Add($low,Constant(10.0))
Mul($high,$pbmrq)
$close
Mean(Sub(Mul(Constant(0.5),$high),Log(Sub($close,$pbmrq))),30)
Less(Sub($isst,Constant(30.0)),$pbmrq)
Sub(Constant(-0.5),EMA(Sub(Sub($pbmrq,$close),Constant(-2.0)),10))
$pcfncfttm
Add(Sub(Constant(-10.0),$high),Constant(10.0))
Var($vwap,20)
Mul(Constant(1.0),$pettm)
$high
$vwap
Log(Add(Constant(30.0),Sub($close,Sub(Add($vwap,$low),$turn))))
$amount
$psttm
$volume
$pcfncfttm
Mul(Div(Add($low,Mul($pettm,Constant(-0.5))),Constant(-2.0)),Constant(-30.0))
Sub($low,Constant(1.0))
Sub($low,$amount)
Add(Mul(Sub(Sub($pcfncfttm,$amount),$high),Constant(-5.0)),$low)
$high
$amount
$isst
Greater($pcfncfttm,Sub($open,Corr(Mul($preclose,$psttm),$open,20)))
Sub(Mul(Constant(30.0),$turn),Constant(-30.0))
Sub(Constant(0.01),Ref($low,30))
Add(Constant(30.0),$high)
Div($close,$close)
$pcfncfttm
Mul($volume,Constant(-1.0))
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240103093106/30720_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.269       |
|    eval_cnt             | 1669        |
|    significant          | 200         |
|    size                 | 200         |
| rollout/                |             |
|    ep_len_mean          | 5.12        |
|    ep_rew_mean          | 0.2         |
| test/                   |             |
|    ic                   | 0.068       |
|    rank_ic              | 0.0618      |
| time/                   |             |
|    fps                  | 2           |
|    iterations           | 15          |
|    time_elapsed         | 11393       |
|    total_timesteps      | 30720       |
| train/                  |             |
|    approx_kl            | 0.017513383 |
|    clip_fraction        | 0.221       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.67       |
|    explained_variance   | 1.31e-06    |
|    learning_rate        | 0.001       |
|    loss                 | -0.27       |
|    n_updates            | 140         |
|    policy_gradient_loss | -0.0163     |
|    value_loss           | 0.0589      |
-----------------------------------------
