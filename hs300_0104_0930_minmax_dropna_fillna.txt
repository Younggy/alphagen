[53461:MainThread](2024-01-04 10:04:17,417) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[53461:MainThread](2024-01-04 10:04:17,741) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[53461:MainThread](2024-01-04 10:04:17,742) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/Users/yangguangyu/.qlib/qlib_data/cn_data_rolling')}
instruments: hs300
[53461:MainThread](2024-01-04 10:04:21,678) INFO - qlib.timer - [log.py:127] - Time cost: 0.010s | DropnaProcessor Done
/Users/yangguangyu/anaconda3/envs/quant_dev/lib/python3.9/site-packages/qlib/data/dataset/processor.py:244: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc(axis=1)[self.cols] = normalize(df[self.cols].values)
[53461:MainThread](2024-01-04 10:04:21,691) INFO - qlib.timer - [log.py:127] - Time cost: 0.013s | MinMaxNorm Done
raw df:                             $open      $close  ...     $psttm     $turn
datetime   instrument                          ...                     
2014-08-06 SH600000     36.678059   36.342247  ...   1.720402  0.901515
           SH600009     15.457175   15.367242  ...   4.889094  0.833367
           SH600010      4.297257    4.641038  ...   1.049635  3.491852
           SH600011      7.163883    7.211963  ...   0.627584  0.171663
           SH600015     12.955123   13.058764  ...   1.676678  0.649496
...                           ...         ...  ...        ...       ...
2019-02-19 SZ300661    107.945366  107.527779  ...  10.980824  1.395842
           SZ300750     84.660004   82.290001  ...   6.650053  4.338807
           SZ300751    174.140717  175.225296  ...  13.278975  8.478977
           SZ300759     31.355343   31.355343  ...   7.607547  0.926154
           SZ300760    114.797508  115.075615  ...  10.744785  3.528142

[251929 rows x 15 columns]
preprocessed df:                           $open    $close  ...    $psttm     $turn
datetime   instrument                      ...                    
2014-08-06 SH600000    0.028584  0.028242  ...  0.254788  0.011988
           SH600009    0.011396  0.011234  ...  0.255555  0.011081
           SH600010    0.002358  0.002537  ...  0.254625  0.046468
           SH600011    0.004679  0.004622  ...  0.254523  0.002273
           SH600015    0.009370  0.009362  ...  0.254777  0.008634
...                         ...       ...  ...       ...       ...
2019-02-19 SZ300661    0.086306  0.085962  ...  0.257030  0.018568
           SZ300750    0.067446  0.065498  ...  0.255982  0.057741
           SZ300751    0.139920  0.140853  ...  0.257587  0.112850
           SZ300759    0.024273  0.024198  ...  0.256213  0.012316
           SZ300760    0.091856  0.092082  ...  0.256973  0.046951

[239936 rows x 15 columns]
df after stack: instrument            SH600000  SH600009  ...  SZ300759  SZ300760
datetime                                  ...                    
2014-08-06 $open      0.028584  0.011396  ...       NaN       NaN
           $close     0.028242  0.011234  ...       NaN       NaN
           $high      0.028361  0.011246  ...       NaN       NaN
           $low       0.028466  0.011372  ...       NaN       NaN
           $volume    0.006786  0.001526  ...       NaN       NaN
...                        ...       ...  ...       ...       ...
2019-02-19 $pctchg    0.030978  0.039800  ...  0.063966  0.034362
           $pettm     0.033634  0.033663  ...  0.033724  0.033684
           $preclose  0.050838  0.051173  ...  0.022252  0.091778
           $psttm     0.254819  0.257211  ...  0.256213  0.256973
           $turn      0.001218  0.010565  ...  0.012316  0.046951

[16575 rows x 254 columns]
features: ['$open', '$close', '$high', '$low', '$volume', '$vwap', '$amount', '$isst', '$pbmrq', '$pcfncfttm', '$pctchg', '$pettm', '$preclose', '$psttm', '$turn']
dates: DatetimeIndex(['2014-08-06', '2014-08-07', '2014-08-08', '2014-08-11',
               '2014-08-12', '2014-08-13', '2014-08-14', '2014-08-15',
               '2014-08-18', '2014-08-19',
               ...
               '2019-01-30', '2019-01-31', '2019-02-01', '2019-02-11',
               '2019-02-12', '2019-02-13', '2019-02-14', '2019-02-15',
               '2019-02-18', '2019-02-19'],
              dtype='datetime64[ns]', name='datetime', length=1105, freq=None)
stock ids: Index(['SH600000', 'SH600009', 'SH600010', 'SH600011', 'SH600015', 'SH600016',
       'SH600018', 'SH600019', 'SH600023', 'SH600025',
       ...
       'SZ300450', 'SZ300454', 'SZ300496', 'SZ300498', 'SZ300628', 'SZ300661',
       'SZ300750', 'SZ300751', 'SZ300759', 'SZ300760'],
      dtype='object', name='instrument', length=254)
values: [[[0.02858387 0.01139633 0.00235752 ...        nan        nan        nan]
  [0.02824152 0.01123416 0.00253692 ...        nan        nan        nan]
  [0.02836068 0.01124635 0.002613   ...        nan        nan        nan]
  ...
  [0.02899857 0.0116682  0.00265638 ...        nan        nan        nan]
  [0.25478786 0.25555515 0.25462544 ...        nan        nan        nan]
  [0.01198829 0.01108119 0.04646767 ...        nan        nan        nan]]

 [[0.02834211 0.0113326  0.00292259 ...        nan        nan        nan]
  [0.02769695 0.01112477 0.00291406 ...        nan        nan        nan]
  [0.02821022 0.01121915 0.00289841 ...        nan        nan        nan]
  ...
  [0.02860542 0.01160442 0.00291044 ...        nan        nan        nan]
  [0.25478014 0.25554478 0.2546509  ...        nan        nan        nan]
  [0.01258709 0.01091674 0.1009303  ...        nan        nan        nan]]

 [[0.02776792 0.01120513 0.00288983 ...        nan        nan        nan]
  [0.02763643 0.01116123 0.00277468 ...        nan        nan        nan]
  [0.02766857 0.01114662 0.00283317 ...        nan        nan        nan]
  ...
  [0.02806104 0.01149508 0.00328743 ...        nan        nan        nan]
  [0.25477928 0.25554824 0.25464147 ...        nan        nan        nan]
  [0.01077982 0.00587949 0.06488907 ...        nan        nan        nan]]

 ...

 [[0.05024226 0.05086301 0.00245328 ... 0.13733275 0.01986388 0.09155793]
  [0.04962396 0.04962479 0.00230813 ... 0.13593188 0.01978408 0.08989917]
  [0.05025892 0.05129386 0.00234139 ... 0.14002475 0.01967783 0.09141893]
  ...
  [0.05074279 0.05114395 0.00272762 ... 0.13773136 0.01824404 0.09232505]
  [0.25481293 0.25708112 0.25462472 ... 0.25747544 0.25589365 0.2569123 ]
  [0.00082954 0.00946376 0.00696014 ... 0.0857746  0.00843142 0.02821018]]

 [[0.05009931 0.05033554 0.00243035 ... 0.13554363 0.02196338 0.08992489]
  [0.05048259 0.05081783 0.00239993 ... 0.13835232 0.02188592 0.09143739]
  [0.05035381 0.0510896  0.00238705 ... 0.13902968 0.02176838 0.09149903]
  ...
  [0.04997984 0.04998068 0.00268174 ... 0.13625544 0.02015115 0.09023997]
  [0.2548204  0.25714472 0.25463128 ... 0.2575302  0.25604594 0.25695518]
  [0.00094054 0.01089479 0.01248058 ... 0.07438682 0.00783357 0.03834887]]

 [[0.05057579 0.05111699 0.0024762  ... 0.13991974 0.02427282 0.09185558]
  [0.05029178 0.05206955 0.00239993 ... 0.14085343 0.02419795 0.09208167]
  [0.05078082 0.05301545 0.00245553 ... 0.14616372 0.02406799 0.09514369]
  ...
  [0.05083815 0.05117327 0.00277351 ... 0.13867497 0.0222522  0.09177762]
  [0.2548187  0.2572114  0.25463128 ... 0.2575868  0.25621346 0.25697315]
  [0.00121763 0.01056457 0.0151949  ... 0.11285014 0.01231626 0.04695072]]], (1105, 15, 254)
train data: tensor([[[0.0286, 0.0114, 0.0024,  ...,    nan,    nan,    nan],
         [0.0282, 0.0112, 0.0025,  ...,    nan,    nan,    nan],
         [0.0284, 0.0112, 0.0026,  ...,    nan,    nan,    nan],
         ...,
         [0.0290, 0.0117, 0.0027,  ...,    nan,    nan,    nan],
         [0.2548, 0.2556, 0.2546,  ...,    nan,    nan,    nan],
         [0.0120, 0.0111, 0.0465,  ...,    nan,    nan,    nan]],

        [[0.0283, 0.0113, 0.0029,  ...,    nan,    nan,    nan],
         [0.0277, 0.0111, 0.0029,  ...,    nan,    nan,    nan],
         [0.0282, 0.0112, 0.0029,  ...,    nan,    nan,    nan],
         ...,
         [0.0286, 0.0116, 0.0029,  ...,    nan,    nan,    nan],
         [0.2548, 0.2555, 0.2547,  ...,    nan,    nan,    nan],
         [0.0126, 0.0109, 0.1009,  ...,    nan,    nan,    nan]],

        [[0.0278, 0.0112, 0.0029,  ...,    nan,    nan,    nan],
         [0.0276, 0.0112, 0.0028,  ...,    nan,    nan,    nan],
         [0.0277, 0.0111, 0.0028,  ...,    nan,    nan,    nan],
         ...,
         [0.0281, 0.0115, 0.0033,  ...,    nan,    nan,    nan],
         [0.2548, 0.2555, 0.2546,  ...,    nan,    nan,    nan],
         [0.0108, 0.0059, 0.0649,  ...,    nan,    nan,    nan]],

        ...,

        [[0.0502, 0.0509, 0.0025,  ..., 0.1373, 0.0199, 0.0916],
         [0.0496, 0.0496, 0.0023,  ..., 0.1359, 0.0198, 0.0899],
         [0.0503, 0.0513, 0.0023,  ..., 0.1400, 0.0197, 0.0914],
         ...,
         [0.0507, 0.0511, 0.0027,  ..., 0.1377, 0.0182, 0.0923],
         [0.2548, 0.2571, 0.2546,  ..., 0.2575, 0.2559, 0.2569],
         [0.0008, 0.0095, 0.0070,  ..., 0.0858, 0.0084, 0.0282]],

        [[0.0501, 0.0503, 0.0024,  ..., 0.1355, 0.0220, 0.0899],
         [0.0505, 0.0508, 0.0024,  ..., 0.1384, 0.0219, 0.0914],
         [0.0504, 0.0511, 0.0024,  ..., 0.1390, 0.0218, 0.0915],
         ...,
         [0.0500, 0.0500, 0.0027,  ..., 0.1363, 0.0202, 0.0902],
         [0.2548, 0.2571, 0.2546,  ..., 0.2575, 0.2560, 0.2570],
         [0.0009, 0.0109, 0.0125,  ..., 0.0744, 0.0078, 0.0383]],

        [[0.0506, 0.0511, 0.0025,  ..., 0.1399, 0.0243, 0.0919],
         [0.0503, 0.0521, 0.0024,  ..., 0.1409, 0.0242, 0.0921],
         [0.0508, 0.0530, 0.0025,  ..., 0.1462, 0.0241, 0.0951],
         ...,
         [0.0508, 0.0512, 0.0028,  ..., 0.1387, 0.0223, 0.0918],
         [0.2548, 0.2572, 0.2546,  ..., 0.2576, 0.2562, 0.2570],
         [0.0012, 0.0106, 0.0152,  ..., 0.1129, 0.0123, 0.0470]]]), torch.Size([1105, 15, 254])
instruments: hs300
[53461:MainThread](2024-01-04 10:04:26,023) INFO - qlib.timer - [log.py:127] - Time cost: 0.445s | CSZFillna Done
[53461:MainThread](2024-01-04 10:04:26,029) INFO - qlib.timer - [log.py:127] - Time cost: 0.004s | DropnaProcessor Done
[53461:MainThread](2024-01-04 10:04:26,031) INFO - qlib.timer - [log.py:127] - Time cost: 0.002s | MinMaxNorm Done
raw df:                             $open      $close  ...     $psttm      $turn
datetime   instrument                          ...                      
2018-08-03 SH600000     57.594746   57.830067  ...   1.745467   0.060483
           SH600009     74.151337   71.261703  ...  13.612852   0.662246
           SH600010      4.528701    4.472093  ...   1.285209   0.548638
           SH600011     10.894892   10.532657  ...   0.703142   0.260177
           SH600015     17.312105   17.288551  ...   1.426968   0.077760
...                           ...         ...  ...        ...        ...
2020-02-20 SZ300751    210.300003  221.039993  ...   9.349808   4.972300
           SZ300759     62.450001   61.599998  ...  13.984790   1.604300
           SZ300760    234.800003  234.990005  ...  18.020260   0.970900
           SZ300763     76.010002   81.680000  ...   6.418219  26.974701
           SZ300782    511.200012  551.090027  ...  49.872787   6.694400

[95573 rows x 15 columns]
preprocessed df:                           $open    $close  ...    $psttm     $turn
datetime   instrument                      ...                    
2018-08-03 SH600000    0.045525  0.045665  ...  0.254794  0.000794
           SH600009    0.058935  0.056556  ...  0.257668  0.008803
           SH600010    0.002545  0.002400  ...  0.254682  0.007291
           SH600011    0.007701  0.007314  ...  0.254542  0.003452
           SH600015    0.012899  0.012792  ...  0.254717  0.001023
...                         ...       ...  ...       ...       ...
2020-02-20 SZ300751    0.169206  0.178002  ...  0.256635  0.066174
           SZ300759    0.049457  0.048722  ...  0.257758  0.021343
           SZ300760    0.189050  0.189313  ...  0.258735  0.012912
           SZ300763    0.060440  0.065003  ...  0.255925  0.359042
           SZ300782    0.412916  0.445620  ...  0.266448  0.089096

[95573 rows x 15 columns]
df after stack: instrument            SH600000  SH600009  ...  SZ300763  SZ300782
datetime                                  ...                    
2018-08-03 $open      0.045525  0.058935  ...       NaN       NaN
           $close     0.045665  0.056556  ...       NaN       NaN
           $high      0.046131  0.059122  ...       NaN       NaN
           $low       0.046023  0.057217  ...       NaN       NaN
           $volume    0.000544  0.001141  ...       NaN       NaN
...                        ...       ...  ...       ...       ...
2020-02-20 $pctchg    0.035586  0.039740  ...  0.063976  0.051166
           $pettm     0.033634  0.033666  ...  0.033712  0.033857
           $preclose  0.053772  0.070161  ...  0.059331  0.420628
           $psttm     0.254790  0.257614  ...  0.255925  0.266448
           $turn      0.001724  0.020205  ...  0.359042  0.089096

[5610 rows x 265 columns]
features: ['$open', '$close', '$high', '$low', '$volume', '$vwap', '$amount', '$isst', '$pbmrq', '$pcfncfttm', '$pctchg', '$pettm', '$preclose', '$psttm', '$turn']
dates: DatetimeIndex(['2018-08-03', '2018-08-06', '2018-08-07', '2018-08-08',
               '2018-08-09', '2018-08-10', '2018-08-13', '2018-08-14',
               '2018-08-15', '2018-08-16',
               ...
               '2020-02-07', '2020-02-10', '2020-02-11', '2020-02-12',
               '2020-02-13', '2020-02-14', '2020-02-17', '2020-02-18',
               '2020-02-19', '2020-02-20'],
              dtype='datetime64[ns]', name='datetime', length=374, freq=None)
stock ids: Index(['SH600000', 'SH600009', 'SH600010', 'SH600011', 'SH600015', 'SH600016',
       'SH600018', 'SH600019', 'SH600023', 'SH600025',
       ...
       'SZ300496', 'SZ300498', 'SZ300628', 'SZ300661', 'SZ300750', 'SZ300751',
       'SZ300759', 'SZ300760', 'SZ300763', 'SZ300782'],
      dtype='object', name='instrument', length=265)
values: [[[0.04552504 0.05893481 0.00254498 ...        nan        nan        nan]
  [0.04566471 0.05655561 0.00239993 ...        nan        nan        nan]
  [0.04613115 0.0591216  0.00250118 ...        nan        nan        nan]
  ...
  [0.04583134 0.0592317  0.00284233 ...        nan        nan        nan]
  [0.2547939  0.25766766 0.25468245 ...        nan        nan        nan]
  [0.00079351 0.00880344 0.00729123 ...        nan        nan        nan]]

 [[0.04638271 0.05506635 0.0024762  ...        nan        nan        nan]
  [0.04604632 0.05197605 0.00239993 ...        nan        nan        nan]
  [0.04636837 0.05516369 0.0024327  ...        nan        nan        nan]
  ...
  [0.04602207 0.0569089  0.00277351 ...        nan        nan        nan]
  [0.25479734 0.2574064  0.25468245 ...        nan        nan        nan]
  [0.00081466 0.01931616 0.00650441 ...        nan        nan        nan]]

 [[0.04623977 0.05094645 0.00252205 ...        nan        nan        nan]
  [0.04700036 0.05300234 0.00251469 ...        nan        nan        nan]
  [0.04679538 0.05282362 0.00252401 ...        nan        nan        nan]
  ...
  [0.04640354 0.05233106 0.00277351 ...        nan        nan        nan]
  [0.25480595 0.25746495 0.25469232 ...        nan        nan        nan]
  [0.00102022 0.01274341 0.00757161 ...        nan        nan        nan]]

 ...

 [[0.0533619  0.06916729 0.00169132 ... 0.19169022 0.05365294 0.38667405]
  [0.05317196 0.06872862 0.00159122 ... 0.19523215 0.05568663 0.4244647 ]
  [0.05347344 0.06947701 0.00160565 ... 0.19628859 0.05538756 0.4228222 ]
  ...
  [0.05411651 0.06965861 0.0019651  ... 0.19477162 0.05086903 0.3865769 ]
  [0.25478348 0.25748986 0.25457588 ... 0.2588705  0.25570682 0.26587647]
  [0.00141668 0.01571245 0.01051991 ... 0.01026302 0.12297596 0.09804755]]

 [[0.05331277 0.06892117 0.00169132 ... 0.19245966 0.06124204 0.41275397]
  [0.05341788 0.06981273 0.00154504 ... 0.18915898 0.05897864 0.4204105 ]
  [0.05376696 0.0698299  0.00158268 ... 0.19393365 0.06104909 0.44154075]
  ...
  [0.05352652 0.06907735 0.0019651  ... 0.19553351 0.05604025 0.4246802 ]
  [0.25478348 0.25748986 0.25457254 ... 0.2588705  0.25570682 0.26587647]
  [0.00117708 0.01403129 0.00908634 ... 0.01678929 0.40008754 0.09299744]]

 [[0.05375494 0.06980719 0.00166825 ... 0.18904984 0.06044021 0.41291597]
  [0.05400809 0.07150789 0.00159122 ... 0.18931304 0.06500318 0.44561955]
  [0.05391372 0.07153556 0.00160565 ... 0.19056255 0.06465407 0.45444453]
  ...
  [0.05377235 0.07016105 0.00191893 ... 0.1894626  0.05933102 0.4206275 ]
  [0.25478983 0.25761378 0.25457588 ... 0.25873494 0.25592545 0.2664482 ]
  [0.00172416 0.02020483 0.01087265 ... 0.01291186 0.35904247 0.08909605]]], (374, 15, 265)
valid data: tensor([[[0.0455, 0.0589, 0.0025,  ...,    nan,    nan,    nan],
         [0.0457, 0.0566, 0.0024,  ...,    nan,    nan,    nan],
         [0.0461, 0.0591, 0.0025,  ...,    nan,    nan,    nan],
         ...,
         [0.0458, 0.0592, 0.0028,  ...,    nan,    nan,    nan],
         [0.2548, 0.2577, 0.2547,  ...,    nan,    nan,    nan],
         [0.0008, 0.0088, 0.0073,  ...,    nan,    nan,    nan]],

        [[0.0464, 0.0551, 0.0025,  ...,    nan,    nan,    nan],
         [0.0460, 0.0520, 0.0024,  ...,    nan,    nan,    nan],
         [0.0464, 0.0552, 0.0024,  ...,    nan,    nan,    nan],
         ...,
         [0.0460, 0.0569, 0.0028,  ...,    nan,    nan,    nan],
         [0.2548, 0.2574, 0.2547,  ...,    nan,    nan,    nan],
         [0.0008, 0.0193, 0.0065,  ...,    nan,    nan,    nan]],

        [[0.0462, 0.0509, 0.0025,  ...,    nan,    nan,    nan],
         [0.0470, 0.0530, 0.0025,  ...,    nan,    nan,    nan],
         [0.0468, 0.0528, 0.0025,  ...,    nan,    nan,    nan],
         ...,
         [0.0464, 0.0523, 0.0028,  ...,    nan,    nan,    nan],
         [0.2548, 0.2575, 0.2547,  ...,    nan,    nan,    nan],
         [0.0010, 0.0127, 0.0076,  ...,    nan,    nan,    nan]],

        ...,

        [[0.0534, 0.0692, 0.0017,  ..., 0.1917, 0.0537, 0.3867],
         [0.0532, 0.0687, 0.0016,  ..., 0.1952, 0.0557, 0.4245],
         [0.0535, 0.0695, 0.0016,  ..., 0.1963, 0.0554, 0.4228],
         ...,
         [0.0541, 0.0697, 0.0020,  ..., 0.1948, 0.0509, 0.3866],
         [0.2548, 0.2575, 0.2546,  ..., 0.2589, 0.2557, 0.2659],
         [0.0014, 0.0157, 0.0105,  ..., 0.0103, 0.1230, 0.0980]],

        [[0.0533, 0.0689, 0.0017,  ..., 0.1925, 0.0612, 0.4128],
         [0.0534, 0.0698, 0.0015,  ..., 0.1892, 0.0590, 0.4204],
         [0.0538, 0.0698, 0.0016,  ..., 0.1939, 0.0610, 0.4415],
         ...,
         [0.0535, 0.0691, 0.0020,  ..., 0.1955, 0.0560, 0.4247],
         [0.2548, 0.2575, 0.2546,  ..., 0.2589, 0.2557, 0.2659],
         [0.0012, 0.0140, 0.0091,  ..., 0.0168, 0.4001, 0.0930]],

        [[0.0538, 0.0698, 0.0017,  ..., 0.1890, 0.0604, 0.4129],
         [0.0540, 0.0715, 0.0016,  ..., 0.1893, 0.0650, 0.4456],
         [0.0539, 0.0715, 0.0016,  ..., 0.1906, 0.0647, 0.4544],
         ...,
         [0.0538, 0.0702, 0.0019,  ..., 0.1895, 0.0593, 0.4206],
         [0.2548, 0.2576, 0.2546,  ..., 0.2587, 0.2559, 0.2664],
         [0.0017, 0.0202, 0.0109,  ..., 0.0129, 0.3590, 0.0891]]]), torch.Size([374, 15, 265])
instruments: hs300
[53461:MainThread](2024-01-04 10:04:31,094) INFO - qlib.timer - [log.py:127] - Time cost: 1.254s | CSZFillna Done
[53461:MainThread](2024-01-04 10:04:31,103) INFO - qlib.timer - [log.py:127] - Time cost: 0.009s | DropnaProcessor Done
[53461:MainThread](2024-01-04 10:04:31,108) INFO - qlib.timer - [log.py:127] - Time cost: 0.005s | MinMaxNorm Done
raw df:                             $open      $close  ...     $psttm   $turn
datetime   instrument                          ...                   
2019-08-06 SH600000     67.331314   67.270660  ...   1.786627  0.1608
           SH600009     93.082047   95.216736  ...  15.513098  1.1181
           SH600010      4.357638    4.272194  ...   1.010858  0.9161
           SH600011      9.384294    9.624917  ...   0.625742  0.2261
           SH600015     17.344748   17.417017  ...   1.467073  0.1580
...                           ...         ...  ...        ...     ...
2023-08-11 SZ300751    963.043640  941.549194  ...  12.552358  0.7226
           SZ300759     69.619865   67.315178  ...   4.841266  2.0063
           SZ300760    280.070007  276.232025  ...  10.157454  0.3799
           SZ300763    400.967407  391.187714  ...   5.525766  2.7863
           SZ300782    654.953186  639.436157  ...  21.357079  0.4208

[259698 rows x 15 columns]
preprocessed df:                           $open    $close  ...    $psttm     $turn
datetime   instrument                      ...                    
2019-08-06 SH600000    0.053411  0.053320  ...  0.254804  0.002129
           SH600009    0.074267  0.075979  ...  0.258128  0.014871
           SH600010    0.002406  0.002238  ...  0.254616  0.012182
           SH600011    0.006478  0.006578  ...  0.254523  0.002998
           SH600015    0.012925  0.012896  ...  0.254726  0.002092
...                         ...       ...  ...       ...       ...
2023-08-11 SZ300751    0.778880  0.762219  ...  0.257411  0.009607
           SZ300759    0.055265  0.053356  ...  0.255544  0.026694
           SZ300760    0.225716  0.222754  ...  0.256831  0.005045
           SZ300763    0.323635  0.315964  ...  0.255709  0.037076
           SZ300782    0.529347  0.517254  ...  0.259543  0.005590

[259698 rows x 15 columns]
df after stack: instrument            SH600000  SH600009  ...  SZ300763  SZ300782
datetime                                  ...                    
2019-08-06 $open      0.053411  0.074267  ...  0.027742  0.180641
           $close     0.053320  0.075979  ...  0.027924  0.185682
           $high      0.053718  0.076301  ...  0.027845  0.187693
           $low       0.053517  0.074503  ...  0.026886  0.179594
           $volume    0.001402  0.001908  ...  0.000233  0.000384
...                        ...       ...  ...       ...       ...
2023-08-11 $pctchg    0.024008  0.027497  ...  0.022598  0.025735
           $pettm     0.033633  0.033559  ...  0.033668  0.033757
           $preclose  0.043725  0.046749  ...  0.326040  0.528106
           $psttm     0.254655  0.259250  ...  0.255709  0.259543
           $turn      0.001668  0.012491  ...  0.037076  0.005590

[14640 rows x 267 columns]
features: ['$open', '$close', '$high', '$low', '$volume', '$vwap', '$amount', '$isst', '$pbmrq', '$pcfncfttm', '$pctchg', '$pettm', '$preclose', '$psttm', '$turn']
dates: DatetimeIndex(['2019-08-06', '2019-08-07', '2019-08-08', '2019-08-09',
               '2019-08-12', '2019-08-13', '2019-08-14', '2019-08-15',
               '2019-08-16', '2019-08-19',
               ...
               '2023-07-31', '2023-08-01', '2023-08-02', '2023-08-03',
               '2023-08-04', '2023-08-07', '2023-08-08', '2023-08-09',
               '2023-08-10', '2023-08-11'],
              dtype='datetime64[ns]', name='datetime', length=976, freq=None)
stock ids: Index(['SH600000', 'SH600009', 'SH600010', 'SH600011', 'SH600015', 'SH600016',
       'SH600018', 'SH600019', 'SH600023', 'SH600025',
       ...
       'SZ300496', 'SZ300498', 'SZ300628', 'SZ300661', 'SZ300750', 'SZ300751',
       'SZ300759', 'SZ300760', 'SZ300763', 'SZ300782'],
      dtype='object', name='instrument', length=267)
values: [[[0.05341103 0.07426745 0.00240643 ... 0.12036732 0.0277425  0.18064068]
  [0.05331951 0.0759793  0.00223785 ... 0.12267821 0.02792429 0.18568161]
  [0.05371804 0.07630075 0.00229474 ... 0.12367266 0.02784504 0.18769273]
  ...
  [0.05441151 0.07672611 0.00274999 ... 0.12345254 0.02860418 0.18548535]
  [0.2548039  0.2581278  0.25461602 ... 0.25749025 0.2552113  0.26348966]
  [0.0021288  0.0148712  0.01218243 ... 0.0239984  0.08016985 0.10841663]]

 [[0.05360755 0.07668019 0.00233722 ... 0.12333168 0.02812127 0.18571368]
  [0.05322114 0.07603798 0.00228404 ... 0.12515938 0.02869848 0.18965237]
  [0.0533756  0.07717613 0.00231771 ... 0.12558404 0.02872508 0.19584896]
  ...
  [0.05367402 0.07632532 0.00261148 ... 0.12300675 0.0282883  0.18598655]
  [0.25480312 0.25813067 0.25461927 ... 0.25755268 0.25523362 0.26368338]
  [0.00147791 0.00732267 0.00905972 ... 0.01966175 0.09325168 0.13284455]]

 [[0.05365668 0.07642622 0.00236029 ... 0.12627985 0.02872099 0.19274965]
  [0.05415565 0.07773953 0.00226094 ... 0.12862977 0.02970176 0.206619  ]
  [0.05410941 0.07842112 0.00227177 ... 0.12914869 0.02996655 0.20761678]
  ...
  [0.05357568 0.07638398 0.00265765 ... 0.12548698 0.0290622  0.18995582]
  [0.2548105  0.2582135  0.25461766 ... 0.25764003 0.25526252 0.2645111 ]
  [0.0015631  0.01001011 0.00585715 ... 0.02219346 0.14612073 0.19687735]]

 ...

 [[0.04390077 0.04456265 0.00327189 ... 0.22857209 0.30650836 0.5235918 ]
  [0.04414831 0.04475932 0.00317356 ... 0.22691707 0.30849895 0.52199876]
  [0.04391121 0.04482591 0.00320283 ... 0.227497   0.31327268 0.5275803 ]
  ...
  [0.04432602 0.04506727 0.00354684 ... 0.22654234 0.31136444 0.5268359 ]
  [0.25465867 0.2591528  0.25467178 ... 0.25687665 0.25567785 0.2595903 ]
  [0.00079507 0.00445819 0.00721884 ... 0.0095642  0.02251691 0.0072468 ]]

 [[0.04360062 0.04516927 0.00327189 ... 0.22655575 0.30583045 0.51754063]
  [0.04336703 0.04639206 0.00315028 ... 0.22604235 0.32578728 0.5279296 ]
  [0.04337323 0.04616272 0.00317967 ... 0.22620872 0.33011287 0.5273697 ]
  ...
  [0.04450625 0.04511703 0.00354684 ... 0.22720656 0.3087579  0.52217776]
  [0.25466228 0.25932255 0.25467017 ... 0.25686705 0.25575078 0.2596495 ]
  [0.0023857  0.01611044 0.00677293 ... 0.00646812 0.079097   0.00677693]]

 [[0.04354059 0.04647201 0.00327189 ... 0.2257156  0.32363468 0.52934676]
  [0.04222515 0.04569516 0.00305717 ... 0.22275372 0.31596437 0.5172541 ]
  [0.04325368 0.04666773 0.00315652 ... 0.22598283 0.32307836 0.52930784]
  ...
  [0.04372526 0.04674916 0.00352357 ... 0.22633216 0.32603973 0.52810633]
  [0.25465485 0.2592501  0.25466383 ... 0.25683093 0.25570932 0.25954297]
  [0.00166825 0.01249124 0.00837821 ... 0.00504519 0.03707623 0.0055896 ]]], (976, 15, 267)
/Users/yangguangyu/anaconda3/envs/quant_dev/lib/python3.9/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.activation_relu_or_gelu was not True
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
test data: tensor([[[0.0534, 0.0743, 0.0024,  ..., 0.1204, 0.0277, 0.1806],
         [0.0533, 0.0760, 0.0022,  ..., 0.1227, 0.0279, 0.1857],
         [0.0537, 0.0763, 0.0023,  ..., 0.1237, 0.0278, 0.1877],
         ...,
         [0.0544, 0.0767, 0.0027,  ..., 0.1235, 0.0286, 0.1855],
         [0.2548, 0.2581, 0.2546,  ..., 0.2575, 0.2552, 0.2635],
         [0.0021, 0.0149, 0.0122,  ..., 0.0240, 0.0802, 0.1084]],

        [[0.0536, 0.0767, 0.0023,  ..., 0.1233, 0.0281, 0.1857],
         [0.0532, 0.0760, 0.0023,  ..., 0.1252, 0.0287, 0.1897],
         [0.0534, 0.0772, 0.0023,  ..., 0.1256, 0.0287, 0.1958],
         ...,
         [0.0537, 0.0763, 0.0026,  ..., 0.1230, 0.0283, 0.1860],
         [0.2548, 0.2581, 0.2546,  ..., 0.2576, 0.2552, 0.2637],
         [0.0015, 0.0073, 0.0091,  ..., 0.0197, 0.0933, 0.1328]],

        [[0.0537, 0.0764, 0.0024,  ..., 0.1263, 0.0287, 0.1927],
         [0.0542, 0.0777, 0.0023,  ..., 0.1286, 0.0297, 0.2066],
         [0.0541, 0.0784, 0.0023,  ..., 0.1291, 0.0300, 0.2076],
         ...,
         [0.0536, 0.0764, 0.0027,  ..., 0.1255, 0.0291, 0.1900],
         [0.2548, 0.2582, 0.2546,  ..., 0.2576, 0.2553, 0.2645],
         [0.0016, 0.0100, 0.0059,  ..., 0.0222, 0.1461, 0.1969]],

        ...,

        [[0.0439, 0.0446, 0.0033,  ..., 0.2286, 0.3065, 0.5236],
         [0.0441, 0.0448, 0.0032,  ..., 0.2269, 0.3085, 0.5220],
         [0.0439, 0.0448, 0.0032,  ..., 0.2275, 0.3133, 0.5276],
         ...,
         [0.0443, 0.0451, 0.0035,  ..., 0.2265, 0.3114, 0.5268],
         [0.2547, 0.2592, 0.2547,  ..., 0.2569, 0.2557, 0.2596],
         [0.0008, 0.0045, 0.0072,  ..., 0.0096, 0.0225, 0.0072]],

        [[0.0436, 0.0452, 0.0033,  ..., 0.2266, 0.3058, 0.5175],
         [0.0434, 0.0464, 0.0032,  ..., 0.2260, 0.3258, 0.5279],
         [0.0434, 0.0462, 0.0032,  ..., 0.2262, 0.3301, 0.5274],
         ...,
         [0.0445, 0.0451, 0.0035,  ..., 0.2272, 0.3088, 0.5222],
         [0.2547, 0.2593, 0.2547,  ..., 0.2569, 0.2558, 0.2596],
         [0.0024, 0.0161, 0.0068,  ..., 0.0065, 0.0791, 0.0068]],

        [[0.0435, 0.0465, 0.0033,  ..., 0.2257, 0.3236, 0.5293],
         [0.0422, 0.0457, 0.0031,  ..., 0.2228, 0.3160, 0.5173],
         [0.0433, 0.0467, 0.0032,  ..., 0.2260, 0.3231, 0.5293],
         ...,
         [0.0437, 0.0467, 0.0035,  ..., 0.2263, 0.3260, 0.5281],
         [0.2547, 0.2593, 0.2547,  ..., 0.2568, 0.2557, 0.2595],
         [0.0017, 0.0125, 0.0084,  ..., 0.0050, 0.0371, 0.0056]]]), torch.Size([976, 15, 267])
Using cpu device
Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.
Logging to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104100431_1
/Users/yangguangyu/anaconda3/envs/quant_dev/lib/python3.9/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.action_masks to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.action_masks` for environment variables or `env.get_wrapper_attr('action_masks')` that will search the reminding wrappers.[0m
  logger.warn(
/Users/yangguangyu/anaconda3/envs/quant_dev/lib/python3.9/site-packages/stable_baselines3/common/save_util.py:283: UserWarning: Path '/Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104100431' does not exist. Will create it.
  warnings.warn(f"Path '{path.parent}' does not exist. Will create it.")
Add(Constant(-0.5),Sub($low,Constant(-0.5)))
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104100431/2048_steps
---------------------------------
| pool/              |          |
|    best_ic_ret     | 0.00298  |
|    eval_cnt        | 1        |
|    significant     | 1        |
|    size            | 1        |
| rollout/           |          |
|    ep_len_mean     | 19.9     |
|    ep_rew_mean     | -0.99    |
| test/              |          |
|    ic              | 0.0147   |
|    rank_ic         | 0.0156   |
| time/              |          |
|    fps             | 283      |
|    iterations      | 1        |
|    time_elapsed    | 7        |
|    total_timesteps | 2048     |
---------------------------------
/Users/yangguangyu/anaconda3/envs/quant_dev/lib/python3.9/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.action_masks to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.action_masks` for environment variables or `env.get_wrapper_attr('action_masks')` that will search the reminding wrappers.[0m
  logger.warn(
$amount
$pcfncfttm
$psttm
$volume
$psttm
$psttm
Sub(Constant(-2.0),$pettm)
$preclose
Var(Var(Mul(Med($pbmrq,40),Div(Add(Constant(-2.0),$open),Constant(30.0))),50),10)
Add($turn,Constant(10.0))
$pbmrq
Cov($pbmrq,$psttm,20)
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104100431/4096_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.0754      |
|    eval_cnt             | 10          |
|    significant          | 9           |
|    size                 | 10          |
| rollout/                |             |
|    ep_len_mean          | 18.2        |
|    ep_rew_mean          | -0.884      |
| test/                   |             |
|    ic                   | 0.0265      |
|    rank_ic              | 0.0505      |
| time/                   |             |
|    fps                  | 70          |
|    iterations           | 2           |
|    time_elapsed         | 57          |
|    total_timesteps      | 4096        |
| train/                  |             |
|    approx_kl            | 0.015922163 |
|    clip_fraction        | 0.211       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.42       |
|    explained_variance   | -2.95       |
|    learning_rate        | 0.001       |
|    loss                 | -0.343      |
|    n_updates            | 10          |
|    policy_gradient_loss | -0.021      |
|    value_loss           | 0.0823      |
-----------------------------------------
$turn
$close
Div(Constant(-1.0),$amount)
Ref($pbmrq,50)
Mean(Mul($high,Std($close,50)),10)
Min($pctchg,40)
Var(Abs($volume),20)
Div(Div($isst,$preclose),Mean($turn,10))
Less($pettm,$amount)
Sub(Constant(-0.01),$vwap)
Add(Constant(10.0),Log(EMA(Cov(WMA(Sub($pcfncfttm,Greater($high,Constant(0.5))),20),$turn,10),40)))
Mul(Greater($volume,$pcfncfttm),Constant(-1.0))
$pcfncfttm
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104100431/6144_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.169       |
|    eval_cnt             | 20          |
|    significant          | 19          |
|    size                 | 20          |
| rollout/                |             |
|    ep_len_mean          | 18.4        |
|    ep_rew_mean          | -0.873      |
| test/                   |             |
|    ic                   | 0.0289      |
|    rank_ic              | 0.0558      |
| time/                   |             |
|    fps                  | 54          |
|    iterations           | 3           |
|    time_elapsed         | 113         |
|    total_timesteps      | 6144        |
| train/                  |             |
|    approx_kl            | 0.015291875 |
|    clip_fraction        | 0.22        |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.42       |
|    explained_variance   | 4.23e-06    |
|    learning_rate        | 0.001       |
|    loss                 | -0.359      |
|    n_updates            | 20          |
|    policy_gradient_loss | -0.0191     |
|    value_loss           | 0.0187      |
-----------------------------------------
Mad(Greater(Max($turn,40),$low),30)
$high
$pettm
$high
$preclose
Mad($volume,10)
$pctchg
Sub(Constant(-30.0),$preclose)
$psttm
Mul($turn,Abs(Mad(Var(Min($vwap,40),10),10)))
Sub(Div($pcfncfttm,$pcfncfttm),Greater(Constant(5.0),Min($pcfncfttm,20)))
Mul($high,Constant(-0.01))
$pctchg
$amount
$psttm
$preclose
$psttm
Add($low,Constant(2.0))
$psttm
Abs($close)
$amount
Sub(Mul(Constant(0.01),Sub($pctchg,Constant(-0.01))),Constant(-0.01))
$preclose
$high
$open
$pettm
$open
Sub($pcfncfttm,Max(Var(Greater(Add($isst,$volume),EMA($turn,20)),10),50))
Mean(Mul($isst,Constant(-5.0)),40)
$pctchg
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104100431/8192_steps
----------------------------------------
| pool/                   |            |
|    best_ic_ret          | 0.169      |
|    eval_cnt             | 28         |
|    significant          | 24         |
|    size                 | 28         |
| rollout/                |            |
|    ep_len_mean          | 16.5       |
|    ep_rew_mean          | -0.773     |
| test/                   |            |
|    ic                   | 0.0329     |
|    rank_ic              | 0.0533     |
| time/                   |            |
|    fps                  | 46         |
|    iterations           | 4          |
|    time_elapsed         | 176        |
|    total_timesteps      | 8192       |
| train/                  |            |
|    approx_kl            | 0.01866256 |
|    clip_fraction        | 0.325      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.39      |
|    explained_variance   | 8.34e-07   |
|    learning_rate        | 0.001      |
|    loss                 | -0.346     |
|    n_updates            | 30         |
|    policy_gradient_loss | -0.0227    |
|    value_loss           | 0.0315     |
----------------------------------------
$open
Add(Constant(0.01),Med($pbmrq,40))
$amount
$vwap
$high
Add($turn,Constant(5.0))
$isst
Mean(Mul(Mul(Add(Mul(Mad(Mul($close,EMA($amount,50)),40),Constant(-1.0)),Less(Constant(10.0),$preclose)),Constant(2.0)),$volume),30)
$close
$high
Log($open)
$low
$psttm
Add(Constant(-10.0),Min(EMA($pcfncfttm,50),10))
$isst
Mean($pettm,10)
Med($pettm,10)
WMA(Mean($preclose,30),20)
$vwap
Greater(Sum($pcfncfttm,40),$vwap)
Div($pcfncfttm,Mean($low,10))
Sub($close,Constant(-10.0))
$pcfncfttm
$high
$turn
Abs(Abs($turn))
$volume
Abs($turn)
$isst
$amount
$open
Div(Constant(30.0),$amount)
WMA(Sub(Sub($pcfncfttm,Sub(Div($pcfncfttm,Constant(5.0)),Mul(Constant(5.0),$open))),$psttm),40)
Abs($isst)
$pettm
$preclose
Mul(Std(Greater(Var(Greater($volume,Sub($volume,Constant(5.0))),40),Mul($turn,Mul($pettm,$low))),40),Constant(-1.0))
$low
$preclose
$psttm
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104100431/10240_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.179       |
|    eval_cnt             | 43          |
|    significant          | 34          |
|    size                 | 43          |
| rollout/                |             |
|    ep_len_mean          | 15.7        |
|    ep_rew_mean          | -0.709      |
| test/                   |             |
|    ic                   | 0.0325      |
|    rank_ic              | 0.0426      |
| time/                   |             |
|    fps                  | 41          |
|    iterations           | 5           |
|    time_elapsed         | 244         |
|    total_timesteps      | 10240       |
| train/                  |             |
|    approx_kl            | 0.016261991 |
|    clip_fraction        | 0.275       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.35       |
|    explained_variance   | 7.75e-07    |
|    learning_rate        | 0.001       |
|    loss                 | -0.333      |
|    n_updates            | 40          |
|    policy_gradient_loss | -0.0293     |
|    value_loss           | 0.0448      |
-----------------------------------------
$psttm
Add($pettm,Constant(0.5))
EMA(Min(Cov(Abs($amount),Med(Add($amount,$volume),40),10),40),20)
Mul($vwap,Sub(Mul(Constant(1.0),$pettm),$pettm))
Mul(Max($high,10),$amount)
Greater($close,$amount)
$preclose
$psttm
Less(Abs(Mul(Constant(-1.0),$psttm)),Corr(Abs(Var(Mul($close,Abs($volume)),40)),$pcfncfttm,20))
Mul($volume,Div($low,$turn))
$psttm
$low
Ref(Sub($isst,$low),30)
Greater(EMA($pctchg,50),Add(Greater(Div($pctchg,$pcfncfttm),Constant(-10.0)),$isst))
Log($vwap)
Abs(Sub($amount,Sub(Mul(Constant(-1.0),$close),Mean(Log($preclose),20))))
$preclose
EMA($turn,30)
Abs($pctchg)
$pettm
Mad($volume,30)
$high
Var(Abs($high),40)
Greater($psttm,Less($preclose,$amount))
Mul(Mean($pcfncfttm,20),Constant(-10.0))
$close
Mean(Div($pctchg,Mean($close,50)),10)
Mul(Mul($turn,Constant(-1.0)),Constant(0.5))
$turn
$pctchg
Sub($open,$high)
Add(Constant(5.0),Div($pettm,$isst))
$pctchg
Sum(Var(Abs(WMA(Add(Constant(-1.0),WMA(Corr($amount,$vwap,40),10)),10)),40),50)
$pcfncfttm
Sub(Constant(-1.0),$pcfncfttm)
$close
Abs($close)
$volume
Mean($pettm,50)
$pctchg
Sub(EMA(Std($turn,30),50),$close)
Add(Div(Constant(0.5),$turn),Std($pettm,10))
Var($psttm,10)
$vwap
Div(Mul(Mul($pettm,$low),Ref(Abs($preclose),40)),$volume)
Min(Abs($turn),40)
Std(Add(Constant(10.0),$volume),10)
$low
Add(Constant(1.0),$preclose)
$vwap
Sub(Constant(2.0),$preclose)
EMA(Std(Div($isst,$pcfncfttm),30),50)
$close
Mul(Min($pctchg,50),Sub(Mul($volume,$close),$amount))
$pettm
Delta(Greater(Mul(Sub(Constant(-2.0),$close),$isst),Mul(Std($turn,30),Div(Constant(5.0),Var($turn,10)))),40)
EMA(Mul($close,Constant(30.0)),30)
Log($pettm)
$high
$vwap
$amount
Abs(Abs($close))
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104100431/12288_steps
----------------------------------------
| pool/                   |            |
|    best_ic_ret          | 0.186      |
|    eval_cnt             | 69         |
|    significant          | 51         |
|    size                 | 69         |
| rollout/                |            |
|    ep_len_mean          | 12.7       |
|    ep_rew_mean          | -0.485     |
| test/                   |            |
|    ic                   | 0.029      |
|    rank_ic              | 0.0395     |
| time/                   |            |
|    fps                  | 33         |
|    iterations           | 6          |
|    time_elapsed         | 369        |
|    total_timesteps      | 12288      |
| train/                  |            |
|    approx_kl            | 0.01649338 |
|    clip_fraction        | 0.313      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.32      |
|    explained_variance   | 1.61e-06   |
|    learning_rate        | 0.001      |
|    loss                 | -0.338     |
|    n_updates            | 50         |
|    policy_gradient_loss | -0.03      |
|    value_loss           | 0.0656     |
----------------------------------------
Mul(Mul(Constant(-10.0),Mean($pcfncfttm,10)),Sum($pettm,50))
Var(Abs(Abs(Greater($pctchg,Cov($psttm,Mean(Greater(Var($close,50),Mean($close,50)),50),10)))),40)
Div(Div(Abs(Abs(Div(Constant(-30.0),$pctchg))),$close),$preclose)
Corr(Var(Sub(Add($pettm,$preclose),Constant(-10.0)),40),$volume,10)
Sub($vwap,Add($close,Constant(-0.5)))
Sub($preclose,$psttm)
Min(Corr($psttm,$isst,40),50)
Div(Constant(1.0),$turn)
Sub(Div($vwap,Constant(0.5)),$low)
Mean(Div(Less(Add($pctchg,Add(Div(Constant(2.0),$volume),Abs($low))),Div(Log(WMA($pcfncfttm,50)),Constant(-30.0))),Constant(-30.0)),20)
Less($vwap,$pctchg)
Std(Mul(Constant(0.01),Div(Greater(Add($psttm,$preclose),$close),Constant(-1.0))),10)
$isst
Mul(Greater(Greater($amount,Mean(Sub(Add($pettm,Constant(5.0)),$amount),20)),Constant(-1.0)),Abs($open))
Add(Constant(30.0),Var($preclose,30))
$close
Less(Abs(Abs(Div(Max($volume,10),Sub($turn,Greater(Div($preclose,$psttm),Constant(-1.0)))))),$pettm)
Mul(Constant(-0.5),Div($turn,$pctchg))
Mul(Sub(Constant(2.0),$high),$volume)
Sub($high,Mul($pctchg,Mul(Constant(-0.5),Abs(Std($psttm,20)))))
Mul(Constant(10.0),$amount)
Log($preclose)
WMA(Greater($volume,$low),30)
Sum(Mean($close,30),10)
Sub(Constant(-2.0),Var(Mul(Sub(Add($open,Var($isst,40)),Constant(-30.0)),$amount),20))
Div(Mul(Abs($amount),$preclose),Mul(Less(Less(Constant(2.0),Var($close,20)),$psttm),$close))
$pbmrq
$close
Sub(Constant(30.0),Less($pettm,Sub(Sub(Add(Div($preclose,Constant(0.01)),$volume),Constant(1.0)),Greater($open,Sub($turn,Constant(0.01))))))
Sub(Constant(30.0),Delta($psttm,40))
Ref($volume,20)
Corr(Ref(Mul(Add($pettm,$pbmrq),Constant(10.0)),10),Var($pettm,10),10)
$pcfncfttm
$preclose
Add(Cov(Div(Constant(-10.0),$low),$high,30),$amount)
Var(Sub($turn,Constant(-1.0)),30)
$pcfncfttm
$pctchg
Min(Ref($high,50),10)
$open
Min(Mad($preclose,20),20)
$volume
$turn
$turn
$volume
$volume
$close
Mean(Sub($amount,Constant(-0.01)),30)
$high
$preclose
Greater(Mul(Constant(-2.0),$volume),Mean($pettm,50))
$volume
$open
$turn
Abs(Delta(Abs(WMA($pctchg,40)),40))
$psttm
Sub(EMA(Mul(Cov(Greater($preclose,Min($amount,20)),Var($close,50),30),Less(Constant(-30.0),$open)),30),$volume)
$vwap
Sub(Abs(Add(Constant(-10.0),Sub($low,$vwap))),Cov($pctchg,Greater($low,$vwap),30))
$vwap
Greater(Abs(Var(Add(Constant(0.01),$pctchg),50)),Mul(Greater($close,Greater($preclose,Constant(10.0))),Med($vwap,40)))
$preclose
Div(Sub($amount,Mad(Mul($preclose,Add($open,Less($turn,Var(Mul(Constant(1.0),$low),10)))),10)),Constant(5.0))
$isst
Sum(Abs(Add(Constant(30.0),Sub(Div(Ref(Corr($psttm,$amount,20),30),Constant(-5.0)),Constant(1.0)))),10)
$close
Var($open,50)
Log(Min(Add(Sub($close,Div($isst,$preclose)),Mul(Greater(Abs($close),$preclose),Constant(-2.0))),40))
$amount
Min(Sub($volume,Constant(1.0)),20)
Var(Div(Add(Mul(Min($preclose,50),$close),Less($pettm,$pcfncfttm)),Constant(1.0)),20)
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104100431/14336_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.197       |
|    eval_cnt             | 105         |
|    significant          | 76          |
|    size                 | 105         |
| rollout/                |             |
|    ep_len_mean          | 14          |
|    ep_rew_mean          | -0.547      |
| test/                   |             |
|    ic                   | 0.0401      |
|    rank_ic              | 0.0567      |
| time/                   |             |
|    fps                  | 24          |
|    iterations           | 7           |
|    time_elapsed         | 575         |
|    total_timesteps      | 14336       |
| train/                  |             |
|    approx_kl            | 0.014085371 |
|    clip_fraction        | 0.244       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.26       |
|    explained_variance   | 3.58e-07    |
|    learning_rate        | 0.001       |
|    loss                 | -0.303      |
|    n_updates            | 60          |
|    policy_gradient_loss | -0.0328     |
|    value_loss           | 0.114       |
-----------------------------------------
Sub(Add(Constant(0.5),EMA(Ref(Min(Sub($pettm,$isst),10),10),50)),Greater(Greater(Constant(1.0),Sub($amount,Constant(-5.0))),$open))
$low
Add(Greater(Med(Sub(Div($pcfncfttm,Greater(Constant(-1.0),Max(Std($close,20),20))),Constant(-1.0)),50),Mul($pctchg,$preclose)),Constant(-0.01))
Add(Constant(-2.0),$isst)
$pctchg
Add(Mean($isst,40),$pettm)
Add(Constant(1.0),$preclose)
Var(Min($close,40),10)
EMA(Mul(Mul(Sub(Greater(Constant(0.01),$psttm),$psttm),Less($amount,$turn)),Sub($close,Constant(-0.01))),30)
Sub($pettm,Add($close,Std(Add(Greater(Constant(-1.0),$turn),Add($high,$low)),10)))
$volume
Greater($open,Div($vwap,Add(Greater($psttm,$amount),Constant(-30.0))))
Mul(Log($close),$volume)
$turn
Min(Min(Sub(Constant(-0.5),$pbmrq),10),20)
$turn
Greater($amount,Sub(Sum($close,20),Constant(2.0)))
$pettm
$turn
$preclose
$pbmrq
Greater(Div($vwap,Constant(-5.0)),$high)
$preclose
$isst
Sub(Constant(0.5),$close)
Div(Mul($low,$close),$high)
Sum(Greater(Abs(Sub(Greater(Constant(1.0),$pcfncfttm),Sub(Delta($turn,50),Constant(0.01)))),$pettm),40)
Add(Min($turn,10),$pcfncfttm)
Add(Constant(-0.5),Sub($close,Mul($isst,$pctchg)))
Var(Ref(Sub(Add(Constant(-2.0),$open),Corr($pctchg,$low,10)),20),30)
Std(Mul(Constant(-0.01),$amount),50)
$volume
Sum(Abs(Var($pettm,10)),50)
Min(Mul(Constant(-2.0),$preclose),20)
$volume
$pctchg
$turn
Ref(Div(Constant(-30.0),Sub($amount,Constant(-0.5))),10)
Mean(Mul($pettm,Constant(2.0)),20)
Less(EMA(Div($low,Ref(Abs(Less($amount,$isst)),20)),50),Div(Constant(-30.0),$preclose))
Mul($turn,$close)
$pbmrq
$amount
Sub(Add(Mul(Add(Constant(0.01),Sub($close,$pettm)),Div(Mean($amount,30),Constant(5.0))),$amount),Div($pcfncfttm,Constant(1.0)))
$isst
$turn
$amount
Abs($volume)
Sub($low,Log(Sub($isst,Div(Div($preclose,Var(Mean(Abs(Div(Constant(30.0),$pbmrq)),20),20)),Constant(1.0)))))
$turn
Var($vwap,10)
Var($low,10)
Mul(Constant(-0.5),Sum(Log($high),30))
Var($pettm,10)
Add(Constant(-0.01),$isst)
Cov(Std(Div($vwap,Constant(-10.0)),20),Mul(Med($pcfncfttm,10),$turn),40)
$vwap
Mul(Constant(5.0),Add($preclose,Add($turn,Constant(-10.0))))
Add(Constant(-1.0),Mul($preclose,Constant(2.0)))
Log(Div(Constant(0.5),Mul($preclose,Sub(Cov($pettm,$pettm,40),$low))))
Add(Sub(Div(Add($volume,Constant(30.0)),Div(Constant(0.01),$psttm)),$isst),Add(Greater(Constant(-0.5),$pctchg),$pcfncfttm))
$preclose
Mean(Sub(Sub(Greater(Greater(Constant(2.0),$pettm),$turn),$volume),$low),10)
$open
Sub(Var(Min($turn,50),20),$pctchg)
$isst
Abs(Div(Div(Constant(-0.01),$amount),Constant(-0.01)))
Sub(Less(Less(Constant(-0.01),$close),WMA(Greater($volume,$pcfncfttm),10)),$turn)
Sub($isst,Constant(10.0))
Greater($preclose,Mean($psttm,40))
Abs($amount)
Less(Mul($isst,Constant(10.0)),$psttm)
$pcfncfttm
$psttm
Mul(Constant(-0.01),Var(Ref(Mean($pettm,10),40),50))
Less(Div(Constant(-5.0),$preclose),$volume)
Var($vwap,50)
$low
$high
$high
Add($high,Mul($amount,Var($close,30)))
Less(Mad(Div(Abs($amount),Constant(2.0)),10),$vwap)
Mul($close,Var($psttm,10))
Mul(Ref(Div(Mad(Med(Sub(Constant(0.01),Add(Mean(Mean($volume,30),50),$preclose)),20),20),$psttm),30),$vwap)
Mul(Var(Sub(Mul($isst,Sub($turn,Constant(-0.01))),Constant(0.5)),10),Mul($preclose,Sub(Greater($pettm,Constant(30.0)),$pbmrq)))
$pettm
$psttm
Ref(Sub($pctchg,$pettm),30)
Add(Constant(-5.0),Div(Var(Ref($pctchg,40),40),$amount))
$pctchg
$turn
Div(Sub(Mul(Abs(Var(EMA(Log($pcfncfttm),20),20)),Add(Sub($turn,Constant(-5.0)),Constant(10.0))),Constant(-10.0)),$pcfncfttm)
Mul($psttm,Sub(Std(WMA($volume,20),40),$amount))
Abs(Abs($preclose))
$psttm
Greater(Log(Mul(Div(Constant(-0.5),Add(Abs($volume),Sub(Sub($pettm,$preclose),Constant(30.0)))),$pbmrq)),Div($vwap,Constant(-0.01)))
Add(Constant(5.0),Var(Greater($vwap,$turn),40))
$high
Greater($amount,Var(Sub($close,$close),10))
Greater(Sub($amount,Add(Constant(-2.0),$vwap)),$high)
$isst
$preclose
Sub($pbmrq,Less($pettm,$high))
$pcfncfttm
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104100431/16384_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.207       |
|    eval_cnt             | 159         |
|    significant          | 109         |
|    size                 | 159         |
| rollout/                |             |
|    ep_len_mean          | 12.5        |
|    ep_rew_mean          | -0.389      |
| test/                   |             |
|    ic                   | 0.0387      |
|    rank_ic              | 0.0546      |
| time/                   |             |
|    fps                  | 16          |
|    iterations           | 8           |
|    time_elapsed         | 990         |
|    total_timesteps      | 16384       |
| train/                  |             |
|    approx_kl            | 0.014628162 |
|    clip_fraction        | 0.249       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.19       |
|    explained_variance   | 2.98e-07    |
|    learning_rate        | 0.001       |
|    loss                 | -0.284      |
|    n_updates            | 70          |
|    policy_gradient_loss | -0.0325     |
|    value_loss           | 0.144       |
-----------------------------------------
Sub(Mul(Constant(-30.0),$pctchg),Constant(-0.01))
$high
$amount
Mul(Med(Mul(Constant(1.0),Greater($preclose,Mul(Constant(30.0),Mul($pettm,Mul(Med($turn,40),Mul($turn,$low)))))),40),Constant(0.01))
$psttm
Mul(Greater(Greater(Constant(-10.0),Add($pbmrq,Sub(Constant(5.0),$high))),$high),$psttm)
Add(Std(Add(Var($turn,20),Constant(0.5)),50),Div(Med(Greater($turn,$close),20),$vwap))
Sub(Div($low,$turn),$close)
Abs(Div(Less($vwap,Constant(-0.01)),$pcfncfttm))
Var($close,40)
Sum(Mul(Constant(0.01),Cov($vwap,$low,10)),10)
$pettm
Mul(Mul(Add($open,Max(Add($turn,Med(Mad($pctchg,50),50)),40)),$psttm),Constant(-5.0))
Sub(Constant(-0.01),Var($open,20))
$psttm
Mad(Mad(Mul(Sub(Greater(Constant(2.0),$volume),$preclose),Abs(Mean(Mad($close,10),10))),10),10)
$isst
$pctchg
Sub(Constant(-0.5),$volume)
Sub(Mul($volume,$pettm),$high)
Max($vwap,10)
Mean(Sub($amount,Sub(WMA($amount,10),$isst)),20)
$isst
$open
Greater($high,Abs($pettm))
Var($pbmrq,40)
$volume
$pctchg
$close
Std(Sub(Sub(Constant(-10.0),Var(Corr(Min(Sub($psttm,Constant(0.01)),10),Sum($pcfncfttm,40),40),10)),$high),10)
Std(Abs($volume),10)
$isst
Cov(Delta(Mul(Constant(10.0),$vwap),20),$preclose,20)
Log($preclose)
Add(Mul($volume,Constant(30.0)),Constant(-10.0))
Std($turn,10)
Log(Var(Min($pbmrq,50),40))
Greater(Sub(Constant(-0.5),$turn),Var(Var($preclose,20),40))
Less($amount,Mul($volume,Constant(0.01)))
$vwap
$pctchg
$pbmrq
Cov(Log(Delta($preclose,20)),$low,20)
WMA(Sub(Constant(-0.5),$turn),50)
Sub($close,Div(Sub($volume,Constant(1.0)),$pettm))
Div(Sub(Mul(Constant(-30.0),Add($pbmrq,$high)),$volume),Mul(Greater($close,Greater(Med($preclose,10),$amount)),Add($pettm,$close)))
Abs(Mul(Add($pctchg,$low),Constant(1.0)))
Sub(Constant(0.5),$turn)
Mul(Constant(-1.0),Mul(Sub(Log($open),Ref($close,10)),$amount))
$turn
$turn
$amount
$low
Add(Greater(Less(Constant(-1.0),Add(Greater($pettm,Constant(-0.01)),$pctchg)),Less($turn,$pcfncfttm)),$amount)
Div(Div(Abs(Log($pbmrq)),Div(Abs($isst),$turn)),Cov($amount,$volume,40))
Mul($pbmrq,Corr(Greater(Div($pctchg,Constant(10.0)),$pbmrq),Mean(Log($pettm),40),20))
Add($pctchg,Sub(Div(EMA(Sub(Mul(Constant(5.0),$pbmrq),$pctchg),20),Constant(5.0)),Mul(Mul($turn,$isst),Constant(5.0))))
Var($pctchg,30)
$pctchg
$pettm
Abs($pcfncfttm)
Abs(EMA(Sub(Constant(30.0),$high),40))
Sub(Constant(-5.0),$pctchg)
Delta($isst,50)
Div($close,Constant(-2.0))
Greater($psttm,Sub(Log(Min($pettm,30)),Constant(30.0)))
Std(Add(Mul(Constant(-0.5),Std($preclose,10)),$low),50)
Std(Sub(Constant(-0.01),$close),30)
$turn
Add(Mul(Div(Constant(2.0),$isst),Constant(-10.0)),Greater(Sub($pettm,EMA($pettm,20)),$pctchg))
$pbmrq
WMA($psttm,30)
Log(Mean(Add(Constant(-0.01),$vwap),40))
$volume
$pcfncfttm
Div(Constant(-0.5),Abs(Add(Greater($psttm,WMA(Mul($volume,$low),10)),Constant(0.01))))
$psttm
Sub(Constant(5.0),$preclose)
$open
$isst
Div(Constant(-0.5),Mul(Log($amount),Constant(-10.0)))
Corr(Var($psttm,40),$turn,40)
Div(Abs(Add($turn,Sub(Constant(-0.5),Mean($volume,30)))),Var($vwap,50))
Mul(WMA($pettm,40),Mul($volume,Constant(30.0)))
$low
Min(Add(Greater(Constant(2.0),$pcfncfttm),WMA(Greater(Med($vwap,10),$amount),20)),40)
Less($open,$pbmrq)
Sum($volume,10)
$volume
Corr(Mul(Add(Var(Mul(Constant(-2.0),Add(Add($volume,$close),Constant(0.01))),10),Constant(-2.0)),Greater(Constant(30.0),$close)),$psttm,30)
Ref($preclose,20)
Sub(Constant(1.0),$vwap)
$pctchg
Var($turn,10)
$close
$high
Mul(WMA(Sub(Var($volume,10),Ref($pettm,40)),50),Sub(Add($amount,Abs($open)),Constant(0.5)))
Log(Mul(Mul(Constant(2.0),$volume),$psttm))
Add($low,Constant(1.0))
$high
Div(Greater(Abs(Add($open,$close)),$volume),Constant(0.01))
$vwap
$high
Less($volume,Mean($pettm,10))
Greater(WMA($pbmrq,50),$vwap)
Sub(Div(Constant(-1.0),$low),Add(Add(Ref($turn,40),Constant(-30.0)),$pettm))
Mul(Sub(Sub(Add(Greater(Constant(-5.0),$psttm),$low),$turn),Add(Constant(1.0),$turn)),$isst)
Abs(Div(Mul(Constant(-2.0),Sub(Sum($pbmrq,10),$amount)),Constant(-0.01)))
Less(Std($preclose,10),Div($amount,Constant(-5.0)))
Log(Abs(Sub(Mul($pbmrq,Mul(Greater(Div(Mean(Abs(Div(Constant(5.0),$pctchg)),10),Abs($preclose)),$pbmrq),Constant(-5.0))),$pcfncfttm)))
Sub(Constant(1.0),$amount)
Std($pcfncfttm,20)
$close
$pcfncfttm
Mul(Constant(-30.0),Var($low,20))
Sum(Greater(Mul(Sub(Constant(-2.0),$close),Constant(30.0)),Mul(Mul($low,$pbmrq),Constant(0.5))),20)
Var(Mul(EMA($pbmrq,10),$preclose),10)
$close
Add(Corr(Mul(Constant(0.01),Abs(Mul($pctchg,$high))),Add(Greater(EMA($open,10),$pcfncfttm),Sub($pcfncfttm,$high)),50),$turn)
$close
$volume
Sub($high,Less(Div($pcfncfttm,Med(Mul($amount,$volume),40)),Constant(-5.0)))
Abs($pctchg)
$open
Mul(Constant(-1.0),Add(Sub(Mul(Var($pctchg,20),Less(Constant(-1.0),Add(Mul($close,$low),Greater($pcfncfttm,Constant(5.0))))),Constant(-0.01)),$psttm))
Sum(Sub(Constant(-2.0),$pettm),10)
Delta(Std(Add(Greater(Log(Abs(Var($low,10))),Constant(-2.0)),Min(Sub($preclose,$volume),40)),10),10)
$isst
$preclose
Div(Constant(-5.0),$volume)
$turn
$high
Sub($low,Greater($low,Cov($pbmrq,$vwap,40)))
Min(EMA($preclose,10),10)
Mul(Constant(30.0),$low)
$psttm
Mul($amount,Constant(-1.0))
$pettm
$close
$pcfncfttm
Max($low,10)
Mul(Mul(Constant(5.0),Mul(Greater($amount,Constant(0.01)),$psttm)),$preclose)
Mad(Min(Sub(Constant(-1.0),Var($turn,20)),40),10)
Med(Sub($vwap,Constant(0.5)),20)
Sub(Constant(-5.0),$volume)
$amount
Log($volume)
Add(Sub(Constant(-10.0),Std($turn,20)),Var(Div(Abs($low),Std($volume,10)),10))
Sum($preclose,10)
Log(Var(Mul($close,Constant(5.0)),40))
$pbmrq
Mul(Var(Var($isst,10),10),Constant(-1.0))
$pbmrq
Delta(Greater(Mul($volume,$amount),$pcfncfttm),40)
Sub(Var(Add(EMA($psttm,10),Sub($pctchg,Constant(-10.0))),50),Add($open,Abs(Mean($pbmrq,40))))
Mul($low,$open)
Sub(Constant(-0.01),$pettm)
WMA($vwap,50)
$pcfncfttm
Mean(Div(Constant(-30.0),WMA(Div($volume,Less(Var($low,20),Constant(0.5))),30)),20)
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104100431/18432_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.221       |
|    eval_cnt             | 243         |
|    significant          | 139         |
|    size                 | 200         |
| rollout/                |             |
|    ep_len_mean          | 10.4        |
|    ep_rew_mean          | -0.213      |
| test/                   |             |
|    ic                   | 0.0459      |
|    rank_ic              | 0.0587      |
| time/                   |             |
|    fps                  | 9           |
|    iterations           | 9           |
|    time_elapsed         | 1951        |
|    total_timesteps      | 18432       |
| train/                  |             |
|    approx_kl            | 0.015234752 |
|    clip_fraction        | 0.261       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.09       |
|    explained_variance   | 4.17e-07    |
|    learning_rate        | 0.001       |
|    loss                 | -0.263      |
|    n_updates            | 80          |
|    policy_gradient_loss | -0.0334     |
|    value_loss           | 0.175       |
-----------------------------------------
Add(Mul(Add(Greater(Constant(-0.01),$volume),Add($pctchg,Add($preclose,Sub(Mean($pctchg,20),Var($open,50))))),$amount),$pettm)
Sub($close,Abs($close))
Mean($psttm,20)
Sub(Constant(5.0),$isst)
Sub(Constant(30.0),Div(Mul($low,$psttm),Delta($isst,40)))
$pettm
Sub(Mul(Constant(-0.01),Mul($pettm,$preclose)),Sub($pettm,$preclose))
$pctchg
Log(Div(Constant(0.01),$preclose))
Var(Add(Sub($volume,$turn),Log($turn)),10)
$pcfncfttm
Log(Add($low,Mul(Constant(10.0),$volume)))
$close
Greater(Sub(Constant(-1.0),$pctchg),$vwap)
Div(Mul($pcfncfttm,$low),Constant(0.5))
Div(Constant(5.0),Add(Mul(Std($pettm,20),Constant(-0.5)),Constant(30.0)))
EMA(Sub($volume,Sub(Mul(Mul($pcfncfttm,Mean($volume,40)),Constant(-0.01)),$pctchg)),50)
$preclose
$amount
$psttm
Mean($high,10)
Sub(Log($close),Div(Constant(1.0),$pettm))
Ref(Mean(Add($vwap,Add(Abs(Sum($vwap,30)),Corr(Sub(Sub(Constant(5.0),$close),Constant(30.0)),$amount,40))),20),30)
Abs(Div(WMA(Mul(Constant(-2.0),Greater(Log(Std($pettm,10)),$psttm)),10),Mul(Constant(-30.0),Mean($pctchg,20))))
Sub(Constant(-5.0),Log(Div(Sub($pettm,$close),Constant(-0.01))))
Div(Div(Var(Div($preclose,EMA($pctchg,40)),30),Constant(-5.0)),Constant(5.0))
Sub(Constant(5.0),Sub($vwap,Constant(2.0)))
$pcfncfttm
Div($pcfncfttm,$volume)
Sub(Constant(-0.01),$preclose)
$vwap
$open
$open
Sub(Constant(30.0),$turn)
Div($pettm,$amount)
$pctchg
Var(Add(Constant(-0.01),$vwap),10)
Sum(Sub(Constant(10.0),Div($volume,Constant(1.0))),40)
Med(Sub($open,Add($turn,Min(Std($amount,20),20))),40)
$vwap
Div($amount,Add(Mul($amount,Constant(0.5)),$pcfncfttm))
Sub(Mul(Constant(-0.01),Div(Add($preclose,Var(Mul($pbmrq,$volume),20)),Constant(-2.0))),$high)
$close
$psttm
Med($high,10)
$pbmrq
$pettm
Med($close,50)
Mul(Less(Greater(Constant(-10.0),$pctchg),$amount),Sub(Sub(Sub(Mul($amount,$amount),$turn),Constant(-0.01)),Constant(0.01)))
Div(Constant(-30.0),$pettm)
Div(Mul(Sub(Less(Greater(Constant(0.5),$pbmrq),$pctchg),$preclose),Constant(-1.0)),Constant(-0.01))
$pbmrq
Mean(Div(Constant(-10.0),$turn),10)
$close
Greater($amount,Sub(Constant(0.5),Med(Mean(Add(Add($low,Constant(30.0)),$pbmrq),20),30)))
Sub(Constant(-0.5),Var(Sub($psttm,Greater(Div(Sub($pctchg,Mul(Mul(Constant(-2.0),$pbmrq),$volume)),Sub($pettm,$amount)),Constant(0.5))),40))
$isst
$psttm
$turn
Add(Constant(-5.0),Add($pettm,Sum($pettm,40)))
Add(Constant(30.0),$preclose)
$volume
$volume
Mul($volume,Sub(Add($psttm,Constant(10.0)),Sub($vwap,Greater(Less(Constant(-0.01),$turn),$low))))
$close
$amount
Mul(Constant(30.0),$volume)
Add(Constant(5.0),$pctchg)
$psttm
$amount
Add(Less(Constant(0.01),$pcfncfttm),$pctchg)
$close
$preclose
$volume
$turn
$vwap
Sub(Less($psttm,$close),Constant(-0.01))
Div(Constant(0.01),$close)
$open
$isst
Add(Add(Greater($close,Sub(Constant(-2.0),Cov(Mul($high,Constant(-30.0)),$volume,50))),Constant(1.0)),Constant(-10.0))
Less(Sub(Greater(Mul(Constant(-1.0),Div($vwap,Constant(-5.0))),$volume),Less(Var(Sub(Constant(-0.01),$pctchg),50),Div($volume,$open))),$vwap)
$vwap
$volume
$isst
$isst
Add(Greater(Constant(30.0),$psttm),$vwap)
$vwap
Add(Constant(-30.0),Sub($high,Var($preclose,50)))
Log(Div(Abs(Sub(Div($amount,Constant(-0.01)),$turn)),Constant(5.0)))
Mean(Min(Mean(Add(Constant(10.0),Div($pcfncfttm,Less(Add(Add(Add($close,Constant(-0.01)),$turn),$pbmrq),$isst))),50),20),10)
$amount
Std(WMA(Max($high,20),10),40)
Mul($preclose,Std($pctchg,50))
Sub(Constant(30.0),Var($turn,20))
$pbmrq
Max(Mul(Div($amount,$high),Sub(Abs($high),Constant(30.0))),30)
Abs($volume)
$close
Greater(Var($pcfncfttm,20),Min($volume,10))
Min(Sub(Constant(-1.0),Add(Abs(Greater($open,$pbmrq)),Constant(-1.0))),40)
Div($open,Greater($pettm,Std(Abs(Mul(Constant(30.0),$open)),10)))
$pctchg
$amount
Sub(Constant(5.0),Abs(Var($turn,10)))
$volume
$pctchg
Sum(Sub(Sub($low,$low),$volume),20)
WMA(Add(Constant(5.0),$vwap),10)
Mad(Sub(Mul(Constant(0.01),Div($pctchg,$psttm)),$amount),40)
Sub(Constant(10.0),Mul(Div(Ref($amount,50),$volume),WMA(Div(Sub(Abs(Div($isst,Constant(0.01))),Constant(30.0)),Constant(-30.0)),20)))
Sub($isst,Sub($pettm,Sub(Mul(Log($preclose),Mul(Mean(Std($close,20),40),$pctchg)),Mul($low,$isst))))
Add(Med(Sub(Constant(1.0),Corr($turn,$low,10)),30),Constant(-1.0))
Div($pcfncfttm,Constant(-0.01))
Min(Sub(Log($volume),$high),40)
Sub(Greater(Constant(0.5),Std($vwap,10)),$vwap)
Mul(Add(Mul(Constant(-2.0),Abs(Abs(Abs($volume)))),Greater($isst,Constant(-0.5))),$turn)
$isst
$pctchg
$high
Std(Abs($turn),10)
$vwap
Sub(Constant(10.0),Mul($isst,Sub($amount,Constant(-0.5))))
$turn
Mul(Constant(0.01),Mul($pcfncfttm,$amount))
Less(Ref(Add(Constant(-0.01),$volume),10),Log(Var($turn,40)))
Add(Div(Constant(-0.5),$turn),$close)
Mul($pctchg,Constant(-0.5))
Log($vwap)
Mul(Greater(Log(Sub(Constant(1.0),$isst)),$preclose),Constant(30.0))
$isst
Div(Constant(0.5),Abs($pcfncfttm))
WMA($volume,20)
Add(Sub($low,Div($vwap,Greater(Constant(5.0),Add($volume,Greater(Constant(2.0),Var(Div($turn,Constant(-30.0)),20)))))),Sub($pbmrq,$volume))
Abs(Mean($pctchg,20))
Sub($vwap,$turn)
Add(Med(Sub($pctchg,Constant(0.01)),10),Constant(-30.0))
Add(Constant(-30.0),$volume)
$high
$pettm
Mul($preclose,Add($pcfncfttm,Constant(10.0)))
Greater(Log($turn),$low)
$isst
$open
Div($amount,Div($volume,Cov($volume,Div(Constant(-10.0),$vwap),10)))
Sub($vwap,Abs(Sub($volume,Constant(5.0))))
Delta(Std(Mul(Add(Constant(-0.01),Sum($vwap,10)),Var($close,10)),50),50)
$low
$isst
Mul(Constant(-1.0),$pbmrq)
$amount
Greater(WMA($low,40),$pettm)
Sub($isst,Add($turn,Mul(Sub($preclose,$pettm),Constant(-0.01))))
Sub(Abs($volume),Constant(5.0))
Var($pctchg,10)
$high
Mul(Constant(10.0),Div(Greater($vwap,$vwap),Mul(Greater(Mul($open,$close),$amount),Constant(-0.5))))
$amount
Add(Greater(Constant(0.5),$amount),Var($close,20))
Cov(Mean(Sub($pcfncfttm,Constant(-5.0)),10),Mul(Constant(-1.0),Greater($pbmrq,Max($close,50))),20)
Mul(Constant(-0.01),$volume)
Sub(Mul($low,$amount),$open)
$isst
$high
Mul(Less(Constant(-5.0),Mul(Mul($preclose,Constant(1.0)),Constant(2.0))),Sum(Div(Mul($low,Constant(2.0)),Constant(-5.0)),10))
WMA($open,10)
Div(Mul(Greater($volume,$psttm),Constant(5.0)),Constant(-0.01))
$isst
Sub(Mean($amount,50),$turn)
Ref($pcfncfttm,10)
$low
Sub($pettm,$vwap)
$pcfncfttm
Abs(Greater($vwap,$close))
$volume
$isst
Sub(Mul($pettm,Mul(Div(Sub($vwap,WMA($preclose,40)),Constant(-0.5)),Sub($psttm,$volume))),Div(Var($preclose,10),$vwap))
Sub($pcfncfttm,$vwap)
$volume
Sub(Mul($turn,Div(Constant(0.01),Min(Div($isst,$pcfncfttm),10))),Greater($pcfncfttm,$open))
Max(Sub(Greater(Constant(10.0),EMA($vwap,10)),$pbmrq),50)
Mul(Constant(-2.0),$volume)
Mul($low,Constant(-2.0))
Var($pctchg,10)
$amount
$pctchg
Div(Sub(Constant(30.0),Div($pcfncfttm,Constant(2.0))),Greater(Div(Add(Constant(-0.5),Mean($preclose,30)),Greater($amount,Constant(0.01))),$low))
Ref($pctchg,30)
Max(Sub(Constant(0.01),$psttm),10)
Var(Add(Sub(Constant(1.0),$pctchg),$turn),40)
$turn
Add($turn,$low)
Mean(Mad(Sub($pbmrq,Less($low,Constant(2.0))),20),10)
$pctchg
Mul($preclose,Mul(Greater($isst,Constant(-1.0)),Med($turn,40)))
$preclose
Add(Max(Sub(Constant(-1.0),$close),40),Sub(Mad(Abs($open),10),Less($high,Cov(Mul($pbmrq,$preclose),$preclose,50))))
Add($preclose,$amount)
$preclose
Sub($low,Div($turn,Ref($close,20)))
Med($pettm,10)
$close
$isst
$pettm
Mul(Constant(-30.0),Sub($volume,Sub($turn,Sub($low,$high))))
Log(Add(Greater($volume,Constant(-0.01)),$volume))
$pcfncfttm
Min(Greater($open,$pcfncfttm),10)
Var(Log(Mul(Constant(-5.0),Mul($pettm,$isst))),10)
Mul(Constant(1.0),Abs(Log($vwap)))
Mul($pettm,Sub($psttm,Constant(5.0)))
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104100431/20480_steps
------------------------------------------
| pool/                   |              |
|    best_ic_ret          | 0.232        |
|    eval_cnt             | 352          |
|    significant          | 143          |
|    size                 | 200          |
| rollout/                |              |
|    ep_len_mean          | 7.85         |
|    ep_rew_mean          | -0.0341      |
| test/                   |              |
|    ic                   | 0.0535       |
|    rank_ic              | 0.0665       |
| time/                   |              |
|    fps                  | 6            |
|    iterations           | 10           |
|    time_elapsed         | 3164         |
|    total_timesteps      | 20480        |
| train/                  |              |
|    approx_kl            | 0.0142850075 |
|    clip_fraction        | 0.235        |
|    clip_range           | 0.2          |
|    entropy_loss         | -2.95        |
|    explained_variance   | 2.09e-06     |
|    learning_rate        | 0.001        |
|    loss                 | -0.24        |
|    n_updates            | 90           |
|    policy_gradient_loss | -0.0347      |
|    value_loss           | 0.197        |
------------------------------------------
Mul($pcfncfttm,$isst)
Sub(Constant(-0.5),Less($amount,$preclose))
Mul(Med(Var(Sub(Sum(Add(Constant(10.0),$pettm),50),Div(Constant(0.01),$vwap)),50),30),Greater($vwap,Sum($open,40)))
$pcfncfttm
$amount
$close
Sub(Greater(Constant(1.0),$pettm),$pcfncfttm)
$pcfncfttm
$pbmrq
Mul(Mul(Sub(Less(Less(Constant(-1.0),$pcfncfttm),$volume),Sub(Sub($close,Constant(-1.0)),WMA($pcfncfttm,30))),Constant(-2.0)),Constant(-30.0))
Greater(Sub(Sub($low,Mul($turn,$preclose)),$turn),Add($volume,$low))
Add($high,Greater($pbmrq,Sub($close,Min($vwap,20))))
Var(Less($pctchg,Var(Mul(Sub($turn,$high),Constant(-1.0)),40)),10)
$pcfncfttm
Min($volume,30)
$isst
Sub(Constant(5.0),$psttm)
Add(Constant(-0.01),Var($vwap,10))
Mul(Constant(-1.0),$psttm)
$turn
Max($vwap,10)
Sub(Sub(Constant(5.0),Abs(Sub(Sub(Cov($pctchg,$vwap,10),Constant(-2.0)),$close))),Mul($preclose,Constant(-10.0)))
Mean(Greater($close,$vwap),10)
Add(Constant(0.01),$preclose)
Mul(Sub($volume,EMA($preclose,10)),Constant(30.0))
$psttm
Abs($amount)
Max(Mul(Add($vwap,Sum(Std(Sub($isst,Constant(5.0)),40),20)),Constant(30.0)),40)
$psttm
Std(Mul(Sub($close,$preclose),$high),40)
Abs($vwap)
$amount
Add(Constant(0.01),$high)
$volume
$high
Div($pcfncfttm,Constant(0.01))
$psttm
Div(Add($volume,Less(Add($amount,$amount),Constant(-0.01))),$pettm)
Abs($volume)
Div(Sub(Constant(-1.0),Mean($volume,40)),Constant(-0.5))
$pctchg
Add(Sub(Constant(-1.0),Div($low,Sub(Constant(5.0),Min(Mul(Var($volume,20),$pettm),10)))),Div($isst,Sub(Constant(1.0),$close)))
$turn
$close
Sub($isst,$turn)
Sub(Constant(10.0),$low)
$volume
Sum(Add(Add(Constant(-0.01),$pettm),$psttm),20)
Sub(Constant(30.0),Mul($amount,$amount))
$high
Med($isst,20)
$preclose
$pbmrq
Mul(Constant(2.0),Log(Log($pcfncfttm)))
$volume
Var($pettm,30)
$high
$preclose
Cov(Add(Constant(2.0),Var(Log($amount),10)),$amount,10)
$low
Cov($amount,Delta(Abs(Div($vwap,Med(Div(Constant(-0.01),$open),40))),50),40)
$volume
Sub(Constant(-0.01),$high)
Div(Sub($pettm,$pcfncfttm),Constant(0.5))
Mul($pctchg,Greater($turn,$close))
$close
Sub(Greater(Constant(5.0),$vwap),WMA($turn,10))
$pcfncfttm
Add(Med(Sub(Add(Constant(-30.0),$amount),Constant(10.0)),50),$pettm)
$pcfncfttm
$close
Ref($pcfncfttm,30)
Add(Constant(-0.5),$preclose)
Sub($high,$close)
Sub(Constant(-2.0),$turn)
$preclose
$isst
Abs($amount)
$low
Med($high,40)
Sub(Less(Constant(1.0),Sum(Add($psttm,$preclose),10)),$vwap)
Sub(Constant(-0.01),Mean(Abs(Sub(Abs(Sub(Add($preclose,$vwap),Sub(Constant(5.0),Sum($amount,50)))),Constant(-0.5))),20))
$open
Div(Constant(-2.0),Greater(Div(Abs($low),$vwap),$pctchg))
Div(Constant(-2.0),$high)
Mul(Constant(-1.0),$open)
$high
WMA(Sub(Add($high,$open),Constant(30.0)),20)
EMA(Mean(Ref($amount,10),10),20)
$pcfncfttm
Var($pctchg,10)
Mean($high,20)
Sub(Constant(-5.0),Div($low,$amount))
Abs(Sub(Add($amount,$low),$pctchg))
Div(Mul($vwap,$psttm),$isst)
Div(Constant(-30.0),$open)
Mul($volume,Constant(2.0))
Sub(Constant(-0.01),$pctchg)
$pctchg
Greater(Div(Constant(-30.0),Add(Div(Sum(Sub($pbmrq,$turn),40),Div($psttm,$pcfncfttm)),$pbmrq)),$pbmrq)
Mul(Mul(Constant(5.0),$pctchg),Greater(Constant(2.0),$vwap))
$pbmrq
$turn
Var($pcfncfttm,40)
Sub(Log($turn),Constant(5.0))
Add(Constant(-0.01),$psttm)
$volume
$preclose
$isst
$high
$pettm
Add(Constant(-0.01),$vwap)
Mul(Constant(-10.0),Ref($isst,50))
$close
$pcfncfttm
Mul(Add($pctchg,Constant(-2.0)),$volume)
$preclose
$close
$vwap
WMA(Div($open,Add(Constant(-0.5),Mul($volume,Var($pcfncfttm,50)))),20)
Mul($open,$psttm)
$close
Med(Div(Constant(-10.0),$pettm),40)
$vwap
$high
Sum(Add($amount,$pcfncfttm),20)
Less(Add(Constant(2.0),$pbmrq),$low)
Log($pctchg)
Mul(Constant(-5.0),Var($turn,40))
Sub(Sub($turn,Add($turn,Constant(-5.0))),$high)
Add(Constant(-2.0),Sum(Add(Sub($pctchg,$pctchg),Constant(-2.0)),40))
$turn
Mul(Constant(-0.01),Greater($volume,$amount))
Div(EMA(Add(Constant(-1.0),Add($vwap,$pettm)),40),Constant(30.0))
$volume
Div(Constant(-10.0),$vwap)
Add(Delta($close,10),Std($low,20))
$preclose
Mul(Constant(1.0),$volume)
$pettm
$pbmrq
$pcfncfttm
Mul(Constant(5.0),$pbmrq)
$amount
Add($pcfncfttm,$volume)
Var(Sub(Abs(Sub(Constant(30.0),Greater($vwap,Div(Mul($high,Constant(30.0)),Sum($preclose,40))))),$psttm),40)
Sub($turn,$vwap)
$high
$isst
Sub($preclose,$low)
$pettm
Mul(Constant(-2.0),Var(Mul(Mean($preclose,20),Constant(2.0)),40))
Div(Constant(1.0),$pcfncfttm)
$amount
$preclose
$low
Sub(Constant(0.5),$vwap)
$preclose
Mul(Mul(Sub(Mul(Constant(-0.01),$amount),Constant(1.0)),$volume),EMA($preclose,10))
Sub($volume,Less(Add($isst,Div($turn,Constant(30.0))),Constant(-2.0)))
Div(Med($volume,10),Constant(-0.01))
Delta($pettm,50)
$pbmrq
$vwap
Sub(Add(Mean($isst,10),Constant(5.0)),$pctchg)
Sub(Mul($close,Constant(0.01)),Abs(Mul(Sub($high,Constant(-0.01)),$volume)))
Abs($volume)
$isst
$pctchg
Sub(WMA(Add(Less(Constant(30.0),$pcfncfttm),$low),50),$turn)
Sub(Constant(-0.5),Div($low,Constant(0.01)))
$volume
Cov(Add(Constant(-0.5),$volume),Med($amount,10),20)
Sub(Constant(-0.01),$close)
$turn
Div(Constant(10.0),Mul(Mul($pettm,$close),Cov(Var($pbmrq,20),Add($preclose,Greater($isst,Constant(0.5))),20)))
Sum(Sum($psttm,10),50)
Add(Constant(-0.01),Log(Sub(Mul(Abs(EMA(Greater($pettm,$close),20)),$turn),Mul(Sub($high,Constant(0.01)),Constant(1.0)))))
$volume
Mul(Constant(-0.01),$preclose)
Sub(Var($preclose,40),$vwap)
Med(Add(Sub(Greater(Constant(30.0),$close),$turn),Constant(10.0)),20)
Sub($pctchg,Greater(Constant(-0.01),$turn))
$pettm
Abs($volume)
$open
Greater(Mul(Mul(Constant(-30.0),$high),Constant(-2.0)),Abs($high))
$pctchg
Sub(Div(Constant(-30.0),$vwap),Abs(Sub(Div(Ref($volume,40),$pettm),Constant(-1.0))))
Sub(Constant(-0.01),Min($close,10))
$close
Mul(Constant(-0.01),$turn)
$vwap
Med($amount,20)
$low
$close
$preclose
Log($low)
$close
Add(Constant(30.0),Cov($vwap,$high,30))
Mad(Add(Mul($psttm,$close),$pctchg),30)
Sub(Greater($amount,Constant(0.01)),$isst)
Mul(Constant(5.0),$vwap)
Std(Min(WMA($pcfncfttm,50),50),10)
$vwap
$amount
Sum(Abs(Sub(Less(Constant(-1.0),Div($isst,$pctchg)),$vwap)),10)
Mul(Sub(Add(EMA(Add(Constant(0.5),$turn),20),$vwap),Add(Add(Mul(Delta($open,40),Constant(-2.0)),Constant(-10.0)),Constant(0.01))),Constant(-30.0))
$turn
$pettm
Add(Constant(5.0),Log(Abs($low)))
Mul(Sub(Constant(-30.0),$close),$turn)
Less(Div(Div(Greater(Constant(30.0),Add($psttm,$preclose)),$pettm),Constant(-0.5)),Abs($preclose))
Div(Constant(-2.0),$vwap)
Mul(Constant(30.0),Div($pbmrq,Sub(Abs(Sub($preclose,Log(WMA($pcfncfttm,10)))),Add(Constant(-0.5),$pctchg))))
Sub(Constant(-5.0),$open)
Mul($high,Constant(-30.0))
$open
Sub(Abs(Mul($turn,$isst)),Add($amount,Constant(-0.01)))
Cov($turn,$psttm,20)
$amount
Mul(Constant(-1.0),Sub($pettm,Constant(-2.0)))
$volume
Cov($pcfncfttm,$close,10)
Sub(Constant(2.0),$high)
Mul(Constant(0.01),Cov(Div(Div($volume,$pctchg),Constant(10.0)),$volume,50))
$high
$amount
Mul(Constant(0.5),$vwap)
$close
Add(Constant(-30.0),Sub($isst,$psttm))
$pcfncfttm
Div(Greater(Constant(-0.01),Var(Sum($pcfncfttm,10),10)),$open)
Abs($psttm)
$pbmrq
$psttm
$preclose
Add(Med(Sum(Mad($vwap,30),20),10),Constant(-0.01))
$vwap
$pettm
Div($turn,$pcfncfttm)
Mul($amount,$low)
$low
Mul(Sub($vwap,$preclose),Log($turn))
EMA($pbmrq,20)
$high
$vwap
Mul(Constant(5.0),Abs($turn))
WMA($close,50)
$isst
Mean(Greater(Var($high,40),$pcfncfttm),30)
Mul(Constant(-0.01),$isst)
Sub(Delta($high,10),$amount)
Sub(Constant(0.5),$amount)
Med($open,10)
$turn
Div(Mul(Constant(1.0),WMA(EMA(Abs($pettm),10),10)),Greater(Add($isst,Min(Med($psttm,10),40)),Constant(-30.0)))
Mul(Cov(Sub(Constant(-2.0),Mad(Med(Corr($psttm,$volume,30),40),10)),$high,40),Constant(5.0))
Add(Constant(-0.01),Abs(Log(Sub(Greater(Abs($vwap),Constant(-1.0)),$psttm))))
Sum($preclose,30)
$isst
Div($amount,Std($pettm,20))
Add($pettm,Mul(Add(Constant(0.01),Greater(Abs($preclose),Sub($pbmrq,$open))),Mad($pettm,30)))
$preclose
$pctchg
Sub($pcfncfttm,$high)
Add(Mad(Sub(Abs(Sub(Sub(Constant(-0.01),$pettm),$pettm)),Constant(0.5)),20),$vwap)
$open
Sub($pettm,$isst)
Mul(Mul(Add(Sub(Constant(-10.0),Add($psttm,Constant(10.0))),Abs($amount)),$low),Constant(-0.5))
Min($psttm,20)
WMA($preclose,10)
Add(Less(Constant(0.01),Log($open)),$pbmrq)
Abs(Mul(Log(Less(Mul(Constant(2.0),Add($high,Constant(-2.0))),Mean($volume,40))),$close))
$pcfncfttm
$open
$isst
Add(Add(Sub($pettm,Div(Sub($pcfncfttm,Constant(5.0)),Constant(-0.01))),Mul(Min($volume,10),Std(Ref($volume,50),40))),Constant(0.01))
$volume
Med(Mul(Constant(-10.0),$pbmrq),40)
$vwap
$psttm
Abs($open)
$pettm
Add(Div(Log(Sub(Log($turn),$close)),Greater($volume,$psttm)),Mean(Sub(EMA($turn,50),$turn),30))
Add(Mul(Abs(Add($close,$high)),Log(Abs($high))),$pettm)
$isst
Log(Div(Constant(-0.01),$high))
Mul($volume,$vwap)
Sub(Med(Mul(Greater($volume,Constant(10.0)),$close),20),Constant(-0.5))
$pctchg
Ref(Mul($volume,Constant(30.0)),10)
Std(Min($pcfncfttm,20),10)
$psttm
$pcfncfttm
$preclose
Add(Constant(-0.01),Sub(Sub($pcfncfttm,Abs($low)),Constant(-1.0)))
Mul(Mul(Less($volume,Cov($close,$close,10)),Constant(-5.0)),$pbmrq)
$high
Med($volume,20)
$preclose
$pcfncfttm
Add(Constant(10.0),WMA(Max(Mul($pcfncfttm,$pcfncfttm),50),20))
Div(Constant(-30.0),Mul($close,Div(Constant(-30.0),$preclose)))
Div(Constant(30.0),$close)
$psttm
Mul(Div($psttm,Constant(-1.0)),Constant(2.0))
Abs(Div(Constant(-10.0),$low))
Div(Constant(-30.0),EMA($open,40))
Add(Greater(Ref(Less(Mad($volume,10),$turn),30),Constant(-0.01)),$psttm)
Abs(Mul($pcfncfttm,Constant(-1.0)))
Var($pctchg,40)
$open
$high
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104100431/22528_steps
----------------------------------------
| pool/                   |            |
|    best_ic_ret          | 0.241      |
|    eval_cnt             | 510        |
|    significant          | 163        |
|    size                 | 200        |
| rollout/                |            |
|    ep_len_mean          | 6.48       |
|    ep_rew_mean          | 0.0461     |
| test/                   |            |
|    ic                   | 0.052      |
|    rank_ic              | 0.0632     |
| time/                   |            |
|    fps                  | 4          |
|    iterations           | 11         |
|    time_elapsed         | 4744       |
|    total_timesteps      | 22528      |
| train/                  |            |
|    approx_kl            | 0.01531009 |
|    clip_fraction        | 0.207      |
|    clip_range           | 0.2        |
|    entropy_loss         | -2.84      |
|    explained_variance   | 5.96e-07   |
|    learning_rate        | 0.001      |
|    loss                 | -0.241     |
|    n_updates            | 100        |
|    policy_gradient_loss | -0.0319    |
|    value_loss           | 0.181      |
----------------------------------------
Less(Add($low,Mul(Constant(-0.01),Div(WMA($pettm,20),$pettm))),Sub(Constant(30.0),Log($amount)))
$isst
Div(Med($isst,20),Greater(Constant(10.0),$turn))
$psttm
EMA(Sub($pettm,Add($amount,Constant(5.0))),10)
Div(Greater($amount,Constant(-10.0)),$volume)
Add(Sub(Sub(Greater(Constant(0.5),$low),Sub($vwap,Add(Ref($close,20),$open))),$isst),$close)
$vwap
Add(Constant(-1.0),$pcfncfttm)
$pctchg
$low
Mul(Add($volume,Less(Var($low,10),Constant(0.5))),Mul(Constant(-30.0),$amount))
$volume
$vwap
Sub(Add(Constant(2.0),$pettm),Cov(Sub(Med($turn,50),$psttm),$volume,20))
Mul(Constant(2.0),Abs($turn))
Sub(Log($volume),$pctchg)
$low
Mul(Constant(-30.0),$pcfncfttm)
Add(Constant(-0.01),$close)
EMA($preclose,10)
$vwap
Div($turn,Sub($volume,Sub(Sub($isst,Constant(-0.01)),Constant(-0.01))))
EMA(Min($low,10),20)
Add(Constant(-1.0),$preclose)
Sub($amount,Div(Constant(-30.0),Mul(Var(Med($high,20),20),$volume)))
$turn
Add(Constant(0.01),$pctchg)
$turn
$amount
Sub(Constant(-0.01),Med(Min(Sub($isst,Div($high,Constant(-2.0))),20),40))
Ref(Std(Add(Constant(0.5),Mul($pctchg,Constant(5.0))),40),40)
Sub(EMA(Sub(Add(Sub(Constant(30.0),Sub($vwap,Sub($volume,Constant(-5.0)))),$vwap),Add($vwap,Div($turn,Constant(5.0)))),20),Constant(10.0))
$turn
Mul(Less(Constant(-2.0),Var($psttm,30)),$vwap)
Std(Div(Constant(30.0),Mul($pettm,$pettm)),20)
Less(Ref($amount,40),$pctchg)
$pettm
WMA(Mul($volume,$pcfncfttm),20)
Mul(Greater(Constant(-0.01),$isst),Add(Div($isst,Constant(-2.0)),Constant(-2.0)))
$volume
Add($preclose,$pettm)
Corr(Std(Mul(Sub(Var($pcfncfttm,10),$pctchg),Constant(-0.5)),20),Mul($high,Corr($amount,$amount,40)),10)
Sub(Constant(-0.5),Var($pcfncfttm,20))
Min(Less(Sub(Constant(-10.0),$turn),$open),50)
$isst
Sub(Less(Constant(2.0),Mul(Sub($amount,Constant(5.0)),Constant(-0.01))),$pcfncfttm)
$vwap
Corr($volume,$pctchg,20)
Div(Log(Div(Sub($low,$amount),$volume)),Log($pbmrq))
$isst
Std($preclose,10)
WMA($psttm,50)
Corr(Div(Less(Greater($vwap,Constant(5.0)),$vwap),$pettm),Corr(Med($pettm,30),Div(Constant(-0.01),Med($vwap,20)),40),40)
Mul(Constant(-2.0),Std($vwap,40))
Corr($low,$isst,50)
Sub(Constant(-2.0),$high)
Less(Mul(Constant(-0.01),$pettm),$vwap)
$pettm
$pctchg
$close
WMA(Mul(Constant(-1.0),$turn),30)
$psttm
$preclose
Sub(Constant(5.0),$turn)
$turn
Mean(Mul(Constant(0.5),Sub($psttm,Add($high,Corr($open,Add($turn,Constant(0.01)),20)))),40)
$volume
Mul(Constant(-1.0),Add($volume,$preclose))
$pbmrq
EMA(Corr(Greater(Mul($close,Constant(-10.0)),$volume),Add($isst,Constant(1.0)),20),30)
Add($close,$open)
Mul($close,Constant(30.0))
EMA(Std(Sub(Add($vwap,Div(Constant(5.0),Std($low,40))),$pettm),10),50)
Sub(Mul(Constant(-2.0),$open),$high)
$pettm
Div($isst,Constant(-10.0))
Sub(Constant(0.5),$turn)
WMA($high,30)
Corr($pettm,$open,30)
Div(Constant(-2.0),$turn)
$vwap
Cov($pettm,$low,10)
$isst
Sub(Add($pctchg,Mul(Constant(1.0),$pctchg)),$amount)
Mean($amount,10)
Min(Ref(Delta(Mul(Constant(2.0),Cov(Med($pctchg,50),$isst,40)),40),20),10)
$preclose
Sub(Less(Constant(-1.0),$psttm),$vwap)
Mul(Constant(1.0),EMA(Greater($isst,$turn),40))
Div($amount,Constant(-10.0))
Sub(Constant(30.0),$pctchg)
Sub($preclose,$high)
Sub(Mul($pettm,$vwap),Cov($turn,$pctchg,20))
Div(Constant(1.0),Mean($open,50))
EMA(Var(Abs(Mean(Mul(Constant(0.01),$volume),10)),30),40)
$isst
$low
Greater(Mul(Greater(Constant(2.0),$pctchg),$open),Log(Std(Less(Add($preclose,Constant(-2.0)),Sub($pettm,$pettm)),50)))
$volume
Add(Constant(-10.0),WMA($close,10))
Add(Div(Constant(-30.0),$preclose),Constant(-30.0))
Std(Add(Constant(5.0),$pettm),20)
Div(Mul(Abs(Var($psttm,20)),$turn),$psttm)
Abs(Mul(Constant(1.0),Sum(Mul(Div($pbmrq,Constant(0.5)),Constant(10.0)),40)))
EMA($amount,30)
$pctchg
$low
Corr(Div(Constant(-0.01),Log($vwap)),$turn,30)
$open
$close
$turn
Mul(Constant(30.0),EMA($high,40))
Var(Mul(Constant(30.0),$preclose),40)
Sub(Sub(Constant(-2.0),Abs($pctchg)),Constant(10.0))
Greater(Mean(Sub($turn,Add($pbmrq,Max($close,20))),20),$pcfncfttm)
$high
Mul(Constant(-30.0),$close)
Div($pcfncfttm,Mul($amount,$high))
Mul(Add(Mul($pettm,Mul(Mul($pctchg,$psttm),Constant(0.01))),$volume),$amount)
Sub(Constant(-30.0),$isst)
Var(Min($turn,20),20)
$preclose
$pctchg
Div(Constant(30.0),$volume)
Abs($turn)
Log($pbmrq)
$psttm
Sub(Mul(Constant(2.0),Mul($vwap,$pctchg)),Constant(-10.0))
$psttm
$volume
Div(Constant(-0.5),Std($turn,30))
Div(Constant(30.0),$open)
Mul(Sub(Var(Corr($low,Less($high,$preclose),20),20),$vwap),$amount)
$pcfncfttm
Mul($close,$amount)
$close
Std(Add(EMA(Sub(Constant(-0.01),$close),40),Sub(Constant(-0.01),$turn)),10)
Log($vwap)
Mul(Add($pettm,Constant(2.0)),$close)
Add(Constant(0.5),Add(Mul(Sub($psttm,$pctchg),Constant(5.0)),Add(Constant(30.0),Ref(Abs($pettm),50))))
$preclose
Div($pcfncfttm,$high)
$preclose
$vwap
Sub(Constant(-30.0),Add(Sub(EMA($pcfncfttm,20),Constant(1.0)),Constant(-30.0)))
Sub(Greater(Add(Constant(1.0),$pettm),Constant(-0.01)),$vwap)
Log(Mul(WMA(Sub($vwap,Log(Sub(Constant(1.0),$amount))),20),$turn))
Sub($vwap,Constant(0.5))
Mul(Constant(10.0),$amount)
$preclose
$pcfncfttm
Mul($close,Mul($open,Constant(1.0)))
$pettm
$turn
Cov(Mul(Add(Div(Constant(1.0),$amount),$isst),$preclose),$volume,20)
$pettm
$high
Div(Div(Mul(Mad(Log(Mul(Sub($preclose,Constant(1.0)),Constant(5.0))),50),$amount),Constant(2.0)),Mul(Constant(-2.0),$pettm))
$vwap
Min(Std(Sum(Med($close,30),50),10),40)
$preclose
$volume
$volume
Mul(Corr(Mul($high,Abs(Med($amount,40))),Div($pettm,Max(Div(Med($volume,20),Constant(0.5)),30)),50),$vwap)
$close
Add(Constant(-10.0),Mad($open,20))
$pcfncfttm
$open
Div(Constant(-5.0),$vwap)
Greater(Mul(Sub(Less(Constant(-2.0),$amount),$low),$turn),$high)
Mul(Std(Sub(Sub(Constant(2.0),WMA($preclose,30)),$pcfncfttm),30),Constant(-1.0))
$pettm
Med($open,10)
Sub(Div(Constant(-0.01),Log($pettm)),Constant(-0.01))
Mul($pctchg,$high)
$close
$vwap
Add(Div(Constant(-30.0),$open),Add($low,$turn))
Min(Sub(Less(Constant(-1.0),$volume),Sub(Mul($amount,Constant(-1.0)),EMA($volume,20))),20)
Abs(Mul($turn,$pctchg))
Sub(Constant(-1.0),Mad($pctchg,20))
$pcfncfttm
Sub(Constant(30.0),Less(Abs($pettm),EMA(Med($amount,20),20)))
$open
Var($vwap,30)
Std(Add(Log(Min(Sub(Constant(5.0),$isst),10)),$turn),40)
$volume
Delta(Greater(Log($psttm),$preclose),20)
Add(Cov($volume,$isst,10),$preclose)
Sub(Constant(-0.01),$pctchg)
Sub($amount,Div(Add($volume,Constant(-30.0)),Greater(Constant(-30.0),$vwap)))
$low
$pcfncfttm
$pettm
Sub($pettm,$preclose)
Sub(Greater($pcfncfttm,Constant(10.0)),Abs(EMA($open,10)))
Less($pettm,$psttm)
Sub(Constant(1.0),Std($psttm,20))
$close
Sub(Mean($pettm,10),Add(Mul(Constant(-0.5),$low),Constant(0.01)))
$amount
$pbmrq
$turn
Sub(Constant(1.0),$pettm)
Div(Mean(Add(Constant(-2.0),$turn),10),$preclose)
Add(Div(Constant(-5.0),$pettm),Constant(-0.01))
Mul(Constant(-2.0),Std(Mad($high,30),10))
Sub(Constant(-10.0),$turn)
Abs(Sub(Constant(-30.0),$vwap))
Div(Constant(1.0),Mul($turn,$psttm))
Med($high,20)
Sub(Abs($open),$pettm)
$pbmrq
Min(Log($pcfncfttm),20)
$vwap
Mul($volume,$pcfncfttm)
Add(Constant(-2.0),Abs($psttm))
Add(Constant(-10.0),$preclose)
Add(Constant(30.0),Log(Max($turn,40)))
$pettm
$high
Sub($volume,$volume)
Sum($preclose,20)
Sub(Greater(Constant(0.5),$pettm),Sub($preclose,$pctchg))
Sub(Constant(30.0),$open)
$open
Var($pcfncfttm,40)
$preclose
Abs($vwap)
$pettm
Sub(Sub(Constant(5.0),$isst),Constant(-0.01))
Sub(Constant(2.0),Mean($close,10))
$vwap
Mul(Constant(10.0),Med(Add($volume,$pctchg),20))
Div(Constant(-0.01),Add($isst,Sub($preclose,Constant(1.0))))
Mad($psttm,20)
Sub($vwap,$isst)
$vwap
$turn
Mul(Constant(5.0),$pettm)
$vwap
Abs(Mad($volume,30))
$pctchg
Sub($isst,$low)
Sub(Constant(10.0),$psttm)
Log(Sub(Constant(-30.0),Mul(Greater($low,$open),$close)))
$high
$preclose
$pcfncfttm
$close
$vwap
$volume
Mul(Greater(Constant(1.0),$amount),Log(Add($amount,$pctchg)))
Var($psttm,40)
Add(Constant(0.01),Log($turn))
$vwap
$isst
$close
Mul(Mean(Add(Constant(1.0),$amount),30),$turn)
Div(Constant(0.01),$open)
Mul(Mul(Constant(-30.0),Cov(Log($open),$amount,20)),Var(Std($psttm,30),20))
$pettm
Mul(Constant(2.0),Mul(Med($close,40),Var($volume,40)))
$volume
Mul(Mean($pcfncfttm,40),$close)
Delta(Sum(Mul(Constant(-0.01),Abs(Add($high,Sub($high,$volume)))),40),50)
Mul(Constant(-1.0),Sum(Corr(Mul($preclose,Sub($open,$turn)),Sub(Add(Constant(0.01),$close),Constant(-2.0)),50),40))
Add(Add(Constant(1.0),Delta(Mean($pctchg,50),30)),$close)
$amount
Div(Constant(2.0),Sub(Mean($low,30),$volume))
Mul(Constant(5.0),Add($pcfncfttm,Constant(-0.5)))
Var($pettm,40)
Div(Constant(-30.0),$pctchg)
Add(Constant(-30.0),$high)
$amount
Delta(Sub(Less($turn,Constant(0.5)),$pcfncfttm),30)
Sub(Greater(Constant(30.0),$amount),$isst)
$close
$amount
$turn
Var(WMA(Mul(Constant(-2.0),Delta($turn,10)),10),10)
$pcfncfttm
$close
$isst
$volume
$open
Max($preclose,30)
$isst
Sub(Sub(Constant(-5.0),$pcfncfttm),$high)
Var($pctchg,30)
Mul(Constant(1.0),$pctchg)
$pcfncfttm
Med(Mul(Greater(Constant(-0.01),Mad(Mul($volume,$psttm),50)),Add($preclose,$turn)),20)
Sub(Sub(Sub(Greater(Add(Constant(-2.0),WMA($vwap,40)),Constant(2.0)),Add($open,Less(Constant(-0.01),$turn))),Constant(1.0)),$open)
$vwap
Mean(Sub(Constant(-5.0),Abs($vwap)),40)
$volume
Mul($pctchg,Constant(1.0))
Add(Constant(-0.5),Std($preclose,10))
Delta(WMA($turn,20),20)
Var(Log($volume),20)
$close
Cov(Div(Constant(-10.0),$turn),$open,50)
$volume
Div(Constant(10.0),Sub($vwap,Greater(Log($volume),$vwap)))
$turn
$close
$turn
Add(Constant(30.0),$vwap)
Sub($volume,Constant(0.01))
Mul(Add(Constant(0.01),$low),$amount)
EMA(Mul(Less(Constant(-0.01),$high),Add(Log(Delta(Less($close,$volume),10)),$preclose)),20)
$preclose
$close
Mul($turn,$close)
Mul($psttm,Constant(1.0))
Mean(Sub(Div(Constant(-10.0),$psttm),Constant(5.0)),30)
Corr($psttm,$vwap,30)
Add(Sub(Constant(1.0),Add(Delta($volume,50),Constant(-2.0))),Constant(10.0))
Corr($pctchg,Sub($vwap,$amount),30)
Mul(Constant(0.01),Max(Div(Ref(Mul($high,Div($high,Greater(Constant(5.0),$pettm))),30),$close),30))
Mul(Constant(-0.01),Med($pettm,10))
$pettm
Mul(Greater(Constant(-1.0),Sub($volume,Constant(-30.0))),Log($low))
$pcfncfttm
$open
$isst
Log(Div(Constant(0.01),$close))
Div(Constant(5.0),Ref($close,20))
Min(Abs(Mul(Constant(5.0),Log($vwap))),40)
Mul(Constant(5.0),Med($vwap,20))
Mul($pettm,$volume)
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104100431/24576_steps
----------------------------------------
| pool/                   |            |
|    best_ic_ret          | 0.249      |
|    eval_cnt             | 704        |
|    significant          | 185        |
|    size                 | 200        |
| rollout/                |            |
|    ep_len_mean          | 5.77       |
|    ep_rew_mean          | 0.0914     |
| test/                   |            |
|    ic                   | 0.0481     |
|    rank_ic              | 0.0598     |
| time/                   |            |
|    fps                  | 3          |
|    iterations           | 12         |
|    time_elapsed         | 6690       |
|    total_timesteps      | 24576      |
| train/                  |            |
|    approx_kl            | 0.01402097 |
|    clip_fraction        | 0.154      |
|    clip_range           | 0.2        |
|    entropy_loss         | -2.76      |
|    explained_variance   | -2.42e-05  |
|    learning_rate        | 0.001      |
|    loss                 | -0.244     |
|    n_updates            | 110        |
|    policy_gradient_loss | -0.0182    |
|    value_loss           | 0.117      |
----------------------------------------
Sub($volume,Constant(0.5))
Std(Mul(Constant(-0.01),$psttm),30)
WMA($vwap,30)
$high
Sub(Constant(0.01),$vwap)
Add(Constant(30.0),$low)
Sub(Constant(-0.01),$close)
$isst
Abs(Sub(Sub($open,Add($vwap,Constant(-0.01))),Var(Sub(Constant(-30.0),$close),50)))
Mul(Constant(-10.0),$close)
Div($pettm,Div(Corr(Sub($pettm,Constant(-2.0)),$pcfncfttm,20),$pctchg))
Sub(Constant(-2.0),$volume)
$preclose
$turn
$vwap
Sub(Sub(Less(Constant(-0.01),Med($open,50)),Mean($amount,30)),Constant(5.0))
$pettm
$preclose
Sum($open,10)
Sub($high,Constant(5.0))
$pcfncfttm
Sub(Constant(5.0),$turn)
Std($open,40)
Mul($high,Constant(-0.5))
Add(Constant(-2.0),$psttm)
$pctchg
Sub(Constant(2.0),$pettm)
Max($close,40)
Div(Constant(-5.0),Mul($vwap,Constant(-0.01)))
Sub(Mul($high,Constant(1.0)),Ref(Add($high,Constant(5.0)),30))
$close
Div($pettm,Mul($open,Constant(10.0)))
Sub(Constant(-30.0),Sub(WMA($isst,10),$pctchg))
Sum(Min(Div(Constant(5.0),Add($pcfncfttm,Constant(-0.01))),50),20)
$turn
Sub(Sub(Constant(30.0),$turn),Constant(0.01))
Sub(Constant(2.0),$amount)
Div(Mul($low,$preclose),Add($amount,Constant(2.0)))
Div(Constant(30.0),$psttm)
Mul(Add(Sub(Constant(-0.01),Std(Delta($vwap,30),30)),Constant(5.0)),Constant(-1.0))
Sub(Constant(5.0),$volume)
$pctchg
Sub(Constant(-30.0),$open)
Ref(Sub(Constant(-0.01),Sub($close,$volume)),40)
Div(Greater(Constant(1.0),$turn),$turn)
Less(Div(Constant(30.0),$pcfncfttm),$close)
$isst
Mul(Greater(Constant(5.0),$turn),$vwap)
Abs(Div(Constant(-30.0),$pbmrq))
$pctchg
Mean($close,10)
Mul($high,Constant(30.0))
Mul(Constant(-10.0),$pctchg)
$psttm
Sub(Constant(-0.01),Sub($open,Less(Constant(5.0),$amount)))
$vwap
$turn
$low
Mul(Constant(5.0),Abs($pettm))
Var(Sum(Div($close,Constant(5.0)),20),10)
Sub(Constant(5.0),$open)
$amount
$isst
Sub(Constant(-30.0),Mul($amount,$vwap))
Sub(Constant(5.0),$close)
$pettm
Mul(Mul(Greater(Constant(5.0),$low),$high),$vwap)
Div(Constant(-0.01),$turn)
$close
$low
$preclose
$psttm
Abs(Mul(Constant(-10.0),$pcfncfttm))
Mul(Constant(-0.01),Mul($pcfncfttm,$turn))
Sub($vwap,$amount)
Div($high,Constant(-0.01))
Sub(Sub($amount,$open),Constant(-1.0))
Mul(Constant(-1.0),$pctchg)
Add(Var(Sub(Div(Constant(5.0),Mul(Corr(Mul(Abs($open),Constant(-0.5)),$preclose,40),$volume)),Constant(0.01)),30),Constant(5.0))
Sub(Constant(5.0),$volume)
Div(Corr(Sub(Mul(Constant(-10.0),Log(Div($isst,$high))),$preclose),$amount,40),Constant(10.0))
Sub(Max(Std($turn,30),10),Constant(10.0))
Mad($pcfncfttm,20)
Div(Constant(-1.0),$preclose)
$volume
Sub(Constant(30.0),Min($low,30))
$close
$volume
$close
Add(Constant(30.0),Mul(Div($pettm,$high),$pcfncfttm))
$vwap
Mul(Add(Constant(1.0),Log($isst)),Constant(10.0))
Log(Add(Constant(-0.01),Div(Sub(Sub($preclose,$preclose),Constant(1.0)),$psttm)))
$pctchg
Sub(Sub(Constant(5.0),$high),Constant(0.01))
Sub(Constant(-10.0),$pettm)
Sub(Constant(5.0),$isst)
Mul(Constant(-1.0),$pettm)
$preclose
$volume
Div(Constant(30.0),$open)
Div($vwap,$preclose)
Add(Constant(10.0),$isst)
EMA(Div(Add(Add(Constant(-0.5),$amount),Sub($isst,$preclose)),Sub($volume,Constant(-10.0))),20)
Log(Sub($vwap,$close))
Mean($amount,20)
$pcfncfttm
$isst
$amount
Div($amount,$pettm)
Sub(Sub(Add(Greater(Constant(0.01),$pbmrq),$high),Constant(-1.0)),$vwap)
Var(Sum(Abs(Mul(Mul(Var($preclose,40),Constant(5.0)),$open)),20),20)
Abs(Sub(Sub(Constant(5.0),$psttm),Sub(Constant(10.0),Mul($volume,Greater($isst,Add(Div(Constant(-0.01),$vwap),$preclose))))))
Div(Mul($pcfncfttm,$high),Mul(Sub($vwap,Delta($pctchg,10)),Constant(0.01)))
$turn
$volume
Add(Constant(30.0),$turn)
$close
$psttm
Log($turn)
$close
$pbmrq
$pcfncfttm
Mul(Constant(5.0),$amount)
$pettm
Sub(Constant(0.5),Add(Abs($pettm),$open))
$pctchg
Sub(Mul($open,Constant(-10.0)),Constant(10.0))
$vwap
Sub(Constant(-30.0),Greater(Sub($open,$isst),$amount))
Div(Constant(-2.0),$isst)
Sub(Mul(Constant(5.0),Sum($pbmrq,50)),$pettm)
Add(Constant(-0.5),$amount)
Corr(Sub(Constant(1.0),$isst),Sub(Std(Sub($preclose,Less(Constant(-0.5),Abs($pcfncfttm))),40),Abs($amount)),30)
Sub(Sub(Constant(10.0),$volume),Constant(-0.01))
Mean($amount,50)
Add($preclose,$turn)
Div(Constant(0.01),Sub($turn,Constant(5.0)))
$isst
Mul(Greater(Constant(-30.0),$psttm),$pbmrq)
Sub(Div(Add(Constant(30.0),Div($pbmrq,Constant(1.0))),Constant(-0.01)),Mul(Constant(1.0),Max($isst,10)))
$amount
Ref(Add($amount,Log($pcfncfttm)),10)
Ref(Div($close,Div(Constant(5.0),$amount)),10)
Mul(Sub(Constant(-30.0),$amount),Constant(1.0))
$high
Sub(Constant(5.0),$amount)
Div(Greater(Constant(5.0),Log($amount)),Add($amount,Less($psttm,Div(Constant(1.0),$isst))))
$amount
$close
Mul($vwap,$vwap)
Add(Greater($close,Sub(Constant(30.0),$open)),$pctchg)
Div(Greater(Constant(5.0),Log($low)),Div($close,Add(Div($preclose,$psttm),Constant(0.01))))
Div($low,$pbmrq)
Div(Constant(-5.0),$vwap)
Add($volume,$volume)
Div(Greater(Less(Constant(0.01),$pctchg),Min(Mean(Sub($pettm,Constant(5.0)),30),10)),$amount)
$amount
$high
$preclose
$pbmrq
Sub(Constant(10.0),Div($close,Constant(5.0)))
$amount
Div(Greater(Constant(-0.01),$pettm),$psttm)
$low
Mul($high,$pbmrq)
$pctchg
Less(EMA(Div(Constant(-0.01),$close),20),Abs(Corr(Abs($pcfncfttm),Sub($amount,Constant(10.0)),20)))
$amount
$vwap
Div(Constant(5.0),$amount)
Mul(Constant(-30.0),$low)
Sum(Std($vwap,10),40)
$pettm
Var(Var(Sub(Constant(-2.0),$volume),30),20)
$low
Sub(Add(Constant(-1.0),$low),Sub(Med($amount,20),Constant(-0.01)))
Mul(Div($psttm,Constant(-5.0)),Constant(-10.0))
$volume
Var($preclose,20)
$pctchg
Sub(Constant(-30.0),$isst)
$amount
Div(Less(Constant(-2.0),$close),$psttm)
$vwap
Mul($vwap,Constant(-5.0))
$isst
Mean(Div($pctchg,$volume),20)
Div(Constant(10.0),$pctchg)
$pbmrq
Div($low,$volume)
Add(Constant(-0.5),$pcfncfttm)
Add(Constant(-2.0),$psttm)
$turn
Div(Less(Sub(Sub($preclose,$volume),Constant(-1.0)),Constant(1.0)),Med($low,10))
$open
$close
$pbmrq
$volume
Sub(Constant(-10.0),Mul(Sub($pettm,$amount),Mul(Var($volume,20),Constant(30.0))))
$volume
Sub(Div(Greater(Constant(0.5),$preclose),$amount),Constant(-0.5))
Sub(Constant(-0.01),$pbmrq)
Sub(Greater(Less(WMA(Less(Div(Constant(-5.0),Div($turn,$pctchg)),$close),10),Constant(5.0)),Var($amount,30)),$pettm)
Sub(Constant(-5.0),$preclose)
$isst
$high
$high
Abs($pctchg)
$isst
$close
Sub(Sub(Constant(-5.0),$close),$psttm)
$volume
$isst
Greater($psttm,Sub(Constant(30.0),Div($psttm,$pctchg)))
Sub(Sub($preclose,Mul(Log(Mul(Abs($psttm),Constant(10.0))),$pbmrq)),$open)
$isst
$pbmrq
$preclose
$high
Sub(Constant(5.0),$amount)
Add($turn,$turn)
Mul($psttm,$turn)
$amount
Sub(Constant(10.0),Mul($pcfncfttm,Log(Sub($pbmrq,Constant(-0.01)))))
$isst
Mul(Constant(-0.01),Sub(Greater($vwap,Constant(5.0)),$low))
Sub(Constant(0.01),$psttm)
Corr(Mul(Constant(-0.01),$close),$close,20)
Sub($pctchg,Greater($high,Mul($volume,Constant(1.0))))
$close
Add(Constant(0.01),Delta(Delta($pettm,20),20))
$high
$vwap
$high
Sub(Sub(Constant(2.0),$amount),$pettm)
$close
$low
$vwap
$close
Mul(Sub(Constant(30.0),$volume),Min($amount,20))
Sub(Div(Constant(-1.0),$pcfncfttm),Sub($pbmrq,$vwap))
Sub(Constant(-2.0),Sub($volume,Constant(5.0)))
$close
Div(Constant(-0.01),Corr(Min($pettm,40),$close,40))
$turn
Mul($pettm,$psttm)
$pcfncfttm
Div(Constant(-0.5),$volume)
Div(Sub(Constant(0.5),$psttm),Sub($volume,Constant(0.01)))
Div(Div(Constant(-5.0),$pettm),Constant(-30.0))
Sub(Add(Constant(10.0),$pcfncfttm),Constant(10.0))
Mean(Add(Constant(1.0),$psttm),30)
Sub(Constant(5.0),$close)
Ref(Delta(Sum($isst,20),10),20)
Ref($preclose,40)
Div($low,Add(Greater(Constant(5.0),$open),$close))
$turn
Mean(Var(Sub($close,Add($psttm,Constant(10.0))),30),20)
$pbmrq
$psttm
Greater(Sub(Constant(1.0),$psttm),$preclose)
$vwap
$psttm
$high
$vwap
$pctchg
$volume
Div(Constant(1.0),$pctchg)
Add(Constant(5.0),Div($pctchg,Constant(1.0)))
Sub(Constant(1.0),Var($pctchg,50))
$preclose
$preclose
$preclose
$vwap
Mul(Constant(-10.0),$close)
$high
Add($amount,Add($isst,$close))
Sub(Div(Constant(5.0),$pcfncfttm),$isst)
$pctchg
$open
Ref(Mul(Constant(-10.0),Add(Mul($amount,$turn),$amount)),20)
$isst
Add(Constant(5.0),Std($open,20))
Div(Constant(1.0),$psttm)
Add($close,Constant(30.0))
Sub(Constant(-0.01),Sub(Var($preclose,20),$turn))
Sub(Greater($turn,Constant(1.0)),$turn)
$turn
$volume
Sub(Constant(-5.0),$psttm)
Add(Mean(Corr($amount,$pettm,10),20),$amount)
$close
Div(Div(Ref(Add(Constant(-1.0),$volume),50),$isst),$amount)
Greater($turn,Sub(Constant(1.0),Log($pettm)))
$pbmrq
$turn
Mul(Constant(5.0),WMA(Cov(Add(Sub($volume,Abs($vwap)),$amount),$close,50),20))
Add(Constant(0.01),Add(Sub(Abs($volume),$amount),Constant(-30.0)))
Std(Sub(Constant(-2.0),$isst),50)
Var($isst,20)
Mul(Constant(-0.01),$amount)
Mul(Constant(-0.5),Add(Greater($isst,Constant(0.01)),$turn))
Sub(Constant(-0.5),$vwap)
Mad($low,20)
$pctchg
$isst
$close
$vwap
$amount
Div(Constant(2.0),Mul(Mul($open,Sub($low,$isst)),Constant(10.0)))
Ref(Mul($pcfncfttm,Mul($open,$volume)),20)
Mul(EMA(Cov(Div(Greater(Constant(2.0),$vwap),$vwap),Mul(Constant(2.0),$isst),20),20),Sub(Constant(1.0),Mad($volume,20)))
Sub(Constant(0.01),Max($pcfncfttm,30))
Sub(Constant(-0.01),Mul($preclose,Delta(Sub(Constant(1.0),Abs($pbmrq)),40)))
Mean(Abs(Sub(Constant(2.0),Add(Abs(Mad($turn,20)),Constant(30.0)))),10)
Mean(Add(Constant(-1.0),$vwap),50)
$isst
$pctchg
$isst
Div(Less(Constant(10.0),$high),Min($close,10))
Sub(Constant(-10.0),$volume)
Sub(Constant(1.0),Greater(WMA($pettm,20),$vwap))
Sub(Constant(10.0),$close)
$amount
Mul(Mul(Constant(-30.0),$vwap),$pctchg)
$amount
$vwap
Sub(Sub(Sub(Constant(1.0),$low),Constant(-2.0)),Sub($volume,$pbmrq))
$open
Add(Sub(Constant(-0.01),$vwap),Constant(30.0))
Sub(Constant(-2.0),Sub(Add($high,Constant(10.0)),Sub(Constant(-1.0),Mul(Mean(Greater($pettm,Ref(Div($turn,$pctchg),40)),10),Constant(-0.01)))))
WMA(Div(Constant(-2.0),$pctchg),20)
Div(EMA(Corr(Sub(Greater(Abs($high),Constant(10.0)),Abs($close)),$volume,10),40),$vwap)
Div(WMA(Log(Mul(Constant(-10.0),$vwap)),20),Constant(-2.0))
$pctchg
Sub($amount,Constant(5.0))
$amount
Sub(Constant(-0.01),Div($vwap,$close))
$psttm
Add(Constant(30.0),$open)
Var(Div(Constant(-2.0),$volume),30)
Mean($isst,20)
Sub(Constant(-2.0),$open)
Div(Mul(Constant(-2.0),Std($pcfncfttm,50)),Mul($low,Add($vwap,$pcfncfttm)))
Cov(Add(Constant(-0.01),$vwap),Sub(Constant(10.0),$pcfncfttm),50)
Sub($turn,$psttm)
$pettm
Sub($open,Constant(0.01))
Mul($preclose,Greater(Mul(Greater(Sub(Sub($turn,Constant(5.0)),$high),$pettm),Constant(0.01)),$pctchg))
Sub(Constant(1.0),Mul($isst,$volume))
Sub(Constant(5.0),$high)
Abs($pctchg)
Div(Constant(-1.0),$vwap)
Mean(Log($vwap),10)
$vwap
Min(Mul(Sum(Sub($volume,$open),20),Constant(5.0)),40)
Mul(Constant(5.0),Sub(Less($pcfncfttm,Constant(5.0)),$close))
$close
Mean(Sub(Greater(Constant(-1.0),$close),$isst),10)
$pctchg
Mul(Constant(-10.0),$vwap)
Sub(Constant(-30.0),Log($isst))
Sub(Constant(-30.0),$volume)
$high
$open
$volume
$open
Div(Constant(2.0),Abs($turn))
Sub(Constant(2.0),$turn)
$vwap
Min(Mul(Constant(2.0),Log(Abs(Div($volume,Constant(10.0))))),40)
Sub(Constant(-0.01),$turn)
Mean(Div(Constant(-10.0),Mul($pettm,$pettm)),30)
Min($pcfncfttm,10)
$pettm
Sub(Div(Less(Constant(30.0),Sub(Mean(Mul($isst,Constant(30.0)),40),Constant(0.5))),$amount),Div($open,Add(Constant(5.0),Add($vwap,$pettm))))
Add(Constant(-5.0),Div($volume,Less(Constant(-5.0),$high)))
Sub($pctchg,$vwap)
Add(Constant(-10.0),$vwap)
Sub(Mul(Constant(-2.0),Div($pettm,Constant(-0.5))),Sub($pctchg,Add(Sub(Constant(5.0),$volume),$amount)))
Div(Constant(1.0),$isst)
$open
Sub(Constant(-10.0),$high)
Add(Constant(-10.0),$pcfncfttm)
Mul($low,Log(Mul(Constant(-2.0),$high)))
Var($amount,20)
$psttm
$low
Sub(Constant(1.0),$vwap)
Div($amount,$psttm)
$turn
$pctchg
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104100431/26624_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.263       |
|    eval_cnt             | 948         |
|    significant          | 198         |
|    size                 | 200         |
| rollout/                |             |
|    ep_len_mean          | 5.5         |
|    ep_rew_mean          | 0.171       |
| test/                   |             |
|    ic                   | 0.0615      |
|    rank_ic              | 0.0564      |
| time/                   |             |
|    fps                  | 2           |
|    iterations           | 13          |
|    time_elapsed         | 8929        |
|    total_timesteps      | 26624       |
| train/                  |             |
|    approx_kl            | 0.016839921 |
|    clip_fraction        | 0.23        |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.71       |
|    explained_variance   | -4.05e-06   |
|    learning_rate        | 0.001       |
|    loss                 | -0.253      |
|    n_updates            | 120         |
|    policy_gradient_loss | -0.0257     |
|    value_loss           | 0.0852      |
-----------------------------------------
Sub(Constant(0.01),$vwap)
Add(Constant(5.0),$volume)
$pbmrq
Var(Sub(Greater(Constant(2.0),$pcfncfttm),Abs($vwap)),40)
$isst
$pettm
$vwap
Log(Corr(Sub(Sub(Constant(5.0),Mean($amount,10)),$close),$preclose,20))
Mul(Less(Constant(-0.01),$psttm),Abs($turn))
$pettm
Div(Constant(0.01),Div(Div(Sub(Mul($psttm,$amount),Constant(10.0)),$open),Constant(-30.0)))
Add($pcfncfttm,Constant(-5.0))
Div(Log($vwap),Mean(Div(Add($volume,$close),Greater(Sub($volume,Constant(5.0)),Less($psttm,Constant(-0.01)))),50))
Mul($pettm,WMA($volume,10))
$volume
$preclose
$vwap
$vwap
$pettm
Mul(Constant(10.0),$low)
$isst
Mul(Add(Constant(5.0),$high),$close)
$vwap
$open
Div(Constant(5.0),Var($low,40))
$volume
Sub(Constant(10.0),$psttm)
Add(Constant(-0.01),$close)
Add(Sub(Div(Constant(-1.0),Med(Log($pcfncfttm),30)),Sub(Constant(-0.01),Med($pettm,30))),$turn)
Mul(Sub(Constant(-0.01),$psttm),Constant(-0.01))
Mul(Constant(30.0),Sum(Div(Div(Sub(Sub($volume,Sub($amount,Constant(10.0))),Constant(-0.01)),Constant(5.0)),$preclose),20))
$psttm
$isst
Add(Constant(0.01),$pcfncfttm)
$pettm
Sub(Less(Constant(5.0),Add(Add(Log($open),Constant(5.0)),Constant(-10.0))),Mean(Sum($pettm,20),20))
Var(Add(Constant(10.0),$psttm),30)
Corr(Greater(Div($pettm,$close),$pettm),$turn,40)
Sub(Constant(5.0),Log($volume))
Mul(Constant(0.5),Sub(Add($turn,Constant(-5.0)),$pettm))
$volume
Mul(Constant(5.0),Med($low,10))
Mul(Mul(Sub(Constant(30.0),$pettm),Constant(0.5)),$pbmrq)
$preclose
Add(Abs(Sub(Constant(2.0),$volume)),Mul($vwap,Constant(1.0)))
$pcfncfttm
Sub(Div(Mul(Constant(-10.0),Abs($isst)),Constant(0.01)),Constant(-10.0))
$turn
$pcfncfttm
Sub(Constant(30.0),$amount)
Sub($turn,Constant(-10.0))
$close
$isst
$turn
$preclose
Div(Constant(5.0),$vwap)
Sub(Constant(1.0),Mul($amount,Constant(2.0)))
Add($close,$high)
$close
$psttm
Sub(Less(Abs(Add(Constant(-2.0),Add($pcfncfttm,Constant(0.01)))),Constant(-0.01)),$vwap)
Div(Sub(Constant(10.0),$pbmrq),Div($psttm,$high))
Mul(Constant(10.0),$volume)
$low
Div(Constant(-5.0),Div(Delta($close,40),$close))
Mul(Constant(5.0),$pettm)
Add(Constant(-30.0),$low)
Mul(Constant(30.0),$high)
Div(Mean(Mul(Mul(Delta($vwap,40),Constant(0.01)),Sub(Constant(5.0),$psttm)),40),Constant(0.01))
EMA($pcfncfttm,40)
Mul(Constant(-0.5),$pcfncfttm)
Sub($open,Div(Div($volume,$low),Constant(5.0)))
Div(Std(Mul(Div(Constant(10.0),$isst),Sub($psttm,$pcfncfttm)),40),$volume)
$close
Div(Constant(30.0),$high)
$pcfncfttm
$turn
Mul(Constant(0.5),$turn)
Var(Div(Constant(-10.0),$isst),40)
$preclose
$turn
Add(Constant(10.0),Min(Sub($pbmrq,Mul(Constant(-0.01),$psttm)),40))
Div(Less(Greater(Constant(1.0),Mul($psttm,Add(Constant(0.01),Div($turn,Constant(-2.0))))),$pctchg),$high)
$psttm
$pettm
Min(Sub(Constant(-2.0),Log($pcfncfttm)),20)
Var($open,50)
Div(Constant(-2.0),$pcfncfttm)
$vwap
$pctchg
$psttm
$preclose
$amount
$pcfncfttm
$vwap
Var(Div(Log(Mul(Mul(Constant(-0.01),Sub(Sub(Greater($pettm,Constant(-1.0)),$turn),Constant(-2.0))),$low)),Constant(0.5)),50)
$vwap
Sub(Constant(-2.0),Med($pettm,20))
$pettm
Abs($pbmrq)
$psttm
$pcfncfttm
Div(Constant(10.0),$psttm)
$close
Mul($psttm,$vwap)
Div(Constant(0.01),Mean(Min($volume,20),40))
Sub(Less(Constant(-2.0),$pcfncfttm),$pettm)
EMA($turn,10)
$amount
Add(Constant(-0.5),$high)
Div(Constant(5.0),Add(Max($preclose,10),Corr($pbmrq,$amount,50)))
Abs($pctchg)
Mul(Constant(-10.0),$pettm)
$high
WMA(Add($amount,$pettm),40)
$pbmrq
Add(Constant(-30.0),$amount)
Mul(Constant(-0.01),$psttm)
$high
Div($preclose,Constant(10.0))
Add(Constant(-0.01),$low)
Max(Div(Constant(1.0),$vwap),40)
$turn
Min(Mul(Constant(-0.01),$turn),50)
$pcfncfttm
$vwap
$vwap
Div(Constant(-5.0),Sub($pctchg,Constant(5.0)))
Mul($psttm,$pctchg)
Div(Div(Constant(-1.0),$pettm),Mul(Div(Constant(-30.0),$psttm),$pettm))
Sum($volume,10)
Sub(Constant(30.0),$pbmrq)
Sub(Greater(Constant(2.0),$pettm),$vwap)
Ref($preclose,10)
$volume
Div(Constant(2.0),$volume)
$vwap
Mul(Greater(Constant(-30.0),$pettm),Sub($high,$amount))
$close
Sub(Constant(-30.0),$isst)
$vwap
$pbmrq
$pbmrq
Mul(Constant(0.01),$volume)
Add(Less(Constant(-5.0),$psttm),$pcfncfttm)
$turn
Div(Min(Sub($pbmrq,Sub(Constant(-10.0),$pettm)),10),Div(Constant(30.0),Div($pcfncfttm,$volume)))
Sub(Constant(-30.0),$volume)
Sub(Constant(-0.01),$open)
Sub(Sub(Sub($preclose,$preclose),Sub(Std(Sub($pcfncfttm,Constant(-10.0)),10),Log(Log($volume)))),$volume)
$vwap
Sub(Constant(10.0),$turn)
Std($preclose,10)
$high
Div(Constant(-0.01),$preclose)
$close
$pettm
Ref($volume,40)
Div(Constant(30.0),$volume)
$isst
Sub($volume,Mul(Constant(2.0),$pcfncfttm))
$pbmrq
$volume
Std($close,40)
$high
Div(Constant(-0.01),Mul($vwap,$pettm))
Mul(Constant(5.0),$amount)
$low
Med($preclose,20)
Corr(Sub(Sub(Constant(-30.0),$volume),$close),$preclose,10)
Var(Mean($psttm,10),30)
$amount
Div(Constant(5.0),$vwap)
Sub(Constant(-0.01),$pctchg)
Div(Greater(Greater(Constant(10.0),Var($psttm,50)),$pbmrq),Mean($isst,30))
Div(Less(Constant(-0.5),$pbmrq),Med(Div($preclose,Mul(Constant(5.0),Abs($preclose))),40))
Add(Constant(30.0),$pctchg)
Sub(Constant(10.0),Std($pbmrq,40))
$pcfncfttm
$psttm
Div(Constant(-0.5),Sub($volume,Constant(0.01)))
Add(Constant(-10.0),$open)
Log(Sub(Constant(-10.0),$volume))
$close
Sub(Sub(Less(Constant(-0.01),Div($isst,Constant(-0.5))),Div(Div($pcfncfttm,$turn),Sub($vwap,Constant(0.01)))),Constant(10.0))
Add($pettm,$vwap)
Mul(Constant(-30.0),Med($high,30))
Sub(Sub(Less($pbmrq,Constant(30.0)),Abs($volume)),Add($volume,$turn))
Sub($open,Constant(10.0))
Mul($psttm,Add($high,Constant(-30.0)))
$vwap
Div(Constant(2.0),Mul($vwap,Constant(-5.0)))
$vwap
$vwap
$psttm
$turn
Sub(Constant(-0.01),$close)
Add(Constant(0.5),$volume)
Div(Constant(-2.0),$amount)
$close
Mul(Div(Sub(Constant(-5.0),Mul($volume,Constant(5.0))),Div(Cov(Sum($vwap,40),$volume,30),Constant(-0.01))),Div($preclose,$pbmrq))
Sub(Constant(0.01),$high)
Div(Greater(Constant(0.01),Mul($close,$pbmrq)),Abs($pctchg))
Sub(Constant(-0.01),Sub($pettm,$turn))
$preclose
$pctchg
$close
Sub(Add(Constant(10.0),Sub($preclose,$preclose)),Add($low,$pettm))
Div(Constant(5.0),$volume)
$pbmrq
Div(Less(Less(Constant(10.0),$high),$pbmrq),Mul($pctchg,$volume))
Div(Constant(0.01),$volume)
$high
$amount
Corr(Delta(Mul(Constant(5.0),Add($volume,Div($pcfncfttm,$psttm))),40),$pbmrq,50)
Div(Constant(2.0),Sub(Max(Div(Div($pcfncfttm,$turn),$high),40),Constant(0.01)))
Add(Constant(-2.0),$preclose)
Sub(Constant(0.01),$open)
Sub(Constant(10.0),$turn)
Mul($pctchg,Greater(Constant(-30.0),$high))
$high
Add($volume,Mul(Sub(Sub(Div($amount,$isst),Constant(-30.0)),Less($vwap,Constant(-5.0))),Constant(0.5)))
$psttm
Mul(Constant(10.0),$high)
Div($volume,$high)
Add(Constant(0.01),$volume)
Sum($low,20)
$pbmrq
Mul(Constant(30.0),$pctchg)
Sub(Constant(-0.01),$pbmrq)
$close
$amount
$turn
Log(Sub(Constant(0.5),$close))
Var(Add(Add(Constant(0.01),$amount),Constant(-2.0)),40)
Add(Constant(-30.0),$pctchg)
Mul($amount,$low)
Mul(Ref(Div(Constant(-2.0),$psttm),10),Constant(1.0))
Sub(Constant(-2.0),$vwap)
$isst
Add(Constant(2.0),$amount)
$amount
$high
$close
$isst
$close
Sub(Div(Constant(-5.0),$preclose),Add($isst,Constant(-2.0)))
$turn
$volume
Mad($psttm,20)
Div(Greater(Constant(5.0),$vwap),Mul($pcfncfttm,Sum($volume,20)))
$pcfncfttm
Sum($high,50)
$amount
Sub(Constant(-10.0),$low)
$close
Sub(Greater(Constant(-5.0),$close),$vwap)
Div(Constant(-30.0),$psttm)
$amount
Div(Less(Constant(-0.01),$close),$close)
$vwap
$pettm
Mul(Mul(Sub($open,$psttm),Constant(-0.5)),$pettm)
Sub(Constant(-30.0),$volume)
Sub(Constant(-30.0),$vwap)
Sub(Constant(-10.0),$pbmrq)
$high
Div(Constant(30.0),Abs(Sub(Sub($isst,Sub($psttm,$close)),Constant(2.0))))
Add($turn,Constant(-30.0))
Abs(Greater($pctchg,Std(Sub($vwap,$psttm),20)))
Sub(Constant(0.01),Var($close,30))
$pettm
Div(Constant(10.0),$preclose)
Sub(Constant(30.0),$pettm)
Log(Add(Constant(1.0),$close))
Sub(Constant(-0.5),$close)
Sub($turn,$pettm)
Mul($pcfncfttm,$vwap)
$close
$psttm
Var($pbmrq,50)
Div(Constant(10.0),Mul(Sub(Sub($pettm,Div(Add($pbmrq,Constant(10.0)),Div(Constant(0.01),$amount))),Constant(0.5)),Less(Constant(5.0),$high)))
Div(Constant(5.0),$pcfncfttm)
$isst
$vwap
$amount
Min($amount,10)
Std($pettm,30)
Cov(Cov(Div(Constant(-30.0),$isst),$turn,20),$pcfncfttm,30)
Div(Constant(10.0),$preclose)
$psttm
$high
Add(Constant(30.0),$preclose)
Div(Constant(5.0),$pctchg)
Sub(Constant(-0.01),$pcfncfttm)
Mean(Sub(Constant(-0.5),Mul($preclose,Constant(0.01))),30)
$volume
Mul(Sub(Constant(10.0),Sub($pcfncfttm,$high)),$pettm)
$pctchg
Sub(Constant(10.0),$pcfncfttm)
Med(Div(Mul(Constant(2.0),Div(WMA($close,20),Sub(Add(Constant(5.0),Mul($close,$high)),Constant(0.5)))),Greater(Constant(10.0),$pbmrq)),20)
$volume
Mul(Constant(-0.01),$pettm)
Mul(Constant(-1.0),$pctchg)
Div(Constant(10.0),Mul(Add(Div($turn,Constant(-0.01)),$close),Constant(0.01)))
Min(Sub(Constant(-0.01),$pettm),40)
$pctchg
Mul(Constant(0.5),Sub(Div($vwap,$pbmrq),Log(Sub($pbmrq,$psttm))))
Min($pcfncfttm,10)
Cov(Sub(Less(Constant(-30.0),$preclose),Std(WMA($preclose,30),40)),Sub($isst,$high),20)
Corr(Sub(Constant(10.0),$preclose),$low,30)
Div($close,Constant(5.0))
Div(WMA(Div(Sum(Sub(Delta($low,30),$pctchg),20),$psttm),10),Abs(Min(Corr($volume,$pettm,10),20)))
Div(Constant(0.5),$open)
Log($pettm)
Div($high,Constant(0.01))
$amount
Add(Constant(10.0),$preclose)
Sub($pbmrq,$pettm)
$isst
Mul(Constant(10.0),$psttm)
$volume
$amount
Cov(Mul(Constant(-10.0),$psttm),Var(Var(Sub(Constant(0.01),$close),50),40),10)
$close
$pctchg
$vwap
Sub(Constant(-0.01),Sub($vwap,WMA($turn,50)))
Sub(Constant(-1.0),$pbmrq)
Sub(Constant(-10.0),Div(Abs(Greater($high,$volume)),$pcfncfttm))
Add(Sub(Constant(2.0),Abs(Greater($volume,Sub(Constant(10.0),$high)))),Add(Constant(-0.01),Abs(Sub($amount,$turn))))
$amount
Mean(Med(Sub(Sub(Constant(-2.0),$pctchg),$low),40),50)
$pcfncfttm
Add(Constant(5.0),Add(Var($pctchg,10),Mul(Sub(Constant(-0.01),$high),$isst)))
$psttm
Mul($high,$pbmrq)
Add(Mul(Constant(-10.0),$open),Constant(5.0))
Mul(Constant(0.01),$pcfncfttm)
Mul(Constant(-0.01),Div($pettm,$amount))
Add(Mul(Max(WMA(Sub($pctchg,Constant(10.0)),20),40),Constant(0.5)),Less($vwap,Constant(0.01)))
Div(Constant(30.0),$volume)
$pctchg
Sub(Constant(10.0),Mul($amount,Sub($volume,$turn)))
Mul(Mul(Constant(-10.0),$amount),Constant(-30.0))
$close
$psttm
$pcfncfttm
Log(Mean(Var(Sub(Constant(0.5),Log($pcfncfttm)),40),40))
$amount
Mul(Div(Constant(0.5),$pcfncfttm),$isst)
Ref($isst,20)
Mul(Constant(-0.01),WMA($pctchg,40))
$pctchg
$pctchg
$psttm
$pbmrq
$amount
$pettm
$turn
$pcfncfttm
$turn
Sub(Constant(5.0),Std($high,40))
Mul(Log(Sub(Constant(-30.0),Delta($open,20))),Constant(-0.5))
Add(Std(Div(Constant(2.0),$pcfncfttm),40),Constant(-10.0))
$pbmrq
$vwap
Mul(Constant(1.0),$volume)
$low
Sub(Constant(2.0),Log(Mad($psttm,40)))
$amount
Div(Sub(Constant(-30.0),$pctchg),$preclose)
$vwap
Ref(Sub(Sub($close,Constant(-0.01)),Mul($volume,Constant(-30.0))),10)
Sub(Constant(1.0),$vwap)
Div(Constant(-10.0),$close)
$psttm
Log($vwap)
$pbmrq
$amount
$isst
$turn
Std(Sub(Constant(5.0),Med($amount,40)),30)
Add(Ref(Mul(Constant(5.0),$pcfncfttm),30),Div($amount,$pcfncfttm))
$vwap
$pettm
$isst
Abs(Div(Greater($pctchg,Constant(-2.0)),$volume))
Cov($vwap,$volume,10)
Mul($psttm,Constant(1.0))
Sub(Mean(Mul(Corr(Div(Div(Constant(-10.0),$close),Sub(Greater($vwap,$vwap),Constant(0.5))),$close,20),Constant(10.0)),50),Constant(-2.0))
Div(Constant(-0.01),$open)
$preclose
$close
Div(Constant(10.0),$pcfncfttm)
Div(Constant(-0.01),$open)
Div(Med(Abs($volume),20),Mul(Constant(-0.01),$isst))
Abs(Add($pbmrq,$volume))
$pcfncfttm
$vwap
$amount
Sub(Constant(10.0),Var(Mul(Mul($vwap,Constant(10.0)),$turn),50))
Var(Div(Log(Add($high,Add(Sub(Add($pcfncfttm,$turn),Sub(Log(Mul($turn,$preclose)),Constant(0.5))),Constant(10.0)))),Constant(-10.0)),20)
Div(Constant(0.5),Sub(Greater(Mad($vwap,40),Constant(30.0)),$amount))
$open
Mul($psttm,Constant(2.0))
Mul(Constant(10.0),Abs(WMA($vwap,30)))
Div($psttm,$pbmrq)
$pbmrq
Less(Div(Constant(-10.0),Delta($turn,40)),$amount)
Div($high,Constant(0.01))
$pbmrq
$psttm
$close
$turn
$vwap
$pcfncfttm
$psttm
Div(Constant(-1.0),$amount)
$vwap
$vwap
$pettm
$volume
Mad($preclose,10)
Sub(Sub(Constant(10.0),Div(Log($pettm),Mad(Less(Sub(Constant(-0.01),$pcfncfttm),$vwap),10))),$open)
Sub(Div(Constant(0.01),Corr($close,Sub($pcfncfttm,$psttm),20)),Constant(0.01))
Log(Div(Constant(-0.01),$pbmrq))
Add(Sub(Constant(30.0),Corr($high,$pettm,20)),Sub(Sub(Var($high,40),$close),$isst))
Sub($preclose,$low)
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104100431/28672_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.269       |
|    eval_cnt             | 1286        |
|    significant          | 200         |
|    size                 | 200         |
| rollout/                |             |
|    ep_len_mean          | 4.86        |
|    ep_rew_mean          | 0.247       |
| test/                   |             |
|    ic                   | 0.0609      |
|    rank_ic              | 0.0523      |
| time/                   |             |
|    fps                  | 2           |
|    iterations           | 14          |
|    time_elapsed         | 11869       |
|    total_timesteps      | 28672       |
| train/                  |             |
|    approx_kl            | 0.019132026 |
|    clip_fraction        | 0.235       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.6        |
|    explained_variance   | 7.15e-07    |
|    learning_rate        | 0.001       |
|    loss                 | -0.237      |
|    n_updates            | 130         |
|    policy_gradient_loss | -0.0227     |
|    value_loss           | 0.0612      |
-----------------------------------------
Mul(Mul(Constant(5.0),Sub($psttm,Div($amount,$psttm))),Delta($pbmrq,40))
$pbmrq
$volume
Var(Div(Add(Constant(-0.01),Sub(Add($close,Constant(1.0)),Constant(2.0))),$vwap),20)
Abs(Mul(Constant(0.01),$volume))
Div(Constant(-2.0),$pcfncfttm)
Div(Constant(-0.01),$isst)
$pcfncfttm
$volume
$pbmrq
Div(Constant(10.0),$psttm)
Div(Constant(2.0),$pettm)
$psttm
Div(Constant(-10.0),$turn)
$vwap
$close
$isst
$high
Sub(Constant(0.01),$pcfncfttm)
$psttm
Mul(Greater(Delta($close,40),Constant(-0.01)),Sub($open,$isst))
Sub(Constant(-0.5),Div($high,$amount))
Div(Constant(-10.0),$vwap)
Abs($preclose)
$pcfncfttm
$close
$pbmrq
Div(Constant(-0.5),$pcfncfttm)
$isst
Div(Div(Constant(-5.0),Min($pettm,20)),Constant(30.0))
$vwap
Sub(Constant(-1.0),$vwap)
$psttm
$pettm
Sub(Div(Constant(10.0),$pettm),Constant(10.0))
Sub($vwap,Constant(-2.0))
Add(Constant(0.01),$psttm)
Add(Constant(2.0),Div($amount,Div($open,Constant(10.0))))
$volume
$pbmrq
Add(Constant(30.0),$pbmrq)
Div($vwap,Add($pettm,$psttm))
Min(Med(Sub(Constant(-0.01),Add($high,$volume)),50),20)
Add(Greater(Constant(1.0),$pbmrq),Delta(WMA($vwap,50),20))
$isst
$psttm
$low
$vwap
$preclose
$pettm
$pettm
Mul($high,Div(Constant(0.01),$preclose))
Div(Sub(Add($amount,Constant(-0.01)),$isst),$psttm)
Mul(Constant(30.0),$pcfncfttm)
$pbmrq
$vwap
Abs(Mul(Sub(Constant(0.01),$isst),$turn))
Div(WMA($close,10),$turn)
Div(Constant(0.01),Div($pcfncfttm,Constant(-0.5)))
Med($pcfncfttm,40)
Div(Mul(Med(Med($isst,10),20),$high),Constant(-2.0))
$volume
Add(Constant(0.01),$pcfncfttm)
$pcfncfttm
$preclose
Std($low,20)
WMA(Mul(Constant(1.0),$volume),20)
$vwap
Sub(Div(Constant(2.0),$vwap),Constant(-30.0))
$volume
$high
Var($preclose,50)
$volume
$close
Sum($preclose,20)
WMA($isst,40)
Std($high,30)
$preclose
Mul($vwap,$volume)
$volume
$turn
$pcfncfttm
$turn
Mul($volume,$volume)
Std(Corr($high,Mul(Constant(-30.0),Mul($open,$psttm)),40),20)
$pcfncfttm
Mul(Constant(-5.0),$pbmrq)
Sub(Constant(0.01),$vwap)
Abs(Log($vwap))
Mul($vwap,$pbmrq)
Div(Constant(-2.0),$amount)
Div(Constant(5.0),$volume)
Add(Constant(-0.01),$amount)
Log($vwap)
$open
$isst
Log($close)
$isst
Add($amount,Mul(Log(Sub($open,Constant(1.0))),Constant(-0.5)))
$vwap
Div(Constant(-30.0),$turn)
Sub(Constant(-0.01),$open)
Var($volume,40)
Log(Mul(Constant(5.0),$vwap))
Div(Greater(Constant(-30.0),$volume),Std($volume,40))
Sub(Greater(Constant(-2.0),$high),$pctchg)
$low
Add(Greater(Constant(5.0),Min($vwap,10)),$pctchg)
$turn
$open
Div($psttm,Add($pbmrq,$volume))
$isst
$pettm
EMA($isst,50)
Div(Constant(0.5),Mul(Corr($high,$high,10),Div(Div($vwap,Constant(-10.0)),$isst)))
Mean(Greater($isst,$isst),20)
$pettm
Div(Constant(-10.0),$preclose)
$pettm
Less($psttm,$vwap)
$pbmrq
Mul(Less(Sub(Constant(-10.0),$high),Constant(30.0)),$pbmrq)
$psttm
Cov($isst,$vwap,40)
$isst
$volume
Abs(Div(Less(Constant(0.01),$amount),$pbmrq))
$high
$volume
$high
Sub(Constant(-0.01),$isst)
Div(Greater(Constant(5.0),$pcfncfttm),$preclose)
Div($psttm,$high)
Div(Constant(30.0),$psttm)
Sum(Add(Mul(Constant(10.0),Sub(Var($volume,50),Constant(-10.0))),Constant(-0.01)),20)
Mul(Add(Div(Constant(-30.0),$volume),Constant(5.0)),$vwap)
Div(Add($high,$volume),Div($high,$pcfncfttm))
$volume
$isst
$pcfncfttm
Div(Constant(-0.01),$pctchg)
Mul(Constant(0.5),$amount)
Sub(Constant(-10.0),$isst)
Sub(Abs(WMA($pcfncfttm,10)),Greater(Constant(-2.0),$pbmrq))
Add(Constant(-30.0),$pctchg)
Less($volume,$pcfncfttm)
$turn
Mul(Var(Add(Div(Constant(-30.0),$low),$close),40),Constant(5.0))
Sub(Add(Constant(0.01),Sub(Div($isst,Abs($high)),$vwap)),Mul(Constant(30.0),$psttm))
$volume
$low
$volume
Div(Constant(5.0),$vwap)
Sub(Div(Greater($turn,Constant(1.0)),$vwap),Sub($pettm,$volume))
Mul($volume,$turn)
Sub(Constant(-30.0),$vwap)
Add($pcfncfttm,$pettm)
$vwap
$pcfncfttm
$vwap
Ref($amount,40)
Abs(Add(Constant(-0.01),$volume))
Sub($psttm,Constant(-2.0))
$pcfncfttm
$amount
$psttm
Mul(Less(Constant(-0.5),$pcfncfttm),Div($high,Abs($high)))
$turn
$isst
$pcfncfttm
Add(Div(Constant(5.0),$isst),Constant(-0.5))
$pettm
Mean($pctchg,20)
Cov(Div(Constant(10.0),$vwap),Div(Abs(Add(Constant(0.01),Div(Div(Ref($vwap,20),Div($volume,Constant(-0.01))),Constant(30.0)))),Constant(10.0)),40)
$isst
Var($pettm,40)
Div(Constant(30.0),Sum(Sub(Corr($psttm,Log($amount),10),$pctchg),20))
$turn
Ref(Mul(Constant(0.01),Log(Mean($pcfncfttm,50))),20)
Sub(Constant(-2.0),Div(Mul($vwap,$close),$volume))
$close
Greater($high,$high)
Sub(Constant(-10.0),$pbmrq)
$pctchg
$volume
Add(Constant(30.0),Less($preclose,Sub($vwap,$psttm)))
$psttm
$preclose
Mul(Greater(Constant(30.0),$volume),$pcfncfttm)
Add(Less(Constant(-10.0),$vwap),$amount)
Mul($vwap,$pbmrq)
$pbmrq
Add(Log(Mul(Constant(-10.0),Mean($turn,40))),$pcfncfttm)
Mean(Sum($high,20),30)
Sub(Constant(-10.0),Log($isst))
Add(Less(Constant(10.0),$pbmrq),Std(Div(Add($open,$pettm),$isst),30))
$vwap
Div(Constant(0.01),$high)
WMA(Sub(Constant(-1.0),Add($vwap,$volume)),10)
$open
$open
$pcfncfttm
Corr($pettm,$pctchg,50)
Less($open,Log($preclose))
Div(Div(Log(Add(Constant(0.01),$vwap)),Constant(-5.0)),Sub($preclose,$high))
$low
Div(Div($pbmrq,Abs($volume)),Constant(10.0))
Mean($isst,10)
$amount
$volume
$vwap
$pcfncfttm
$vwap
Div(Greater(Constant(30.0),Div($isst,$pcfncfttm)),Corr(Log(Div($open,$low)),$vwap,40))
$isst
$turn
Med(Sum($psttm,20),40)
Abs($pettm)
Greater(Div($high,$turn),Abs($amount))
$low
Mul(Constant(10.0),Std($pettm,40))
$isst
$isst
Mul(Constant(10.0),$open)
Sub(Constant(0.01),Sum($pctchg,10))
Sub(Constant(5.0),Mul($low,Constant(30.0)))
Mul($pettm,Constant(-0.01))
$pettm
Div(Constant(10.0),$preclose)
Var(Var($vwap,20),10)
$amount
$pcfncfttm
$pctchg
Add(Constant(-2.0),$close)
Add(Constant(5.0),Add($preclose,Constant(10.0)))
$volume
Greater($volume,$pettm)
Mul(Constant(-10.0),Var(Min($pettm,20),40))
Sub($pettm,Constant(-1.0))
Div($close,Constant(-2.0))
$vwap
Std(Mul(Constant(-0.01),$turn),50)
Div(Constant(-0.01),Mean($amount,40))
$volume
$psttm
Log($open)
Div(Constant(-10.0),$psttm)
Div(Sub(Greater(Constant(-30.0),$volume),$isst),Constant(2.0))
Delta(Add(Constant(0.01),$vwap),40)
$volume
Med(Sub(Add(Constant(5.0),$pbmrq),Div(Std($isst,30),Sub(WMA(Sub($pbmrq,Div($volume,Constant(-2.0))),20),$turn))),30)
$close
$isst
Div(Constant(5.0),$open)
$vwap
Div(Div($high,$pbmrq),Add(Sub(Add(Less(Mul($pctchg,Constant(0.01)),Constant(-2.0)),$psttm),Constant(30.0)),Abs(Add(Constant(0.5),Abs($volume)))))
$close
$open
Var($psttm,10)
Mul($preclose,Sub($psttm,$preclose))
Div(Constant(-10.0),$isst)
$pcfncfttm
Add(Div($isst,Constant(-2.0)),$amount)
Sub(Constant(10.0),Abs($vwap))
$pcfncfttm
Div(Constant(10.0),$high)
WMA(Div($amount,$pcfncfttm),30)
Div(Constant(-0.01),$high)
Corr(Div(Greater(Constant(-10.0),Mul($psttm,Sub($isst,$amount))),$pettm),$pettm,10)
Mean(Div($close,Constant(-30.0)),20)
Sub($isst,Add($pettm,Constant(5.0)))
Log(Sub(Constant(0.01),$psttm))
$pbmrq
$volume
$amount
$vwap
Div(Less(Constant(10.0),Sub($high,Constant(5.0))),$pettm)
$turn
Div(Log(Mean(Div(Constant(-10.0),Sub(Greater($preclose,Constant(-2.0)),Div($preclose,$close))),20)),Constant(5.0))
Mul(Constant(0.01),Div($turn,$high))
$close
$pcfncfttm
$high
$turn
Log(Cov($turn,Sub(Mul(Corr($turn,$turn,40),Constant(2.0)),Constant(1.0)),30))
$high
Med($pettm,20)
Div(Constant(1.0),Ref(Mul($pctchg,$low),30))
Sub(Constant(-30.0),Mul($low,Constant(0.01)))
Abs($psttm)
Div(Constant(5.0),Div(Var($psttm,40),Log($isst)))
Div(Constant(-10.0),Mul(Mean($vwap,50),$vwap))
Sub(Greater(Mul($psttm,$preclose),Constant(5.0)),$turn)
Add(Mul(Constant(2.0),$volume),$pctchg)
Sub(Constant(-10.0),$pettm)
Div(Constant(-0.01),Std(Div(Sub(Log($low),Less(Delta($low,10),$volume)),Var(Sub(Constant(5.0),Abs($isst)),20)),40))
$isst
Sum($turn,50)
Greater(Sub(Constant(30.0),$isst),Ref(Sub(Constant(-5.0),$preclose),50))
Mul(Constant(30.0),$volume)
Div($vwap,Mul(Constant(-30.0),$psttm))
Div(Constant(-2.0),Abs($amount))
Sub(Constant(5.0),$pettm)
Div($pcfncfttm,$low)
Mul(Constant(-1.0),$pettm)
Add(Constant(-5.0),$isst)
Div($low,Constant(-0.5))
$pbmrq
Mul(Constant(30.0),$isst)
Div($low,Add($pbmrq,$turn))
Div($high,$vwap)
$volume
$close
$close
$pctchg
$psttm
$preclose
$pbmrq
Add(Div(Constant(-0.01),$pettm),Constant(-2.0))
Abs(Add(Greater(Constant(10.0),$low),Abs($psttm)))
$pettm
Div(Constant(5.0),Cov($pbmrq,Mul($volume,$isst),30))
$low
$amount
Less($high,$pbmrq)
Mul(Constant(-0.01),$psttm)
Sub(Sub(Sub(Constant(-5.0),$volume),Div($pctchg,$low)),$preclose)
Sub($pbmrq,$high)
Sub(Greater(Constant(-0.01),Mul($vwap,$psttm)),$pcfncfttm)
Div(Constant(0.01),$pbmrq)
$pbmrq
Corr($vwap,$amount,30)
Sub(Constant(1.0),$pcfncfttm)
Add(Constant(0.01),$amount)
$pettm
$psttm
Div(Sub(Constant(0.01),$close),$vwap)
Std(Mul(Constant(-0.01),$low),40)
Std(Mul(Greater(Constant(-30.0),$high),$volume),40)
Sub(Constant(30.0),Log($pettm))
Sub(Sub(Constant(10.0),Mean($volume,20)),$volume)
Sub(Constant(-5.0),$turn)
$pctchg
Div(Sum(Sub(Constant(-10.0),Sub(WMA($pettm,50),$pcfncfttm)),40),Constant(-5.0))
Sub(Constant(1.0),$pbmrq)
$psttm
$preclose
Std($open,10)
Sub(Constant(5.0),Abs(Less($pettm,$volume)))
$pbmrq
Sub(Constant(-0.01),$volume)
$high
Less($vwap,Mul($turn,Sub($psttm,$pbmrq)))
Greater($pcfncfttm,$preclose)
Abs(Sub($low,Mul(Constant(5.0),Mul($preclose,Constant(0.01)))))
$amount
Mul($psttm,Mad($pettm,10))
$vwap
$pcfncfttm
Sub(Constant(30.0),$isst)
$isst
$volume
$volume
$low
Add(Constant(-0.01),$pctchg)
Mul(Constant(5.0),$close)
Div(Constant(5.0),Min($isst,40))
Div(Constant(10.0),Div($isst,$isst))
$amount
Sub(Constant(0.01),Div($volume,Div(Constant(-1.0),$amount)))
Div(Add(Constant(-0.01),Div($high,Constant(-5.0))),Ref(Mul(Div($pctchg,Constant(-5.0)),Greater($pettm,Constant(2.0))),30))
Add(Greater(Constant(-0.01),$volume),$high)
Min(Div(Constant(10.0),Add($vwap,$pettm)),30)
$vwap
$volume
Mul(Greater($close,Constant(5.0)),$isst)
Sub(Constant(10.0),$close)
$vwap
$vwap
$low
$isst
Mul($pettm,$pettm)
$high
Add(Less(Constant(10.0),Div(Min(Var(Var($psttm,40),40),10),$open)),$vwap)
$isst
$pettm
$pcfncfttm
$pctchg
Cov($pbmrq,$open,30)
$pbmrq
$isst
$psttm
Log($isst)
Sub(Constant(10.0),$close)
Add(Constant(-10.0),Mean($pbmrq,10))
$pettm
$volume
Div(Constant(5.0),$pettm)
$close
$vwap
$pcfncfttm
Div($psttm,$isst)
Add(Delta($isst,10),Constant(-10.0))
Min(Div(Greater(Sub(Constant(-5.0),Div($vwap,Constant(0.5))),Constant(2.0)),$volume),40)
$pettm
Div(Less(Constant(-5.0),$turn),Min($volume,40))
$volume
$close
Mean(Sub(Mul(Constant(0.5),$high),Log(Sub($pettm,$pbmrq))),40)
Less(Div(Constant(0.01),$close),$pbmrq)
Div(Constant(-0.5),$pbmrq)
$psttm
Sub(Constant(30.0),$vwap)
$pcfncfttm
$volume
Mul(Constant(0.01),Abs($volume))
$psttm
$pettm
$pettm
Sub(Constant(1.0),Sub($high,WMA(Sub(Constant(-0.01),$vwap),40)))
Sub(Add($vwap,Constant(30.0)),Constant(0.01))
$low
Div(Constant(30.0),Less($volume,$isst))
$vwap
Add($vwap,Sub(Sub(Sub($vwap,$low),$turn),Constant(-0.01)))
$pbmrq
$psttm
$volume
$volume
Max(Div(Constant(10.0),$pettm),40)
$pctchg
$isst
Sub(Constant(-5.0),Add(Mad($high,20),$low))
$vwap
Div(Mul(Sub(Constant(10.0),$pettm),Constant(-5.0)),Constant(0.5))
$high
$amount
$isst
$pcfncfttm
Div(Mul($preclose,$psttm),$open)
Sub($volume,Constant(1.0))
Div(Constant(0.5),Sub($pettm,Constant(-30.0)))
Add(Constant(-5.0),$vwap)
$pbmrq
Med(Sub(Constant(-0.01),$amount),20)
Corr(Mean($volume,40),$volume,30)
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104100431/30720_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.283       |
|    eval_cnt             | 1701        |
|    significant          | 200         |
|    size                 | 200         |
| rollout/                |             |
|    ep_len_mean          | 4.07        |
|    ep_rew_mean          | 0.272       |
| test/                   |             |
|    ic                   | 0.0598      |
|    rank_ic              | 0.0478      |
| time/                   |             |
|    fps                  | 2           |
|    iterations           | 15          |
|    time_elapsed         | 15245       |
|    total_timesteps      | 30720       |
| train/                  |             |
|    approx_kl            | 0.027416244 |
|    clip_fraction        | 0.308       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.63       |
|    explained_variance   | -3.22e-06   |
|    learning_rate        | 0.001       |
|    loss                 | -0.27       |
|    n_updates            | 140         |
|    policy_gradient_loss | -0.0158     |
|    value_loss           | 0.00853     |
-----------------------------------------
