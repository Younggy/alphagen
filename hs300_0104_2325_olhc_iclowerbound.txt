[75248:MainThread](2024-01-04 23:26:19,711) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[75248:MainThread](2024-01-04 23:26:19,989) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[75248:MainThread](2024-01-04 23:26:19,990) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/Users/yangguangyu/.qlib/qlib_data/cn_data_rolling')}
instruments: hs300
raw df:                             $open      $close  ...       $volume       $vwap
datetime   instrument                          ...                          
2014-08-06 SH600000     36.678059   36.342247  ...  3.605535e+07   36.323227
           SH600009     15.457175   15.367242  ...  8.106222e+06   15.345646
           SH600010      4.297257    4.641038  ...  2.718216e+08    4.527487
           SH600011      7.163883    7.211963  ...  1.499561e+07    7.187034
           SH600015     12.955123   13.058764  ...  2.845987e+07   12.957579
...                           ...         ...  ...           ...         ...
2019-02-19 SZ300661    107.945366  107.527779  ...  4.550401e+05  107.080376
           SZ300750     84.660004   82.290001  ...  9.425786e+06   82.973038
           SZ300751    174.140717  175.225296  ...  1.107769e+06  177.069061
           SZ300759     31.355343   31.355343  ...  6.096700e+05   31.355343
           SZ300760    114.797508  115.075615  ...  4.319464e+06  116.721550

[251929 rows x 6 columns]
preprocessed df:                             $open      $close  ...       $volume       $vwap
datetime   instrument                          ...                          
2014-08-06 SH600000     36.678059   36.342247  ...  3.605535e+07   36.323227
           SH600009     15.457175   15.367242  ...  8.106222e+06   15.345646
           SH600010      4.297257    4.641038  ...  2.718216e+08    4.527487
           SH600011      7.163883    7.211963  ...  1.499561e+07    7.187034
           SH600015     12.955123   13.058764  ...  2.845987e+07   12.957579
...                           ...         ...  ...           ...         ...
2019-02-19 SZ300661    107.945366  107.527779  ...  4.550401e+05  107.080376
           SZ300750     84.660004   82.290001  ...  9.425786e+06   82.973038
           SZ300751    174.140717  175.225296  ...  1.107769e+06  177.069061
           SZ300759     31.355343   31.355343  ...  6.096700e+05   31.355343
           SZ300760    114.797508  115.075615  ...  4.319464e+06  116.721550

[251929 rows x 6 columns]
df after stack: instrument              SH600000      SH600009  ...       SZ300759      SZ300760
datetime                                        ...                             
2014-08-06 $open    3.667806e+01  1.545718e+01  ...            NaN           NaN
           $close   3.634225e+01  1.536724e+01  ...            NaN           NaN
           $high    3.667806e+01  1.545718e+01  ...            NaN           NaN
           $low     3.604375e+01  1.523234e+01  ...            NaN           NaN
           $volume  3.605535e+07  8.106222e+06  ...            NaN           NaN
...                          ...           ...  ...            ...           ...
2019-02-19 $close   6.353659e+01  6.572910e+01  ...      31.355343  1.150756e+02
           $high    6.447787e+01  6.724870e+01  ...      31.355343  1.194855e+02
           $low     6.341893e+01  6.418536e+01  ...      31.355343  1.146982e+02
           $volume  4.411468e+06  7.203972e+06  ...  609670.000000  4.319464e+06
           $vwap    6.380305e+01  6.596772e+01  ...      31.355343  1.167215e+02

[6630 rows x 254 columns]
features: ['$open', '$close', '$high', '$low', '$volume', '$vwap']
dates: DatetimeIndex(['2014-08-06', '2014-08-07', '2014-08-08', '2014-08-11',
               '2014-08-12', '2014-08-13', '2014-08-14', '2014-08-15',
               '2014-08-18', '2014-08-19',
               ...
               '2019-01-30', '2019-01-31', '2019-02-01', '2019-02-11',
               '2019-02-12', '2019-02-13', '2019-02-14', '2019-02-15',
               '2019-02-18', '2019-02-19'],
              dtype='datetime64[ns]', name='datetime', length=1105, freq=None)
stock ids: Index(['SH600000', 'SH600009', 'SH600010', 'SH600011', 'SH600015', 'SH600016',
       'SH600018', 'SH600019', 'SH600023', 'SH600025',
       ...
       'SZ300450', 'SZ300454', 'SZ300496', 'SZ300498', 'SZ300628', 'SZ300661',
       'SZ300750', 'SZ300751', 'SZ300759', 'SZ300760'],
      dtype='object', name='instrument', length=254)
values: [[[3.66780586e+01 1.54571753e+01 4.29725742e+00 ...            nan
              nan            nan]
  [3.63422470e+01 1.53672419e+01 4.64103794e+00 ...            nan
              nan            nan]
  [3.66780586e+01 1.54571753e+01 4.75226116e+00 ...            nan
              nan            nan]
  [3.60437469e+01 1.52323427e+01 4.23659039e+00 ...            nan
              nan            nan]
  [3.60553480e+07 8.10622250e+06 2.71821600e+08 ...            nan
              nan            nan]
  [3.63232269e+01 1.53456459e+01 4.52748728e+00 ...            nan
              nan            nan]]

 [[3.63795586e+01 1.53784838e+01 4.99492979e+00 ...            nan
              nan            nan]
  [3.56706238e+01 1.52323427e+01 5.10615301e+00 ...            nan
              nan            nan]
  [3.64914970e+01 1.54234505e+01 5.10615301e+00 ...            nan
              nan            nan]
  [3.56333122e+01 1.51761351e+01 4.86348438e+00 ...            nan
              nan            nan]
  [3.78545280e+07 7.98603650e+06 5.90331968e+08 ...            nan
              nan            nan]
  [3.60145264e+01 1.53051205e+01 5.05102587e+00 ...            nan
              nan            nan]]

 [[3.56706238e+01 1.52211018e+01 4.95448494e+00 ...            nan
              nan            nan]
  [3.55959969e+01 1.52773094e+01 4.93426275e+00 ...            nan
              nan            nan]
  [3.58198738e+01 1.53335171e+01 5.02526331e+00 ...            nan
              nan            nan]
  [3.54467506e+01 1.52098598e+01 4.84326172e+00 ...            nan
              nan            nan]
  [3.24243060e+07 4.30498250e+06 3.79554208e+08 ...            nan
              nan            nan]
  [3.56202278e+01 1.52888603e+01 4.92674780e+00 ...            nan
              nan            nan]]

 ...

 [[6.34189339e+01 6.41853638e+01 4.41548395e+00 ... 1.70946655e+02
   2.59117756e+01 1.14430016e+02]
  [6.27129707e+01 6.27140007e+01 4.35887527e+00 ... 1.69155594e+02
   2.59117756e+01 1.12383957e+02]
  [6.38307419e+01 6.51140137e+01 4.41548395e+00 ... 1.75135742e+02
   2.59117756e+01 1.14867035e+02]
  [6.27129707e+01 6.24245529e+01 4.35887527e+00 ... 1.69155594e+02
   2.59117756e+01 1.11937004e+02]
  [3.01865300e+06 6.45415250e+06 5.86176800e+07 ... 8.42015375e+05
   4.17545719e+05 2.59575975e+06]
  [6.32601509e+01 6.30350151e+01 4.38394499e+00 ... 1.71651810e+02
   2.59117756e+01 1.12644287e+02]]

 [[6.32424431e+01 6.35341072e+01 4.38717937e+00 ... 1.68737686e+02
   2.85039501e+01 1.12413757e+02]
  [6.37719116e+01 6.41853638e+01 4.47209263e+00 ... 1.72140701e+02
   2.85039501e+01 1.14281029e+02]
  [6.39484024e+01 6.48607483e+01 4.47209263e+00 ... 1.73901901e+02
   2.85039501e+01 1.14966354e+02]
  [6.29482918e+01 6.35341072e+01 4.35887527e+00 ... 1.67056076e+02
   2.85039501e+01 1.12413757e+02]
  [3.41699100e+06 7.42890550e+06 1.05033320e+08 ... 7.30241188e+05
   3.87979750e+05 3.52829000e+06]
  [6.36879501e+01 6.40566711e+01 4.42524385e+00 ... 1.70564102e+02
   2.85039501e+01 1.13745903e+02]]

 [[6.38307419e+01 6.44989395e+01 4.44378853e+00 ... 1.74140717e+02
   3.13553429e+01 1.14797508e+02]
  [6.35365944e+01 6.57290955e+01 4.47209263e+00 ... 1.75225296e+02
   3.13553429e+01 1.15075615e+02]
  [6.44778748e+01 6.72487030e+01 4.55700588e+00 ... 1.82747742e+02
   3.13553429e+01 1.19485550e+02]
  [6.34189339e+01 6.41853638e+01 4.41548395e+00 ... 1.72359604e+02
   3.13553429e+01 1.14698181e+02]
  [4.41146800e+06 7.20397150e+06 1.27855160e+08 ... 1.10776938e+06
   6.09670000e+05 4.31946450e+06]
  [6.38030548e+01 6.59677200e+01 4.48601103e+00 ... 1.77069061e+02
   3.13553429e+01 1.16721550e+02]]], (1105, 6, 254)
train data: tensor([[[3.6678e+01, 1.5457e+01, 4.2973e+00,  ...,        nan,
                 nan,        nan],
         [3.6342e+01, 1.5367e+01, 4.6410e+00,  ...,        nan,
                 nan,        nan],
         [3.6678e+01, 1.5457e+01, 4.7523e+00,  ...,        nan,
                 nan,        nan],
         [3.6044e+01, 1.5232e+01, 4.2366e+00,  ...,        nan,
                 nan,        nan],
         [3.6055e+07, 8.1062e+06, 2.7182e+08,  ...,        nan,
                 nan,        nan],
         [3.6323e+01, 1.5346e+01, 4.5275e+00,  ...,        nan,
                 nan,        nan]],

        [[3.6380e+01, 1.5378e+01, 4.9949e+00,  ...,        nan,
                 nan,        nan],
         [3.5671e+01, 1.5232e+01, 5.1062e+00,  ...,        nan,
                 nan,        nan],
         [3.6491e+01, 1.5423e+01, 5.1062e+00,  ...,        nan,
                 nan,        nan],
         [3.5633e+01, 1.5176e+01, 4.8635e+00,  ...,        nan,
                 nan,        nan],
         [3.7855e+07, 7.9860e+06, 5.9033e+08,  ...,        nan,
                 nan,        nan],
         [3.6015e+01, 1.5305e+01, 5.0510e+00,  ...,        nan,
                 nan,        nan]],

        [[3.5671e+01, 1.5221e+01, 4.9545e+00,  ...,        nan,
                 nan,        nan],
         [3.5596e+01, 1.5277e+01, 4.9343e+00,  ...,        nan,
                 nan,        nan],
         [3.5820e+01, 1.5334e+01, 5.0253e+00,  ...,        nan,
                 nan,        nan],
         [3.5447e+01, 1.5210e+01, 4.8433e+00,  ...,        nan,
                 nan,        nan],
         [3.2424e+07, 4.3050e+06, 3.7955e+08,  ...,        nan,
                 nan,        nan],
         [3.5620e+01, 1.5289e+01, 4.9267e+00,  ...,        nan,
                 nan,        nan]],

        ...,

        [[6.3419e+01, 6.4185e+01, 4.4155e+00,  ..., 1.7095e+02,
          2.5912e+01, 1.1443e+02],
         [6.2713e+01, 6.2714e+01, 4.3589e+00,  ..., 1.6916e+02,
          2.5912e+01, 1.1238e+02],
         [6.3831e+01, 6.5114e+01, 4.4155e+00,  ..., 1.7514e+02,
          2.5912e+01, 1.1487e+02],
         [6.2713e+01, 6.2425e+01, 4.3589e+00,  ..., 1.6916e+02,
          2.5912e+01, 1.1194e+02],
         [3.0187e+06, 6.4542e+06, 5.8618e+07,  ..., 8.4202e+05,
          4.1755e+05, 2.5958e+06],
         [6.3260e+01, 6.3035e+01, 4.3839e+00,  ..., 1.7165e+02,
          2.5912e+01, 1.1264e+02]],

        [[6.3242e+01, 6.3534e+01, 4.3872e+00,  ..., 1.6874e+02,
          2.8504e+01, 1.1241e+02],
         [6.3772e+01, 6.4185e+01, 4.4721e+00,  ..., 1.7214e+02,
          2.8504e+01, 1.1428e+02],
         [6.3948e+01, 6.4861e+01, 4.4721e+00,  ..., 1.7390e+02,
          2.8504e+01, 1.1497e+02],
         [6.2948e+01, 6.3534e+01, 4.3589e+00,  ..., 1.6706e+02,
          2.8504e+01, 1.1241e+02],
         [3.4170e+06, 7.4289e+06, 1.0503e+08,  ..., 7.3024e+05,
          3.8798e+05, 3.5283e+06],
         [6.3688e+01, 6.4057e+01, 4.4252e+00,  ..., 1.7056e+02,
          2.8504e+01, 1.1375e+02]],

        [[6.3831e+01, 6.4499e+01, 4.4438e+00,  ..., 1.7414e+02,
          3.1355e+01, 1.1480e+02],
         [6.3537e+01, 6.5729e+01, 4.4721e+00,  ..., 1.7523e+02,
          3.1355e+01, 1.1508e+02],
         [6.4478e+01, 6.7249e+01, 4.5570e+00,  ..., 1.8275e+02,
          3.1355e+01, 1.1949e+02],
         [6.3419e+01, 6.4185e+01, 4.4155e+00,  ..., 1.7236e+02,
          3.1355e+01, 1.1470e+02],
         [4.4115e+06, 7.2040e+06, 1.2786e+08,  ..., 1.1078e+06,
          6.0967e+05, 4.3195e+06],
         [6.3803e+01, 6.5968e+01, 4.4860e+00,  ..., 1.7707e+02,
          3.1355e+01, 1.1672e+02]]]), torch.Size([1105, 6, 254])
instruments: hs300
raw df:                             $open      $close  ...     $volume       $vwap
datetime   instrument                          ...                        
2018-08-03 SH600000     57.594746   57.830067  ...   2889323.0   58.154427
           SH600009     74.151337   71.261703  ...   6064585.0   72.178673
           SH600010      4.528701    4.472093  ...  61401496.0    4.536499
           SH600011     10.894892   10.532657  ...  19608424.0   10.665854
           SH600015     17.312105   17.288551  ...   4233261.0   17.361689
...                           ...         ...  ...         ...         ...
2020-02-20 SZ300751    210.300003  221.039993  ...   1437932.0  216.365356
           SZ300759     62.450001   61.599998  ...   4543989.0   61.126060
           SZ300760    234.800003  234.990005  ...   4846309.0  235.004715
           SZ300763     76.010002   81.680000  ...   5394940.0   77.036125
           SZ300782    511.200012  551.090027  ...   1673598.0  540.987549

[95573 rows x 6 columns]
preprocessed df:                             $open      $close  ...     $volume       $vwap
datetime   instrument                          ...                        
2018-08-03 SH600000     57.594746   57.830067  ...   2889323.0   58.154427
           SH600009     74.151337   71.261703  ...   6064585.0   72.178673
           SH600010      4.528701    4.472093  ...  61401496.0    4.536499
           SH600011     10.894892   10.532657  ...  19608424.0   10.665854
           SH600015     17.312105   17.288551  ...   4233261.0   17.361689
...                           ...         ...  ...         ...         ...
2020-02-20 SZ300751    210.300003  221.039993  ...   1437932.0  216.365356
           SZ300759     62.450001   61.599998  ...   4543989.0   61.126060
           SZ300760    234.800003  234.990005  ...   4846309.0  235.004715
           SZ300763     76.010002   81.680000  ...   5394940.0   77.036125
           SZ300782    511.200012  551.090027  ...   1673598.0  540.987549

[95573 rows x 6 columns]
df after stack: instrument              SH600000      SH600009  ...      SZ300763      SZ300782
datetime                                        ...                            
2018-08-03 $open    5.759475e+01  7.415134e+01  ...           NaN           NaN
           $close   5.783007e+01  7.126170e+01  ...           NaN           NaN
           $high    5.871252e+01  7.482001e+01  ...           NaN           NaN
           $low     5.741825e+01  7.104678e+01  ...           NaN           NaN
           $volume  2.889323e+06  6.064585e+06  ...           NaN           NaN
...                          ...           ...  ...           ...           ...
2020-02-20 $close   6.811988e+01  8.970219e+01  ...  8.168000e+01  5.510900e+02
           $high    6.836252e+01  9.021268e+01  ...  8.168000e+01  5.650000e+02
           $low     6.708868e+01  8.751433e+01  ...  7.351000e+01  5.112000e+02
           $volume  6.043046e+06  1.366344e+07  ...  5.394940e+06  1.673598e+06
           $vwap    6.767087e+01  8.954028e+01  ...  7.703613e+01  5.409875e+02

[2244 rows x 265 columns]
features: ['$open', '$close', '$high', '$low', '$volume', '$vwap']
dates: DatetimeIndex(['2018-08-03', '2018-08-06', '2018-08-07', '2018-08-08',
               '2018-08-09', '2018-08-10', '2018-08-13', '2018-08-14',
               '2018-08-15', '2018-08-16',
               ...
               '2020-02-07', '2020-02-10', '2020-02-11', '2020-02-12',
               '2020-02-13', '2020-02-14', '2020-02-17', '2020-02-18',
               '2020-02-19', '2020-02-20'],
              dtype='datetime64[ns]', name='datetime', length=374, freq=None)
stock ids: Index(['SH600000', 'SH600009', 'SH600010', 'SH600011', 'SH600015', 'SH600016',
       'SH600018', 'SH600019', 'SH600023', 'SH600025',
       ...
       'SZ300496', 'SZ300498', 'SZ300628', 'SZ300661', 'SZ300750', 'SZ300751',
       'SZ300759', 'SZ300760', 'SZ300763', 'SZ300782'],
      dtype='object', name='instrument', length=265)
values: [[[5.7594746e+01 7.4151337e+01 4.5287013e+00 ...           nan
             nan           nan]
  [5.7830067e+01 7.1261703e+01 4.4720926e+00 ...           nan
             nan           nan]
  [5.8712517e+01 7.4820015e+01 4.6136146e+00 ...           nan
             nan           nan]
  [5.7418255e+01 7.1046776e+01 4.4437885e+00 ...           nan
             nan           nan]
  [2.8893230e+06 6.0645850e+06 6.1401496e+07 ...           nan
             nan           nan]
  [5.8154427e+01 7.2178673e+01 4.5364985e+00 ...           nan
             nan           nan]]

 [[5.8653687e+01 6.9375084e+01 4.4437885e+00 ...           nan
             nan           nan]
  [5.8300705e+01 6.5613785e+01 4.4720926e+00 ...           nan
             nan           nan]
  [5.9006668e+01 6.9912415e+01 4.5287013e+00 ...           nan
             nan           nan]
  [5.8065388e+01 6.4383904e+01 4.4154840e+00 ...           nan
             nan           nan]
  [2.9652285e+06 1.3297189e+07 5.4786024e+07 ...           nan
             nan           nan]
  [5.8531498e+01 6.7069809e+01 4.4683795e+00 ...           nan
             nan           nan]]

 [[5.8477196e+01 6.4288376e+01 4.5003972e+00 ...           nan
             nan           nan]
  [5.9477310e+01 6.6879494e+01 4.6136146e+00 ...           nan
             nan           nan]
  [5.9536140e+01 6.7010841e+01 4.6419191e+00 ...           nan
             nan           nan]
  [5.8477196e+01 6.4001801e+01 4.4720926e+00 ...           nan
             nan           nan]
  [3.7029738e+06 8.7752330e+06 6.3758960e+07 ...           nan
             nan           nan]
  [5.9121784e+01 6.5841408e+01 4.5497661e+00 ...           nan
             nan           nan]]

 ...

 [[6.7270660e+01 8.6785042e+01 3.4747181e+00 ... 2.3806000e+02
   6.7629997e+01 4.7879999e+02]
  [6.7088684e+01 8.6274544e+01 3.4747181e+00 ... 2.4228999e+02
   7.0190002e+01 5.2500000e+02]
  [6.7816589e+01 8.7660187e+01 3.5031993e+00 ... 2.4489999e+02
   7.0190002e+01 5.2578998e+02]
  [6.6967361e+01 8.5873436e+01 3.4462368e+00 ... 2.3799001e+02
   6.7629997e+01 4.7600000e+02]
  [4.9725155e+06 1.0627323e+07 8.7997576e+07 ... 3.8526440e+06
   1.8479300e+06 1.8417320e+06]
  [6.7264595e+01 8.6647415e+01 3.4752438e+00 ... 2.4204358e+02
   6.9770706e+01 5.0291565e+02]]

 [[6.7209999e+01 8.6481171e+01 3.4747181e+00 ... 2.3900999e+02
   7.7000000e+01 5.1100000e+02]
  [6.7391975e+01 8.7611565e+01 3.4177554e+00 ... 2.3480000e+02
   7.4250000e+01 5.2000000e+02]
  [6.8180542e+01 8.8097755e+01 3.4747181e+00 ... 2.4198000e+02
   7.7209999e+01 5.4900000e+02]
  [6.6967361e+01 8.5800507e+01 3.4177554e+00 ... 2.3400000e+02
   7.2000000e+01 5.0200000e+02]
  [4.1379220e+06 9.4909120e+06 7.6016664e+07 ... 6.3000960e+06
   6.0116660e+06 1.7468850e+06]
  [6.7515839e+01 8.7114258e+01 3.4465706e+00 ... 2.3615027e+02
   7.4655441e+01 5.2688196e+02]]

 [[6.7755928e+01 8.7575104e+01 3.4462368e+00 ... 2.3480000e+02
   7.6010002e+01 5.1120001e+02]
  [6.8119881e+01 8.9702187e+01 3.4747181e+00 ... 2.3499001e+02
   8.1680000e+01 5.5109003e+02]
  [6.8362518e+01 9.0212685e+01 3.5031993e+00 ... 2.3780000e+02
   8.1680000e+01 5.6500000e+02]
  [6.7088684e+01 8.7514328e+01 3.4177554e+00 ... 2.3313000e+02
   7.3510002e+01 5.1120001e+02]
  [6.0430455e+06 1.3663436e+07 9.0943256e+07 ... 4.8463090e+06
   5.3949400e+06 1.6735980e+06]
  [6.7670868e+01 8.9540276e+01 3.4568129e+00 ... 2.3500471e+02
   7.7036125e+01 5.4098755e+02]]], (374, 6, 265)
valid data: tensor([[[5.7595e+01, 7.4151e+01, 4.5287e+00,  ...,        nan,
                 nan,        nan],
         [5.7830e+01, 7.1262e+01, 4.4721e+00,  ...,        nan,
                 nan,        nan],
         [5.8713e+01, 7.4820e+01, 4.6136e+00,  ...,        nan,
                 nan,        nan],
         [5.7418e+01, 7.1047e+01, 4.4438e+00,  ...,        nan,
                 nan,        nan],
         [2.8893e+06, 6.0646e+06, 6.1401e+07,  ...,        nan,
                 nan,        nan],
         [5.8154e+01, 7.2179e+01, 4.5365e+00,  ...,        nan,
                 nan,        nan]],

        [[5.8654e+01, 6.9375e+01, 4.4438e+00,  ...,        nan,
                 nan,        nan],
         [5.8301e+01, 6.5614e+01, 4.4721e+00,  ...,        nan,
                 nan,        nan],
         [5.9007e+01, 6.9912e+01, 4.5287e+00,  ...,        nan,
                 nan,        nan],
         [5.8065e+01, 6.4384e+01, 4.4155e+00,  ...,        nan,
                 nan,        nan],
         [2.9652e+06, 1.3297e+07, 5.4786e+07,  ...,        nan,
                 nan,        nan],
         [5.8531e+01, 6.7070e+01, 4.4684e+00,  ...,        nan,
                 nan,        nan]],

        [[5.8477e+01, 6.4288e+01, 4.5004e+00,  ...,        nan,
                 nan,        nan],
         [5.9477e+01, 6.6879e+01, 4.6136e+00,  ...,        nan,
                 nan,        nan],
         [5.9536e+01, 6.7011e+01, 4.6419e+00,  ...,        nan,
                 nan,        nan],
         [5.8477e+01, 6.4002e+01, 4.4721e+00,  ...,        nan,
                 nan,        nan],
         [3.7030e+06, 8.7752e+06, 6.3759e+07,  ...,        nan,
                 nan,        nan],
         [5.9122e+01, 6.5841e+01, 4.5498e+00,  ...,        nan,
                 nan,        nan]],

        ...,

        [[6.7271e+01, 8.6785e+01, 3.4747e+00,  ..., 2.3806e+02,
          6.7630e+01, 4.7880e+02],
         [6.7089e+01, 8.6275e+01, 3.4747e+00,  ..., 2.4229e+02,
          7.0190e+01, 5.2500e+02],
         [6.7817e+01, 8.7660e+01, 3.5032e+00,  ..., 2.4490e+02,
          7.0190e+01, 5.2579e+02],
         [6.6967e+01, 8.5873e+01, 3.4462e+00,  ..., 2.3799e+02,
          6.7630e+01, 4.7600e+02],
         [4.9725e+06, 1.0627e+07, 8.7998e+07,  ..., 3.8526e+06,
          1.8479e+06, 1.8417e+06],
         [6.7265e+01, 8.6647e+01, 3.4752e+00,  ..., 2.4204e+02,
          6.9771e+01, 5.0292e+02]],

        [[6.7210e+01, 8.6481e+01, 3.4747e+00,  ..., 2.3901e+02,
          7.7000e+01, 5.1100e+02],
         [6.7392e+01, 8.7612e+01, 3.4178e+00,  ..., 2.3480e+02,
          7.4250e+01, 5.2000e+02],
         [6.8181e+01, 8.8098e+01, 3.4747e+00,  ..., 2.4198e+02,
          7.7210e+01, 5.4900e+02],
         [6.6967e+01, 8.5801e+01, 3.4178e+00,  ..., 2.3400e+02,
          7.2000e+01, 5.0200e+02],
         [4.1379e+06, 9.4909e+06, 7.6017e+07,  ..., 6.3001e+06,
          6.0117e+06, 1.7469e+06],
         [6.7516e+01, 8.7114e+01, 3.4466e+00,  ..., 2.3615e+02,
          7.4655e+01, 5.2688e+02]],

        [[6.7756e+01, 8.7575e+01, 3.4462e+00,  ..., 2.3480e+02,
          7.6010e+01, 5.1120e+02],
         [6.8120e+01, 8.9702e+01, 3.4747e+00,  ..., 2.3499e+02,
          8.1680e+01, 5.5109e+02],
         [6.8363e+01, 9.0213e+01, 3.5032e+00,  ..., 2.3780e+02,
          8.1680e+01, 5.6500e+02],
         [6.7089e+01, 8.7514e+01, 3.4178e+00,  ..., 2.3313e+02,
          7.3510e+01, 5.1120e+02],
         [6.0430e+06, 1.3663e+07, 9.0943e+07,  ..., 4.8463e+06,
          5.3949e+06, 1.6736e+06],
         [6.7671e+01, 8.9540e+01, 3.4568e+00,  ..., 2.3500e+02,
          7.7036e+01, 5.4099e+02]]]), torch.Size([374, 6, 265])
instruments: hs300
raw df:                             $open      $close  ...       $volume       $vwap
datetime   instrument                          ...                          
2019-08-06 SH600000     67.331314   67.270660  ...  7.452146e+06   67.347801
           SH600009     93.082047   95.216736  ...  1.013790e+07   93.722412
           SH600010      4.357638    4.272194  ...  1.018930e+08    4.277699
           SH600011      9.384294    9.624917  ...  1.677594e+07    9.502217
           SH600015     17.344748   17.417017  ...  8.411508e+06   17.377920
...                           ...         ...  ...           ...         ...
2023-08-11 SZ300751    963.043640  941.549194  ...  2.943202e+05  949.165955
           SZ300759     69.619865   67.315178  ...  1.249340e+07   68.694756
           SZ300760    280.070007  276.232025  ...  4.440344e+06  277.836975
           SZ300763    400.967407  391.187714  ...  2.033148e+06  396.690125
           SZ300782    654.953186  639.436157  ...  3.401388e+05  643.991699

[259698 rows x 6 columns]
preprocessed df:                             $open      $close  ...       $volume       $vwap
datetime   instrument                          ...                          
2019-08-06 SH600000     67.331314   67.270660  ...  7.452146e+06   67.347801
           SH600009     93.082047   95.216736  ...  1.013790e+07   93.722412
           SH600010      4.357638    4.272194  ...  1.018930e+08    4.277699
           SH600011      9.384294    9.624917  ...  1.677594e+07    9.502217
           SH600015     17.344748   17.417017  ...  8.411508e+06   17.377920
...                           ...         ...  ...           ...         ...
2023-08-11 SZ300751    963.043640  941.549194  ...  2.943202e+05  949.165955
           SZ300759     69.619865   67.315178  ...  1.249340e+07   68.694756
           SZ300760    280.070007  276.232025  ...  4.440344e+06  277.836975
           SZ300763    400.967407  391.187714  ...  2.033148e+06  396.690125
           SZ300782    654.953186  639.436157  ...  3.401388e+05  643.991699

[259698 rows x 6 columns]
df after stack: instrument              SH600000      SH600009  ...      SZ300763      SZ300782
datetime                                        ...                            
2019-08-06 $open    6.733131e+01  9.308205e+01  ...  3.563924e+01  2.244175e+02
           $close   6.727066e+01  9.521674e+01  ...  3.595101e+01  2.305114e+02
           $high    6.811988e+01  9.612127e+01  ...  3.603869e+01  2.342416e+02
           $low     6.654276e+01  9.209309e+01  ...  3.411936e+01  2.200391e+02
           $volume  7.452146e+06  1.013790e+07  ...  1.236556e+06  2.041850e+06
...                          ...           ...  ...           ...           ...
2023-08-11 $close   5.358810e+01  5.786763e+01  ...  3.911877e+02  6.394362e+02
           $high    5.514461e+01  5.937786e+01  ...  4.021128e+02  6.578267e+02
           $low     5.358810e+01  5.783079e+01  ...  3.911877e+02  6.394362e+02
           $volume  4.998864e+06  1.474086e+07  ...  2.033148e+06  3.401388e+05
           $vwap    5.414545e+01  5.854885e+01  ...  3.966901e+02  6.439917e+02

[5856 rows x 267 columns]
features: ['$open', '$close', '$high', '$low', '$volume', '$vwap']
dates: DatetimeIndex(['2019-08-06', '2019-08-07', '2019-08-08', '2019-08-09',
               '2019-08-12', '2019-08-13', '2019-08-14', '2019-08-15',
               '2019-08-16', '2019-08-19',
               ...
               '2023-07-31', '2023-08-01', '2023-08-02', '2023-08-03',
               '2023-08-04', '2023-08-07', '2023-08-08', '2023-08-09',
               '2023-08-10', '2023-08-11'],
              dtype='datetime64[ns]', name='datetime', length=976, freq=None)
stock ids: Index(['SH600000', 'SH600009', 'SH600010', 'SH600011', 'SH600015', 'SH600016',
       'SH600018', 'SH600019', 'SH600023', 'SH600025',
       ...
       'SZ300496', 'SZ300498', 'SZ300628', 'SZ300661', 'SZ300750', 'SZ300751',
       'SZ300759', 'SZ300760', 'SZ300763', 'SZ300782'],
      dtype='object', name='instrument', length=267)
values: [[[6.73313141e+01 9.30820465e+01 4.35763836e+00 ... 1.50000000e+02
   3.56392365e+01 2.24417511e+02]
  [6.72706604e+01 9.52167358e+01 4.27219439e+00 ... 1.52809998e+02
   3.59510078e+01 2.30511414e+02]
  [6.81198807e+01 9.61212692e+01 4.35763836e+00 ... 1.54860001e+02
   3.60386925e+01 2.34241577e+02]
  [6.65427551e+01 9.20930939e+01 4.21523190e+00 ... 1.49210007e+02
   3.41193581e+01 2.20039062e+02]
  [7.45214550e+06 1.01379010e+07 1.01892984e+08 ... 2.19341500e+06
   1.23655562e+06 2.04184962e+06]
  [6.73478012e+01 9.37224121e+01 4.27769899e+00 ... 1.52412476e+02
   3.51813469e+01 2.27876511e+02]]

 [[6.75739517e+01 9.60609665e+01 4.27219439e+00 ... 1.53660004e+02
   3.61068916e+01 2.30680969e+02]
  [6.71493378e+01 9.52891006e+01 4.32915688e+00 ... 1.55869995e+02
   3.69058037e+01 2.35408493e+02]
  [6.76952744e+01 9.72067032e+01 4.38611937e+00 ... 1.57229996e+02
   3.71298904e+01 2.44354874e+02]
  [6.70280228e+01 9.52891006e+01 4.24371290e+00 ... 1.53029999e+02
   3.58730659e+01 2.25504639e+02]
  [5.18672650e+06 4.99533050e+06 7.57949280e+07 ... 1.79728600e+06
   1.43831450e+06 2.50186600e+06]
  [6.73386993e+01 9.60424271e+01 4.30293894e+00 ... 1.55325592e+02
   3.65298843e+01 2.35956390e+02]]

 [[6.76346130e+01 9.57473907e+01 4.30067539e+00 ... 1.57300003e+02
   3.68473473e+01 2.39368042e+02]
  [6.83018570e+01 9.73876038e+01 4.30067539e+00 ... 1.60149994e+02
   3.81431427e+01 2.56333252e+02]
  [6.86051559e+01 9.87504272e+01 4.32915688e+00 ... 1.61649994e+02
   3.86692543e+01 2.58946350e+02]
  [6.73919754e+01 9.57473907e+01 4.27219439e+00 ... 1.55000000e+02
   3.65160904e+01 2.35548126e+02]
  [5.48280900e+06 6.82624100e+06 4.90394160e+07 ... 2.02856500e+06
   2.25365025e+06 3.70768500e+06]
  [6.80683212e+01 9.76518326e+01 4.30077076e+00 ... 1.59363571e+02
   3.78783989e+01 2.51735519e+02]]

 ...

 [[5.55893211e+01 5.64065094e+01 5.42620087e+00 ... 2.83596802e+02
   3.79822113e+02 6.47847717e+02]
  [5.59599152e+01 5.67134666e+01 5.42620087e+00 ... 2.81366638e+02
   3.81980682e+02 6.45287720e+02]
  [5.59599152e+01 5.70940933e+01 5.48362112e+00 ... 2.83596802e+02
   3.89954224e+02 6.55684631e+02]
  [5.53669624e+01 5.63328400e+01 5.39749098e+00 ... 2.78690399e+02
   3.78941071e+02 6.36353638e+02]
  [2.40053800e+06 5.27038700e+06 5.95934400e+07 ... 8.40822400e+06
   1.16010638e+06 4.40774125e+05]
  [5.57947121e+01 5.67623444e+01 5.43603802e+00 ... 2.81020081e+02
   3.84192047e+02 6.46966858e+02]]

 [[5.52187271e+01 5.71554871e+01 5.42620087e+00 ... 2.81107300e+02
   3.78985107e+02 6.40376587e+02]
  [5.49963684e+01 5.87271080e+01 5.39749098e+00 ... 2.80287842e+02
   4.03302185e+02 6.52602112e+02]
  [5.52928429e+01 5.87516670e+01 5.45491076e+00 ... 2.81999390e+02
   4.10835205e+02 6.55423401e+02]
  [5.44775352e+01 5.70449829e+01 5.36878061e+00 ... 2.77663483e+02
   3.78897003e+02 6.38077759e+02]
  [7.13248050e+06 1.90091380e+07 5.59223600e+07 ... 5.68937700e+06
   4.33674300e+06 4.12218531e+05]
  [5.48347664e+01 5.81938019e+01 5.40718937e+00 ... 2.79349274e+02
   3.99201782e+02 6.51167419e+02]]

 [[5.51446075e+01 5.87639427e+01 5.42620087e+00 ... 2.80070007e+02
   4.00967407e+02 6.54953186e+02]
  [5.35881042e+01 5.78676262e+01 5.28265047e+00 ... 2.76232025e+02
   3.91187714e+02 6.39436157e+02]
  [5.51446075e+01 5.93778572e+01 5.42620087e+00 ... 2.81719299e+02
   4.02112762e+02 6.57826660e+02]
  [5.35881042e+01 5.78307915e+01 5.28265047e+00 ... 2.76003815e+02
   3.91187714e+02 6.39436157e+02]
  [4.99886400e+06 1.47408620e+07 6.91501680e+07 ... 4.44034450e+06
   2.03314788e+06 3.40138812e+05]
  [5.41454544e+01 5.85488510e+01 5.33458900e+00 ... 2.77836975e+02
   3.96690125e+02 6.43991699e+02]]], (976, 6, 267)
/Users/yangguangyu/anaconda3/envs/quant_dev/lib/python3.9/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.activation_relu_or_gelu was not True
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
test data: tensor([[[6.7331e+01, 9.3082e+01, 4.3576e+00,  ..., 1.5000e+02,
          3.5639e+01, 2.2442e+02],
         [6.7271e+01, 9.5217e+01, 4.2722e+00,  ..., 1.5281e+02,
          3.5951e+01, 2.3051e+02],
         [6.8120e+01, 9.6121e+01, 4.3576e+00,  ..., 1.5486e+02,
          3.6039e+01, 2.3424e+02],
         [6.6543e+01, 9.2093e+01, 4.2152e+00,  ..., 1.4921e+02,
          3.4119e+01, 2.2004e+02],
         [7.4521e+06, 1.0138e+07, 1.0189e+08,  ..., 2.1934e+06,
          1.2366e+06, 2.0418e+06],
         [6.7348e+01, 9.3722e+01, 4.2777e+00,  ..., 1.5241e+02,
          3.5181e+01, 2.2788e+02]],

        [[6.7574e+01, 9.6061e+01, 4.2722e+00,  ..., 1.5366e+02,
          3.6107e+01, 2.3068e+02],
         [6.7149e+01, 9.5289e+01, 4.3292e+00,  ..., 1.5587e+02,
          3.6906e+01, 2.3541e+02],
         [6.7695e+01, 9.7207e+01, 4.3861e+00,  ..., 1.5723e+02,
          3.7130e+01, 2.4435e+02],
         [6.7028e+01, 9.5289e+01, 4.2437e+00,  ..., 1.5303e+02,
          3.5873e+01, 2.2550e+02],
         [5.1867e+06, 4.9953e+06, 7.5795e+07,  ..., 1.7973e+06,
          1.4383e+06, 2.5019e+06],
         [6.7339e+01, 9.6042e+01, 4.3029e+00,  ..., 1.5533e+02,
          3.6530e+01, 2.3596e+02]],

        [[6.7635e+01, 9.5747e+01, 4.3007e+00,  ..., 1.5730e+02,
          3.6847e+01, 2.3937e+02],
         [6.8302e+01, 9.7388e+01, 4.3007e+00,  ..., 1.6015e+02,
          3.8143e+01, 2.5633e+02],
         [6.8605e+01, 9.8750e+01, 4.3292e+00,  ..., 1.6165e+02,
          3.8669e+01, 2.5895e+02],
         [6.7392e+01, 9.5747e+01, 4.2722e+00,  ..., 1.5500e+02,
          3.6516e+01, 2.3555e+02],
         [5.4828e+06, 6.8262e+06, 4.9039e+07,  ..., 2.0286e+06,
          2.2537e+06, 3.7077e+06],
         [6.8068e+01, 9.7652e+01, 4.3008e+00,  ..., 1.5936e+02,
          3.7878e+01, 2.5174e+02]],

        ...,

        [[5.5589e+01, 5.6407e+01, 5.4262e+00,  ..., 2.8360e+02,
          3.7982e+02, 6.4785e+02],
         [5.5960e+01, 5.6713e+01, 5.4262e+00,  ..., 2.8137e+02,
          3.8198e+02, 6.4529e+02],
         [5.5960e+01, 5.7094e+01, 5.4836e+00,  ..., 2.8360e+02,
          3.8995e+02, 6.5568e+02],
         [5.5367e+01, 5.6333e+01, 5.3975e+00,  ..., 2.7869e+02,
          3.7894e+02, 6.3635e+02],
         [2.4005e+06, 5.2704e+06, 5.9593e+07,  ..., 8.4082e+06,
          1.1601e+06, 4.4077e+05],
         [5.5795e+01, 5.6762e+01, 5.4360e+00,  ..., 2.8102e+02,
          3.8419e+02, 6.4697e+02]],

        [[5.5219e+01, 5.7155e+01, 5.4262e+00,  ..., 2.8111e+02,
          3.7899e+02, 6.4038e+02],
         [5.4996e+01, 5.8727e+01, 5.3975e+00,  ..., 2.8029e+02,
          4.0330e+02, 6.5260e+02],
         [5.5293e+01, 5.8752e+01, 5.4549e+00,  ..., 2.8200e+02,
          4.1084e+02, 6.5542e+02],
         [5.4478e+01, 5.7045e+01, 5.3688e+00,  ..., 2.7766e+02,
          3.7890e+02, 6.3808e+02],
         [7.1325e+06, 1.9009e+07, 5.5922e+07,  ..., 5.6894e+06,
          4.3367e+06, 4.1222e+05],
         [5.4835e+01, 5.8194e+01, 5.4072e+00,  ..., 2.7935e+02,
          3.9920e+02, 6.5117e+02]],

        [[5.5145e+01, 5.8764e+01, 5.4262e+00,  ..., 2.8007e+02,
          4.0097e+02, 6.5495e+02],
         [5.3588e+01, 5.7868e+01, 5.2827e+00,  ..., 2.7623e+02,
          3.9119e+02, 6.3944e+02],
         [5.5145e+01, 5.9378e+01, 5.4262e+00,  ..., 2.8172e+02,
          4.0211e+02, 6.5783e+02],
         [5.3588e+01, 5.7831e+01, 5.2827e+00,  ..., 2.7600e+02,
          3.9119e+02, 6.3944e+02],
         [4.9989e+06, 1.4741e+07, 6.9150e+07,  ..., 4.4403e+06,
          2.0331e+06, 3.4014e+05],
         [5.4145e+01, 5.8549e+01, 5.3346e+00,  ..., 2.7784e+02,
          3.9669e+02, 6.4399e+02]]]), torch.Size([976, 6, 267])
Using cpu device
Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.
Logging to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104232632_1
/Users/yangguangyu/anaconda3/envs/quant_dev/lib/python3.9/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.action_masks to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.action_masks` for environment variables or `env.get_wrapper_attr('action_masks')` that will search the reminding wrappers.[0m
  logger.warn(
/Users/yangguangyu/anaconda3/envs/quant_dev/lib/python3.9/site-packages/stable_baselines3/common/save_util.py:283: UserWarning: Path '/Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104232632' does not exist. Will create it.
  warnings.warn(f"Path '{path.parent}' does not exist. Will create it.")
Ref(Mul($high,Greater($close,Constant(0.5))),40)
Add(Sub(Constant(-5.0),Sub($low,Greater(Constant(10.0),$vwap))),Constant(0.01))
Abs(Add(WMA(Corr($volume,Sub($vwap,Div(Constant(0.5),Log(Add($vwap,Greater(Abs($close),Constant(-2.0)))))),40),40),Constant(0.5)))
Sub($close,$vwap)
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104232632/2048_steps
---------------------------------
| pool/              |          |
|    best_ic_ret     | 0.0114   |
|    eval_cnt        | 2        |
|    significant     | 2        |
|    size            | 2        |
| rollout/           |          |
|    ep_len_mean     | 19.6     |
|    ep_rew_mean     | -0.96    |
| test/              |          |
|    ic              | -0.0124  |
|    rank_ic         | -0.0183  |
| time/              |          |
|    fps             | 293      |
|    iterations      | 1        |
|    time_elapsed    | 6        |
|    total_timesteps | 2048     |
---------------------------------
/Users/yangguangyu/anaconda3/envs/quant_dev/lib/python3.9/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.action_masks to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.action_masks` for environment variables or `env.get_wrapper_attr('action_masks')` that will search the reminding wrappers.[0m
  logger.warn(
Ref($volume,20)
Mul(Constant(-10.0),$open)
Add(Constant(-5.0),$low)
Mul($vwap,Constant(5.0))
$high
Add($volume,Constant(-0.5))
$volume
$volume
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104232632/4096_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.0114      |
|    eval_cnt             | 2           |
|    significant          | 2           |
|    size                 | 2           |
| rollout/                |             |
|    ep_len_mean          | 18.7        |
|    ep_rew_mean          | -0.92       |
| test/                   |             |
|    ic                   | -0.0124     |
|    rank_ic              | -0.0183     |
| time/                   |             |
|    fps                  | 73          |
|    iterations           | 2           |
|    time_elapsed         | 55          |
|    total_timesteps      | 4096        |
| train/                  |             |
|    approx_kl            | 0.013663372 |
|    clip_fraction        | 0.184       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.99       |
|    explained_variance   | -0.439      |
|    learning_rate        | 0.001       |
|    loss                 | -0.263      |
|    n_updates            | 10          |
|    policy_gradient_loss | -0.0172     |
|    value_loss           | 0.211       |
-----------------------------------------
Mul(Constant(-2.0),Add($open,Less($volume,Greater(Constant(-1.0),$volume))))
Sub($close,Less(Constant(-0.01),Mean(Add(Add(Greater(Log($close),Constant(-0.01)),$low),$close),50)))
$volume
$vwap
Add($high,Constant(-30.0))
Sub(Sub(Var($low,40),Max(Add(Add(Constant(-0.01),Mul(Std($open,40),Greater($volume,Constant(1.0)))),Constant(2.0)),10)),Constant(1.0))
Log(Abs(Sub(Less(Greater(Sub(Constant(30.0),$low),Constant(-30.0)),Mul(Mul($vwap,Div(Add($low,Constant(5.0)),Constant(5.0))),$open)),$low)))
Add(Constant(2.0),$low)
Max(Mul(Constant(0.01),$vwap),30)
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104232632/6144_steps
----------------------------------------
| pool/                   |            |
|    best_ic_ret          | 0.0114     |
|    eval_cnt             | 2          |
|    significant          | 2          |
|    size                 | 2          |
| rollout/                |            |
|    ep_len_mean          | 19         |
|    ep_rew_mean          | -0.91      |
| test/                   |            |
|    ic                   | -0.0124    |
|    rank_ic              | -0.0183    |
| time/                   |            |
|    fps                  | 57         |
|    iterations           | 3          |
|    time_elapsed         | 106        |
|    total_timesteps      | 6144       |
| train/                  |            |
|    approx_kl            | 0.01497571 |
|    clip_fraction        | 0.149      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3         |
|    explained_variance   | 3.4e-06    |
|    learning_rate        | 0.001      |
|    loss                 | -0.306     |
|    n_updates            | 20         |
|    policy_gradient_loss | -0.0184    |
|    value_loss           | 0.0242     |
----------------------------------------
Add($vwap,Constant(0.5))
Add(Constant(0.01),Add($volume,Sum(Mean(Div(Constant(-0.01),Add(Mul(Add($volume,Constant(-2.0)),Constant(-0.01)),Div(Constant(-5.0),$low))),10),50)))
Sub(Constant(2.0),$open)
Sub(Div(Constant(0.01),Std($low,30)),Greater(Add(Sub(Constant(5.0),Sub($close,Constant(5.0))),Constant(-2.0)),Less(Var($volume,50),Constant(5.0))))
Mul(Std(Add(Constant(-0.5),Div($low,Constant(-30.0))),20),Constant(-0.01))
$close
Std(Mul(Constant(-1.0),Div(Max(Less(Sub($low,Constant(-1.0)),$low),30),Sub(Constant(1.0),Div(Sub($low,Constant(0.01)),Constant(-30.0))))),40)
Mean(Greater($high,Abs(WMA(Sub(WMA($volume,30),Log(Div(Constant(-0.5),Add($volume,Less(Constant(0.01),$close))))),30))),20)
$close
Abs(Log($volume))
$vwap
Add(Less(Greater(Mul($low,Constant(-0.01)),Less(Constant(2.0),Abs($close))),Var($low,50)),Add(Less($close,Constant(1.0)),$volume))
Mul($open,Less(Constant(-0.01),Add($low,Constant(1.0))))
Mul(Min(Add($open,Constant(1.0)),30),Less(Constant(0.5),Var(Ref(Mul(Mad($low,20),Constant(5.0)),30),40)))
Mul(Constant(-1.0),Greater(Abs(Div($low,Constant(5.0))),Add(Constant(-2.0),Mul(Sub(Med(Mul(Log($vwap),Constant(10.0)),20),$close),Constant(10.0)))))
Div($low,Constant(1.0))
Sub(Add($open,Mul(Div(Constant(-0.5),Div(Sub(Less($vwap,Constant(0.5)),$volume),Less(Var($open,30),Constant(1.0)))),Constant(-5.0))),Constant(-0.01))
Add(Add(Div(Constant(-2.0),$vwap),Constant(1.0)),Constant(-2.0))
Add(Add(Greater(Constant(-5.0),Div($high,Constant(-2.0))),$open),$high)
Add(Mul(Add(Constant(10.0),Delta($volume,20)),Mul(Constant(2.0),Add(Sub(Add($low,Greater(Constant(2.0),$low)),$high),Constant(-30.0)))),Constant(5.0))
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104232632/8192_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.0114      |
|    eval_cnt             | 2           |
|    significant          | 2           |
|    size                 | 2           |
| rollout/                |             |
|    ep_len_mean          | 18.5        |
|    ep_rew_mean          | -0.82       |
| test/                   |             |
|    ic                   | -0.0124     |
|    rank_ic              | -0.0183     |
| time/                   |             |
|    fps                  | 52          |
|    iterations           | 4           |
|    time_elapsed         | 156         |
|    total_timesteps      | 8192        |
| train/                  |             |
|    approx_kl            | 0.014509173 |
|    clip_fraction        | 0.197       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3          |
|    explained_variance   | 7.75e-07    |
|    learning_rate        | 0.001       |
|    loss                 | -0.312      |
|    n_updates            | 30          |
|    policy_gradient_loss | -0.0166     |
|    value_loss           | 0.0232      |
-----------------------------------------
Add(Less(Constant(-2.0),Mul($close,Constant(5.0))),$volume)
Mul(Add(Constant(-10.0),Mul(Sub($open,Sub(Constant(2.0),$low)),Add(Std(Add(Mul($low,Constant(5.0)),Constant(-1.0)),10),Constant(1.0)))),Constant(-0.01))
Var(Mul(Div(Constant(5.0),Add(Greater($open,Constant(-0.01)),$low)),Constant(-0.5)),20)
$open
Less(Sub(Constant(-0.5),$vwap),$close)
Div(Sub(Abs(Std(Sub(Sub(Less(Constant(10.0),$close),Mul($high,Constant(-30.0))),Constant(0.01)),30)),Constant(2.0)),Constant(5.0))
Sum(Mul(Log(Add($volume,Mul($vwap,Greater(Constant(-10.0),Cov(Sub($close,Constant(0.5)),$low,30))))),Constant(-5.0)),50)
Log(Mul(Add(Greater($vwap,Constant(5.0)),Div(Std(Abs(Less(Mad(Sub($close,$close),20),$open)),50),Constant(-0.5))),Constant(0.01)))
Add(Var(EMA(Sub(Constant(2.0),Div(Add(Abs(Sub(Mad($open,50),Abs($volume))),Constant(-10.0)),Constant(0.5))),20),50),Constant(5.0))
$volume
Log($vwap)
$close
Mul(Constant(10.0),$high)
Mul(Add(Constant(-1.0),$low),Mul(Mul($close,Constant(-10.0)),WMA($open,20)))
Add(Less(Add(Constant(2.0),$low),Constant(1.0)),Div($volume,Sub(Greater(Div($volume,$low),Constant(-30.0)),Div(Mul($volume,Constant(1.0)),Constant(2.0)))))
Abs($volume)
Corr(Add(Mul(Constant(-5.0),Mul($volume,Constant(-0.01))),$high),Log(Mul(Constant(1.0),Add(Div(Div($low,$vwap),Constant(-10.0)),$vwap))),40)
Div(Std(Med(Var(Mul(Greater(Mean(Add(Constant(30.0),Var($close,50)),50),$high),Constant(1.0)),30),20),30),Constant(-30.0))
Sub($vwap,Constant(0.5))
Add(Constant(5.0),Add(Mean(Med(Mul($vwap,Constant(-2.0)),10),20),Constant(2.0)))
$vwap
Med(Log(Var($volume,50)),20)
Max(Add(Greater(Div(Mul(Constant(1.0),$low),Constant(-0.5)),Constant(-0.5)),Add(Greater($open,Constant(5.0)),Div($open,Constant(-0.01)))),20)
Corr(Mul(Constant(5.0),$vwap),Var(WMA(Add(Constant(-0.01),$low),10),50),30)
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104232632/10240_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.0114      |
|    eval_cnt             | 2           |
|    significant          | 2           |
|    size                 | 2           |
| rollout/                |             |
|    ep_len_mean          | 18          |
|    ep_rew_mean          | -0.78       |
| test/                   |             |
|    ic                   | -0.0124     |
|    rank_ic              | -0.0183     |
| time/                   |             |
|    fps                  | 49          |
|    iterations           | 5           |
|    time_elapsed         | 205         |
|    total_timesteps      | 10240       |
| train/                  |             |
|    approx_kl            | 0.014489241 |
|    clip_fraction        | 0.223       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.98       |
|    explained_variance   | 6.56e-07    |
|    learning_rate        | 0.001       |
|    loss                 | -0.301      |
|    n_updates            | 40          |
|    policy_gradient_loss | -0.0225     |
|    value_loss           | 0.0534      |
-----------------------------------------
Sub($close,Add(Less(Sub($open,Add(Div($vwap,Constant(-0.5)),Constant(-1.0))),Constant(0.01)),Div(Less($volume,Constant(1.0)),Mul($volume,Constant(30.0)))))
Add(Sub(EMA(Sub(Constant(2.0),Abs(Sub(Add(Mul($low,Min(Abs($low),40)),Constant(-30.0)),Constant(5.0)))),10),Constant(-30.0)),Constant(-30.0))
Mad(Log(Std(Std(Sub(Div(Log(Sub(Greater(Constant(10.0),$close),Max($open,20))),Constant(-1.0)),Constant(-1.0)),50),20)),20)
Add($close,Constant(-0.01))
Add(Mul(Cov($high,Add($volume,Greater(Constant(10.0),Sum($high,30))),10),Constant(-0.5)),Sub(Constant(5.0),$vwap))
Mul($volume,Add(Constant(-1.0),$high))
Mul(Constant(0.01),$open)
Std(Add(Med(Add($close,Constant(2.0)),50),Constant(-10.0)),20)
Add(Log($low),WMA(Add(Constant(5.0),Add($low,$close)),10))
Mul(Constant(-0.01),$low)
Div(Mean(Mul($low,$low),20),Constant(-10.0))
Div(Div(Constant(-5.0),$vwap),Constant(2.0))
Sub(Mul(Mul(Less(Mul(Sub(Add(Constant(5.0),Add($close,Constant(2.0))),Constant(10.0)),Constant(0.5)),Constant(5.0)),$low),Constant(-10.0)),Constant(5.0))
Abs(Add(Sub(Add(Constant(-0.01),$low),Constant(2.0)),Mul(Log($open),Constant(-30.0))))
Less(Mul(Std(Mul(Sub(Sub(Div(Constant(30.0),$low),Min(Mul($volume,Constant(-1.0)),40)),Constant(-5.0)),Constant(-0.5)),50),Constant(5.0)),$vwap)
Std(Sub(Constant(5.0),Div(Sub($low,Greater(Mul(Add(Greater(Constant(1.0),$high),Add($vwap,Constant(-5.0))),Constant(0.5)),Constant(-1.0))),Constant(-30.0))),20)
Sub(Sub(Mul(Sub(Add(Greater(Constant(-0.5),Sub($vwap,Constant(-0.5))),Min(Add($high,Constant(-0.01)),10)),Constant(2.0)),Constant(1.0)),Constant(-5.0)),Constant(1.0))
Div(Div(Log($vwap),Abs(Div($open,Constant(-0.01)))),Sub($close,Constant(-0.01)))
Add(Div(Constant(0.5),Var($close,10)),Div($vwap,Constant(30.0)))
Div(Constant(-0.5),Std(Add($vwap,Less(Add(Constant(2.0),Sub(Less($open,Constant(-0.5)),Sub(Div($open,Constant(30.0)),Constant(-0.01)))),Constant(-1.0))),30))
Mul(Constant(-2.0),Add(Div(Std(Div($vwap,Constant(0.5)),20),Constant(2.0)),Constant(-5.0)))
Mul(Div(Log(Med(Add($low,Constant(-0.01)),50)),Constant(10.0)),Constant(0.01))
Mul(Less(Div(Greater(Constant(-5.0),$open),$low),Mul(Constant(1.0),Add(Less($close,Constant(-1.0)),Add(Mul($low,Constant(2.0)),Constant(-0.5))))),Constant(-5.0))
Mean(Mul(Constant(30.0),Div(Mul(Div(Std($volume,30),Constant(5.0)),Constant(-1.0)),Constant(-0.5))),10)
Add(Greater(Add(Constant(-0.5),Med($low,20)),Constant(2.0)),Sub(Less(Add($volume,Abs($vwap)),$vwap),Less(Constant(5.0),$volume)))
Add(Log(Mul(Cov(Abs(Add(Less(Constant(-30.0),$volume),$open)),Log($open),50),Add(Constant(2.0),Var($volume,30)))),Constant(-0.5))
Mul(Sub(Mul(Constant(10.0),Ref($high,10)),Constant(-5.0)),Constant(0.5))
Div(Div(Add(Constant(2.0),Mul(Add($vwap,Constant(1.0)),Constant(-5.0))),Less($low,Constant(-5.0))),Constant(-5.0))
Div(Less(Constant(-1.0),Mul($high,Constant(-5.0))),Mul(Div($high,Constant(-0.01)),Constant(1.0)))
$volume
Mul(Less(Med(Greater($low,Mul(Mul(Constant(-0.5),$volume),Constant(-5.0))),30),Constant(-30.0)),Delta(Add(Sub($close,Constant(-30.0)),Constant(-2.0)),40))
Add(Constant(2.0),$high)
Log(Add(Mean(Mul(Sub(WMA(Add($vwap,Constant(-2.0)),50),$vwap),Constant(-0.01)),40),Constant(10.0)))
Sub(Constant(-0.5),$vwap)
Div(Constant(-5.0),Med(Max(Add(Std(Sub(Add(Var(Add($low,Constant(-30.0)),40),Constant(1.0)),Constant(10.0)),50),Constant(0.5)),10),40))
Div(Std(Log(Delta(Add(Mul(Div($high,Constant(2.0)),Constant(5.0)),Constant(-1.0)),20)),40),Constant(-1.0))
$low
Log(Mul(Mul(Mul(Less(Mul(Sub(Constant(-0.01),$vwap),Add($close,$open)),Constant(-0.01)),WMA(Log($close),20)),Constant(-2.0)),Constant(0.01)))
Log(Div(Div(Greater(Less(Less(Mul(Constant(-30.0),$high),Constant(0.01)),$vwap),Div($volume,Constant(2.0))),$open),Constant(0.01)))
Sub(Constant(30.0),Div(Div(WMA(Mul(Add(Std($volume,20),Constant(-0.01)),Constant(-30.0)),50),Constant(-2.0)),Constant(2.0)))
Add(Add(Constant(5.0),Sub(Cov(Mul(Greater($close,Constant(-10.0)),Std($open,20)),Mul($open,Abs($open)),50),Constant(-30.0))),Constant(-2.0))
Mul(Constant(30.0),$low)
Mad($volume,10)
Mul(Greater(Mul(Add(Div(Constant(-5.0),Mul(Add(Std($low,50),Constant(5.0)),Constant(1.0))),$low),$open),Constant(-10.0)),Mul($volume,Constant(-0.5)))
Sub(Constant(-0.01),Std($vwap,10))
Mul(Constant(-0.5),Max(Abs(Mul(Mad($volume,40),Constant(-5.0))),50))
Sub(Greater(Greater(Less(Constant(-5.0),$close),Mul($low,$volume)),$high),$low)
Sub(Constant(-0.01),Cov(Sum($close,50),$high,30))
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104232632/12288_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.0114      |
|    eval_cnt             | 2           |
|    significant          | 2           |
|    size                 | 2           |
| rollout/                |             |
|    ep_len_mean          | 17.4        |
|    ep_rew_mean          | -0.62       |
| test/                   |             |
|    ic                   | -0.0124     |
|    rank_ic              | -0.0183     |
| time/                   |             |
|    fps                  | 47          |
|    iterations           | 6           |
|    time_elapsed         | 256         |
|    total_timesteps      | 12288       |
| train/                  |             |
|    approx_kl            | 0.014606655 |
|    clip_fraction        | 0.212       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.94       |
|    explained_variance   | 1.79e-07    |
|    learning_rate        | 0.001       |
|    loss                 | -0.289      |
|    n_updates            | 50          |
|    policy_gradient_loss | -0.0238     |
|    value_loss           | 0.0609      |
-----------------------------------------
Mul(Constant(0.5),Log(Sub($close,Less(Constant(-30.0),$volume))))
Div(Mul(Sub(Constant(10.0),Max(Sub($vwap,Mul(Constant(-2.0),Add(Std(Div($vwap,Constant(5.0)),40),Constant(-5.0)))),20)),Constant(-30.0)),Constant(5.0))
Mul(Delta(Abs(Div(Greater(Mul(Constant(-1.0),$volume),Constant(-2.0)),$vwap)),50),Constant(-5.0))
Sub(Log(Sub(Mul(Mul(Add(Less(Constant(-1.0),$volume),$close),Constant(-10.0)),Constant(2.0)),Constant(0.01))),Constant(1.0))
Mul(Greater(Std(Mul(Constant(-2.0),$volume),10),Constant(-30.0)),Std(Sub($low,Constant(-0.01)),50))
Mul(Constant(-5.0),Var(Mul($high,Cov(Mul(Constant(30.0),Mul($close,Constant(1.0))),Min(Abs(Sub(Constant(1.0),$close)),20),40)),40))
Mul(Mul($open,Constant(-1.0)),$volume)
Sub(Constant(-5.0),Mul(Corr($vwap,Mul(Sub(Constant(-10.0),$low),Constant(2.0)),50),Sub($close,$low)))
Mul(Constant(2.0),Sub($low,Constant(-1.0)))
$high
Mul(Constant(0.01),$high)
Add(Abs(Add($close,Add(Constant(0.5),Med($high,40)))),Less(Constant(-0.01),$low))
Add(Add(Add(Sub(Constant(-2.0),$open),Delta(Add(Div(Constant(0.5),$close),Div(Greater(Constant(-1.0),$open),$volume)),20)),Constant(-1.0)),Constant(-2.0))
$low
$high
Mul($close,Ref(Add(Div($volume,Constant(-30.0)),$high),50))
Add($vwap,Add($close,Constant(-0.5)))
Sub(Add(Div(Less(Log(Var(Sub(Constant(-30.0),$vwap),20)),Constant(-0.5)),$close),Constant(-0.01)),Constant(5.0))
Add(Constant(-5.0),$low)
Add($vwap,Constant(-0.01))
Mul(Constant(-5.0),WMA(Add($low,Constant(5.0)),20))
Greater($close,Add(Div(Constant(0.01),Add(Var($volume,10),Constant(0.01))),Cov($close,$low,20)))
Add(Sub(Mul(Constant(30.0),Div(Add(Mul(Mul(Mul(Mul($open,Constant(5.0)),Constant(1.0)),Constant(-1.0)),Constant(1.0)),Constant(2.0)),Constant(10.0))),Constant(-2.0)),Constant(-0.5))
Mul(Constant(-10.0),Mul(Mul(Abs($low),Greater(Mul(Div(Mul(Sub(Constant(-5.0),$volume),Constant(-5.0)),Constant(-30.0)),Constant(-10.0)),Constant(5.0))),$close))
Div(Log(Sub(Constant(-30.0),$low)),Constant(2.0))
Mul(Mul(Add(Constant(-5.0),Sub($low,$close)),Constant(-10.0)),Constant(0.01))
Div(Std(Div(Add($close,Add(Sub(Div($high,Constant(-30.0)),Less($volume,Constant(5.0))),Constant(5.0))),Constant(2.0)),50),Mul($close,Constant(-2.0)))
Log(Add(Var(Sub(Constant(-30.0),Med($volume,30)),30),Var($low,40)))
Cov(Std(Div(Greater(Constant(-0.01),Std($high,50)),Mul($close,Sub(Constant(-10.0),Std($high,20)))),50),$vwap,50)
Log(Mean(Add(Corr(Delta(Mul($open,Constant(5.0)),50),Div(Constant(-30.0),$volume),50),Constant(1.0)),30))
Mul(Sub(Constant(-10.0),$volume),Constant(-2.0))
Mul(Sub(Mul(Mul(Log($vwap),Log(Mul(Constant(5.0),$low))),Constant(-1.0)),Less($close,Constant(2.0))),Constant(-2.0))
Mean(Log(Add($low,Constant(-5.0))),40)
Log(Sub(Constant(30.0),Mul($vwap,Constant(0.01))))
$low
$high
Mul(Constant(-1.0),Mad(Add($low,Constant(0.01)),50))
WMA(Std(Sub($volume,Var($low,40)),50),30)
Sub(Var(Add($close,Constant(10.0)),20),$vwap)
Add(Mul(WMA(Med(Mul(Constant(-10.0),WMA(Add(Mul(Mad($close,50),Constant(2.0)),Constant(-30.0)),40)),10),10),Constant(5.0)),Constant(30.0))
Mul(Add(Constant(-0.01),Mul(Sub($volume,Constant(-5.0)),Mul(Add(Mul($close,Div($high,Constant(-2.0))),Constant(-0.01)),$high))),Mul(Constant(-5.0),$open))
Mul(Constant(5.0),Sub($volume,Div(Constant(-5.0),Add(Abs($vwap),Constant(-1.0)))))
Mul(Constant(10.0),Add($vwap,Constant(0.5)))
Mul(Add(Add(Constant(2.0),$vwap),Div(Constant(-0.5),Delta($open,50))),Constant(2.0))
Std(Sub(Sub(Constant(-2.0),Mul(Div(Sub(Med($open,30),Constant(10.0)),Constant(10.0)),Mul($volume,Mul($vwap,Constant(1.0))))),Constant(-10.0)),20)
Add(Log(Std(Add(Constant(-30.0),Mul(Mul($high,Constant(-2.0)),Mul(Abs($vwap),Constant(-30.0)))),30)),Constant(1.0))
Mul(Sub(Sub(Abs(Div(Constant(-5.0),Mad($high,20))),Constant(-5.0)),Less($high,Less($high,Constant(-0.5)))),$vwap)
Abs(Add(Mean(Std(Div(Mul(Constant(5.0),Var(Med($low,20),10)),Constant(5.0)),10),30),Constant(-1.0)))
Mul(Sub(Sub(Sub(Log(Log(Mul(Constant(2.0),$high))),Sub(Mul($volume,Constant(-2.0)),Constant(5.0))),Constant(-1.0)),Constant(1.0)),Constant(-5.0))
Var($open,50)
Add(Less(Sub(Sub(Add(Sub($vwap,Mul(Constant(2.0),Mul($vwap,Constant(1.0)))),$high),$vwap),Less(Constant(10.0),$close)),Constant(5.0)),$vwap)
Add(Div(Constant(5.0),Greater(Mad($volume,30),Sub(Constant(-5.0),Mul($vwap,Med(Sub($close,Constant(-30.0)),10))))),Constant(-0.01))
Add(Div(Constant(-0.5),$high),Constant(0.5))
Cov(Greater($high,Std(Div($close,Constant(5.0)),30)),Mean($open,50),30)
Sub(Mul(Greater(EMA(Div(Constant(0.5),$high),30),Constant(-30.0)),Div(Div(Div(Med($volume,30),Constant(5.0)),Constant(-5.0)),$volume)),Constant(-2.0))
Sub(Greater(Constant(-0.5),$vwap),$high)
Std(Sub(Constant(-0.01),$volume),20)
WMA($open,10)
$close
Mul(Std(Div(Abs(Add(Constant(2.0),$vwap)),Constant(-30.0)),30),WMA(Abs(Std(Add(Constant(-5.0),$high),20)),40))
Div(Log(Add(Sub($close,$vwap),$volume)),Constant(-2.0))
Div(Greater(Greater($volume,Greater(Log($open),Constant(0.01))),$low),$low)
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104232632/14336_steps
------------------------------------------
| pool/                   |              |
|    best_ic_ret          | 0.101        |
|    eval_cnt             | 6            |
|    significant          | 6            |
|    size                 | 6            |
| rollout/                |              |
|    ep_len_mean          | 15.9         |
|    ep_rew_mean          | -0.517       |
| test/                   |              |
|    ic                   | 0.0325       |
|    rank_ic              | 0.031        |
| time/                   |              |
|    fps                  | 46           |
|    iterations           | 7            |
|    time_elapsed         | 308          |
|    total_timesteps      | 14336        |
| train/                  |              |
|    approx_kl            | 0.0132835265 |
|    clip_fraction        | 0.205        |
|    clip_range           | 0.2          |
|    entropy_loss         | -2.87        |
|    explained_variance   | 1.79e-07     |
|    learning_rate        | 0.001        |
|    loss                 | -0.258       |
|    n_updates            | 60           |
|    policy_gradient_loss | -0.0277      |
|    value_loss           | 0.113        |
------------------------------------------
Add(Sub(Constant(-10.0),Sub($open,Constant(-5.0))),Mean(Std(Mul(Mul(Mul(Mul(Constant(0.5),$volume),Constant(-0.01)),Constant(-2.0)),Constant(-30.0)),40),10))
$volume
Div(Med(Log(Sub(Mul($low,$volume),Constant(-1.0))),40),Constant(-30.0))
Add(Constant(10.0),Div(Div(Delta(Ref(Max($low,20),40),20),Constant(-2.0)),Constant(1.0)))
Mul(Sub(Constant(-30.0),$volume),Constant(0.5))
Mean(Greater(Add(Constant(-10.0),$volume),Div(Constant(0.01),$high)),50)
Log(Mul(Constant(10.0),WMA(Div($open,Constant(-0.01)),40)))
$open
Mul(Abs(Abs(Add(Std(Add(Constant(-1.0),Add($vwap,$low)),50),$close))),Mul(Mul(Mul($volume,Constant(-1.0)),$close),Constant(-30.0)))
Mean(Add(Constant(-2.0),$open),10)
Div(Mad($low,30),Sub(Constant(-2.0),Div(Sub($high,Constant(-1.0)),Constant(-30.0))))
Div(Sub(Var(Mul(Div(Mul(Abs(Mul(Constant(-1.0),$high)),Log(Add(Constant(10.0),$volume))),$high),$volume),30),$vwap),$vwap)
Mul(Mul(Sub(Add(Max(Add(Constant(2.0),Div(Greater($open,$low),$high)),10),$vwap),$low),Constant(-5.0)),Var($high,50))
$open
Mul(EMA(Sub(Constant(-2.0),Mul(Add(Mean(Div($close,Div($volume,$open)),50),Sub(Constant(2.0),$low)),Constant(-0.5))),40),Constant(-5.0))
Sub(Sub(Var(Sub(Constant(-2.0),Var(Max(Std(WMA($open,30),20),30),20)),20),Add($open,$open)),Constant(-30.0))
Log(WMA(Std(Mul(Constant(-0.01),$high),50),30))
Min(Add(Mean(Sub(Std(Add(Constant(1.0),Abs(Log($vwap))),50),Constant(0.5)),30),Std(Mul(Constant(-5.0),$close),10)),10)
Sub(Less(Sub(Constant(-2.0),Mul(Abs($vwap),Constant(30.0))),Constant(0.01)),$volume)
Mul(Abs(Abs($close)),Constant(2.0))
Mul(Add(Std(Mul(Constant(5.0),$high),20),Constant(-5.0)),Constant(-10.0))
Add(Std(Sub(WMA(Div(Constant(-5.0),$volume),40),Constant(-2.0)),50),Constant(0.5))
WMA(Mul(Add(Mul(Constant(-5.0),$volume),Div(Log(Div(Add(Constant(-10.0),Mul($high,Constant(10.0))),$low)),$open)),Constant(1.0)),10)
Sub(Add(WMA(Std(Div(Constant(-30.0),Mad(Less(Mul($volume,Constant(10.0)),Mul($volume,Constant(-0.5))),20)),40),30),$close),Constant(-0.5))
Sub(Constant(-30.0),Std($close,40))
Div(Mul(Std(Med(Std(Add(Log(Add(Constant(5.0),$high)),Constant(1.0)),50),50),10),Constant(30.0)),EMA($high,40))
Add(Greater(Constant(-5.0),Sub($high,$open)),Sub(Max(Add($low,Constant(-30.0)),50),Constant(10.0)))
Std(Mul(Add(Constant(5.0),Log($close)),Constant(0.01)),10)
Div(Constant(-0.01),Var(Sub(Med($open,20),Constant(-0.01)),50))
Log(Sum(Med(Log(Div(Constant(-0.01),WMA($high,50))),50),20))
Mul(Add(Mul($volume,Constant(0.5)),Constant(-5.0)),Constant(2.0))
Cov(WMA(Var(Log(Delta(Less($close,Div($low,Constant(-5.0))),30)),10),50),$low,50)
Div(Constant(-5.0),Med($close,40))
Var(Div(Constant(-10.0),Mul($volume,Constant(2.0))),10)
Div(Mul(Constant(-10.0),$close),Constant(0.5))
Mul(Mul(Mul($low,Constant(-1.0)),Constant(0.01)),Constant(2.0))
Less($open,Mul($vwap,Constant(-2.0)))
Delta(Add(Constant(-30.0),Div(Div(Mul(Mul(Mul(Add(Add($open,Constant(5.0)),$low),Constant(1.0)),Constant(2.0)),Constant(-0.01)),Constant(2.0)),Constant(5.0))),20)
Var(Med(Mul(Constant(-0.01),$close),40),50)
Sub(Med(Cov(Mul(Constant(-30.0),Mul(Delta(Sub($open,Constant(-1.0)),30),$low)),$volume,20),10),Constant(-0.5))
Add(Div(WMA(Mul(Add(Constant(5.0),$high),Constant(1.0)),40),Constant(-1.0)),Constant(2.0))
$vwap
Sub(Greater(Mul(Add(Constant(2.0),WMA($high,20)),Constant(0.01)),Constant(-2.0)),Sub(Med(Std($close,50),20),Sub(Constant(-1.0),$close)))
Mul(Constant(5.0),Med(Mul($volume,$vwap),40))
Abs(Div(Constant(-5.0),Add($close,Constant(2.0))))
$volume
Div(Constant(-30.0),$vwap)
Add(Greater(Greater(Constant(-1.0),$vwap),$close),Add(Std(Mul(Sub(Add(Less($open,Constant(-2.0)),$vwap),Constant(2.0)),$vwap),50),Constant(-30.0)))
Mul(Log(Var(Log(Add(Add(Sum(Add(EMA(Div(Constant(2.0),$close),20),Constant(-5.0)),30),Constant(-10.0)),Constant(10.0))),50)),Constant(-0.01))
Mul(Sum(Add(Constant(-30.0),Log($volume)),40),Constant(-5.0))
$high
Mul(Abs(Abs(Std($volume,20))),Constant(5.0))
Sub(Constant(-30.0),Div($vwap,Constant(-0.5)))
Mul(Sub(Constant(-2.0),Delta($close,50)),Constant(2.0))
$volume
WMA(Sub(Var(Div(Log(Mul(Sub(Constant(2.0),Log($open)),Constant(30.0))),Less(Div(Constant(5.0),$low),Constant(-5.0))),20),Constant(-2.0)),40)
Mul(Add(Constant(-10.0),Std(Add(Greater(Min(Sub($open,Constant(10.0)),50),Constant(-1.0)),$close),20)),Constant(-0.5))
Mul(Add(Constant(-30.0),Var($vwap,20)),Constant(-0.5))
Sub($close,Constant(-1.0))
$low
Sub($low,$low)
Mul(Constant(2.0),$low)
Mul(Mul(Constant(-10.0),Log(Mul(Less(Mul($volume,Constant(1.0)),Constant(-5.0)),Std(Min(Mul($vwap,$low),30),40)))),Constant(30.0))
Sub($open,Constant(1.0))
Div(Add(Greater(Constant(1.0),WMA(Add(Add($close,Constant(0.01)),Div(Constant(-1.0),$vwap)),10)),$volume),Mul(Med($close,10),Constant(0.01)))
Var(Sub(Div(Add(Constant(-0.01),$open),Constant(5.0)),Constant(-10.0)),30)
Min(Mean(Less(Add(Std(Add(Constant(-1.0),$volume),40),Constant(2.0)),Std(Std(Med($high,20),40),50)),50),10)
Add(Constant(-1.0),Sub($volume,$high))
Add(Cov(WMA(Std($vwap,40),30),Add($low,Less($close,$low)),10),Constant(2.0))
Sub(Add(Constant(-0.01),$vwap),$vwap)
Div(Constant(1.0),Abs(Var($high,30)))
Sub(Less(Mul(Mean(Add(Constant(-0.5),$volume),10),Constant(5.0)),Log($low)),Constant(-30.0))
Sub(EMA(Add(Constant(-10.0),Log($close)),10),Constant(-30.0))
$high
Sub(Add(Sum($vwap,50),Div($high,$high)),Constant(-2.0))
Mul(Add(Sub(WMA(Var(Add(Max(Add(Constant(5.0),$open),20),Std($vwap,30)),20),40),Constant(-1.0)),Constant(-5.0)),Constant(0.5))
Mul(Greater(Sub(Constant(-30.0),$close),Constant(10.0)),Mean(Mad(Sub(Div(Sub(Div($volume,Constant(1.0)),Constant(0.01)),Constant(30.0)),Constant(-5.0)),30),30))
Min(Add(Mul(Div(Constant(-30.0),Mul($low,$open)),Greater(Add(Sum(Div($open,Constant(-10.0)),10),Constant(-0.01)),Constant(-2.0))),Constant(1.0)),10)
Add(Div(Mul(Mul(Mul(Constant(-0.01),Var($volume,30)),Constant(-30.0)),Constant(0.01)),Constant(2.0)),Constant(-2.0))
WMA(Sub(Min(Sub(Constant(-0.01),Mul($close,Constant(2.0))),20),Constant(-30.0)),50)
$vwap
Sub(Sub(Constant(-0.5),Greater(Mul($low,Constant(30.0)),Mul(Std($close,50),Less(Div($open,Constant(-1.0)),Greater($volume,Constant(-10.0)))))),Constant(-5.0))
$vwap
Med(Std(Add(Constant(30.0),$high),30),30)
Sub(Constant(5.0),$vwap)
$close
Sub(Add(Less(Constant(5.0),$volume),$low),Std(Add(Sub(Mad($open,20),Add(Sub($vwap,$close),Constant(-0.01))),$low),50))
$low
Min($vwap,40)
Mul(Mean(Var(Add(Sub(Greater(Constant(-5.0),$vwap),Div(Less($low,Constant(2.0)),Add($vwap,$high))),Constant(-10.0)),40),20),Constant(-1.0))
Mean(Log(Sub(Constant(-0.01),WMA(Log(Abs(Mul(Add($vwap,Constant(-10.0)),Constant(-10.0)))),30))),30)
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104232632/16384_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.101       |
|    eval_cnt             | 6           |
|    significant          | 6           |
|    size                 | 6           |
| rollout/                |             |
|    ep_len_mean          | 14.1        |
|    ep_rew_mean          | -0.41       |
| test/                   |             |
|    ic                   | 0.0325      |
|    rank_ic              | 0.031       |
| time/                   |             |
|    fps                  | 45          |
|    iterations           | 8           |
|    time_elapsed         | 359         |
|    total_timesteps      | 16384       |
| train/                  |             |
|    approx_kl            | 0.012148114 |
|    clip_fraction        | 0.153       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.83       |
|    explained_variance   | 2.98e-07    |
|    learning_rate        | 0.001       |
|    loss                 | -0.262      |
|    n_updates            | 70          |
|    policy_gradient_loss | -0.0253     |
|    value_loss           | 0.122       |
-----------------------------------------
Mean(Div(Mul(Constant(2.0),$vwap),Sub(Sub(Constant(0.01),Mul($high,Add(Constant(-10.0),Log(Abs($volume))))),Constant(0.01))),30)
Add(Delta(Add($low,$low),50),Constant(2.0))
Abs(Ref(Add(Constant(-5.0),$high),50))
Div(Add(Div(Log($vwap),Constant(2.0)),$high),$close)
Max(Max(Add(Add(Sub($open,Mad(Mul(Constant(-0.5),$open),10)),$low),Constant(-1.0)),50),20)
Sub(Constant(10.0),$vwap)
EMA(Std(Sub(Constant(-1.0),Div($volume,Add(Constant(-0.5),Mul(WMA($high,10),Constant(-5.0))))),10),20)
Mul(Constant(-0.5),Sub(Mul(Greater(Sub($open,Constant(-10.0)),Constant(-1.0)),$high),$vwap))
Add(Log(Add(Std($volume,50),Constant(0.01))),Constant(0.5))
WMA(Var(Add(Constant(2.0),$low),20),50)
Add($volume,Add(Mul(Constant(-2.0),$close),Div(Constant(0.01),Mul(Div(Add(WMA($volume,10),Constant(5.0)),Constant(-0.5)),$close))))
WMA(Div(Add(Mul(Mul(Mul(Add(Constant(1.0),$vwap),Constant(10.0)),Std($low,40)),Constant(0.5)),Constant(-30.0)),Var($low,20)),10)
Sub(Abs(Div(Div($open,Constant(0.01)),Add(Constant(-5.0),$low))),$low)
Ref(Sub(Abs(Mul(Constant(1.0),$close)),Abs(Med($high,50))),30)
Div(Mad(Std(Std(WMA(Add(Mul(Log(Div(Constant(-5.0),$low)),Constant(30.0)),Constant(-30.0)),50),40),30),20),Constant(2.0))
Mul(Sub(Sub(Add(Add(Greater(Constant(-5.0),Add(Less($close,Constant(-5.0)),$vwap)),Sub($low,Constant(5.0))),$high),$low),$high),Constant(30.0))
Abs(Add($high,Sub(Greater(WMA(Abs(Add(Constant(-1.0),$volume)),50),$high),$vwap)))
Add(WMA(Corr(Ref(Mul(Constant(-30.0),$close),20),$volume,10),10),Constant(1.0))
Add(Mul(Constant(-2.0),$low),Constant(0.5))
Max(Abs(Sub(Sub(Div($volume,Constant(0.01)),Constant(-0.01)),Mul(Constant(-5.0),Div(Div(Add(Log($low),Constant(0.01)),$high),Constant(30.0))))),20)
Mul($open,Constant(-0.01))
Add($close,Constant(5.0))
Sub(WMA(Sub(Constant(1.0),$volume),30),Sub(Div(Sub($close,Log($low)),Constant(-5.0)),$high))
Sub(Mul(Constant(2.0),$vwap),Constant(-0.01))
Add(Constant(-10.0),$close)
Med(Add(Sub(Std(Div(Div(Sub($volume,Constant(10.0)),Constant(-5.0)),Constant(-0.5)),20),Mul(Mul($volume,Constant(-0.5)),Constant(-2.0))),Constant(2.0)),20)
Sub(Constant(-30.0),$vwap)
Sub(Add(Add(Var(Add(Less(Constant(-2.0),$volume),$high),50),Constant(1.0)),Constant(-10.0)),Constant(-0.01))
Sub(Log(Add(Constant(-10.0),$low)),$close)
Mul(Constant(0.5),Sub($vwap,Constant(-30.0)))
$close
Sub(Min(Sub(Add($volume,Constant(-1.0)),$vwap),10),Std(WMA(Var($high,50),50),10))
Add($low,Constant(5.0))
Div(Less(Sum(Mul(Sum(Sub(Constant(-2.0),Std(Mul($close,Constant(-30.0)),40)),50),Constant(-2.0)),50),Constant(-5.0)),Log($volume))
Sub(Constant(-2.0),$high)
Var(Std(Div(Less(Max(Mul(Constant(1.0),$vwap),30),Add(Constant(-10.0),$low)),$volume),10),40)
Mul(Less(Constant(-0.01),Sub($close,Constant(5.0))),$open)
Sub(Div(Mad($low,40),Constant(1.0)),Constant(2.0))
Sum(Sub(Add(Std(Sub(Constant(-0.01),$vwap),20),Constant(10.0)),Mul($low,Constant(5.0))),30)
WMA(Mul(Add($close,Mul(Constant(-0.01),Add(Mul(Add(Min($close,40),Constant(2.0)),Constant(-2.0)),Constant(-5.0)))),Div(Constant(1.0),$vwap)),50)
Add(Log($volume),$high)
Mul(Constant(-10.0),Add($low,$low))
$vwap
Sub(Std(Log(Sub(Constant(5.0),$low)),30),Less($volume,Constant(-1.0)))
Mul(Mul(Constant(5.0),$low),Sub(EMA($open,30),$vwap))
Abs(Mul(Add(Constant(-5.0),$high),Constant(-2.0)))
Sub(Div(Mean($high,20),Mul(Constant(2.0),$close)),Constant(-30.0))
$vwap
Div(Constant(-30.0),$close)
$volume
Mul(Constant(-5.0),Std(Add($low,Mean(Sub(Abs(Std($vwap,10)),Constant(0.01)),40)),20))
Div(Constant(0.01),$vwap)
Add(Constant(30.0),$close)
Add(Constant(-5.0),Abs(Std(Med(Log(Abs(Sub(Log(Std(Add($close,Less(Constant(2.0),$open)),10)),$open))),20),50)))
Sub(Constant(-0.01),Abs(Mul($vwap,Constant(10.0))))
Mul($vwap,Med($vwap,10))
Sub(Add(Greater(Log(Log(WMA(Greater(Mul(Constant(1.0),$volume),Add($volume,$vwap)),50))),Constant(-30.0)),$low),Constant(-1.0))
Add(Constant(0.01),Sub($low,Greater(Less(Var($open,50),Constant(-0.5)),Var(Mul(Add(Abs($close),Constant(-10.0)),Constant(-0.5)),40))))
Mul(Div(Mean(Var(Div(Add(Log($close),Mul($high,Log(Mul(Constant(-1.0),$vwap)))),Constant(-5.0)),40),40),$high),Constant(0.01))
Med($vwap,30)
Log(Sub(Greater(Mul(Constant(-0.5),Sum(Log($low),30)),Constant(1.0)),Sub($high,Constant(0.01))))
Sub(Constant(-0.5),$open)
Mul(Constant(2.0),$vwap)
Mul(Log(Min(Mul(Constant(2.0),Sub(Max(Log($open),50),Constant(-1.0))),30)),Sub(Constant(-5.0),Add(Add($volume,Constant(-30.0)),Constant(-10.0))))
Add(Add(Mul(Add(Constant(-30.0),Sub(Var(Add(Add(Mul($volume,Constant(5.0)),Constant(0.01)),Constant(1.0)),10),Constant(-0.01))),Constant(10.0)),$high),Constant(-5.0))
Div(Div(Constant(2.0),Max($volume,40)),Constant(-2.0))
Sub(Less(Add(Constant(1.0),Add(Add(Div(Abs($low),Constant(5.0)),Constant(5.0)),Constant(-2.0))),Constant(0.01)),$vwap)
Mean(Div(Mad(Add(Constant(2.0),Add(Mul($low,Constant(10.0)),Constant(-0.5))),20),Sub(Sub(Constant(2.0),Add($volume,Constant(-0.01))),Constant(-5.0))),20)
$close
Mul($vwap,Sub(Add(Mad(Abs($vwap),20),$volume),Constant(1.0)))
$open
Mad(Mul(Div(Greater($open,Constant(-30.0)),$high),Constant(5.0)),30)
Sum(Mean(Sub(Constant(-1.0),$high),10),20)
Div(Mul(Add(Sub(Div(Ref($volume,40),Constant(10.0)),Constant(-2.0)),Constant(2.0)),$vwap),Mul(Mul($volume,Add($volume,Constant(-0.5))),Constant(10.0)))
Ref(Abs(Div(Sub(Constant(-2.0),$vwap),Constant(30.0))),10)
WMA(Mul(Constant(2.0),Sub($vwap,Constant(30.0))),40)
Mul(Constant(-0.01),$high)
Std(Add(Cov(Less($volume,$low),$high,30),Constant(-30.0)),50)
Std(Add(Sub(Std(Sub(WMA(Add(Constant(10.0),$vwap),10),Mul(Constant(-0.5),Add($high,Constant(30.0)))),40),$high),Constant(10.0)),10)
$open
Div(Constant(1.0),Less(Div($high,Mad($high,30)),$vwap))
Mul(Sub(Constant(-10.0),Sub($low,Div(Mul(Constant(0.01),Add($volume,Add(Constant(-30.0),$vwap))),Div(Sub($high,$close),Constant(-0.5))))),$low)
Div(Greater($volume,Constant(-10.0)),$open)
Var(Med(Sub(Var(WMA($volume,20),50),Div($low,Log($vwap))),20),30)
Med(Div(Mul(Constant(-0.01),$volume),Constant(10.0)),30)
Sub(Mul(Div(Constant(2.0),Med($volume,20)),Sub(Constant(-0.5),$close)),Mul(Constant(5.0),$close))
Max(Mul(Add(Sub(Constant(0.01),Mul(Mad($close,30),Constant(30.0))),Constant(10.0)),Constant(0.01)),20)
Min(Max(WMA($volume,10),30),10)
Add(Mul(Constant(30.0),$close),Constant(-10.0))
Log(Div(Mul(Constant(-10.0),Mul(Max($volume,10),Greater(Constant(-5.0),Sub(Add($volume,Constant(-2.0)),Constant(-30.0))))),Constant(-5.0)))
EMA(Mad(Div(Div(Constant(-0.01),Add($low,Sub(Constant(-0.5),$low))),Var($volume,10)),10),50)
Add(Constant(-2.0),Log($high))
Mul(Constant(0.01),$close)
Add(Constant(-0.5),$open)
Mul(Std(Mul(Max($low,50),Div(Sub(Abs($high),Constant(2.0)),Constant(10.0))),30),Constant(-2.0))
Add(Add(Constant(30.0),Log(Std(Add(Mul($close,Constant(-0.01)),Constant(1.0)),50))),Add(Constant(0.01),Add($volume,Constant(-0.5))))
Delta(Div(Mul(Add(Constant(30.0),Div(Ref($open,10),Constant(0.5))),Constant(2.0)),$close),30)
Cov(Log(Add(Var(Add(Constant(-2.0),Cov($low,Div(Constant(1.0),$open),10)),10),$high)),Abs(Abs($close)),30)
Mul(Constant(1.0),$high)
Sub(Constant(30.0),Mul(Greater(Div($low,Greater(Mul(Constant(-2.0),$low),Constant(-0.01))),Less(Constant(-0.5),$volume)),Var($vwap,10)))
Add(Mul(Constant(1.0),$volume),Constant(-0.01))
Add($open,Constant(-2.0))
Min(Mul(Constant(-1.0),$vwap),20)
Add(Constant(2.0),$volume)
Mul(Var($volume,10),Constant(-2.0))
Max(Div(Constant(0.5),Log($volume)),50)
Min(Max(Mul(Add(Constant(-5.0),Var(Std($high,40),50)),Div(Constant(-0.01),$open)),30),20)
Mul(Constant(2.0),Less(Sub(Sub(Mul(Sub($close,Constant(-1.0)),Mul($high,Constant(0.5))),Mul(Constant(5.0),$low)),Constant(-0.01)),Mul(Constant(5.0),$high)))
$vwap
WMA(Add(Mul(Var($vwap,30),Div($vwap,Constant(-10.0))),Constant(0.5)),10)
Mul(Add(Greater(Greater(Constant(0.01),$volume),$low),$low),Constant(2.0))
Add(WMA(Mul(Less(Constant(-30.0),Med($high,50)),Div($open,Constant(-0.01))),50),Greater(Med($volume,30),Constant(0.5)))
Mul(Sub($volume,Constant(1.0)),Log($vwap))
Delta(Sub(Add($volume,$open),Constant(10.0)),10)
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104232632/18432_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.101       |
|    eval_cnt             | 6           |
|    significant          | 6           |
|    size                 | 6           |
| rollout/                |             |
|    ep_len_mean          | 13.2        |
|    ep_rew_mean          | -0.29       |
| test/                   |             |
|    ic                   | 0.0325      |
|    rank_ic              | 0.031       |
| time/                   |             |
|    fps                  | 44          |
|    iterations           | 9           |
|    time_elapsed         | 410         |
|    total_timesteps      | 18432       |
| train/                  |             |
|    approx_kl            | 0.011920925 |
|    clip_fraction        | 0.16        |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.79       |
|    explained_variance   | 1.19e-07    |
|    learning_rate        | 0.001       |
|    loss                 | -0.249      |
|    n_updates            | 80          |
|    policy_gradient_loss | -0.0276     |
|    value_loss           | 0.135       |
-----------------------------------------
EMA(Add(Med($high,20),Std($volume,30)),10)
Sub(Std(Std($close,50),30),Constant(-1.0))
Sub(Mul(Med(Sum(EMA(Mul(Constant(-10.0),Add($vwap,Mul(Constant(30.0),Add($close,$low)))),10),40),50),Constant(-10.0)),$vwap)
Cov(Div(Add(Mul(Constant(-5.0),$high),Constant(-10.0)),$high),Sub($volume,Constant(5.0)),40)
Mul(Add(Constant(1.0),$low),Var($open,10))
Std(Add(Constant(0.01),Mul(Sub($low,$close),Constant(5.0))),20)
Div(Mul(Constant(-1.0),Div(Add($close,Sum($volume,50)),Constant(0.5))),Log($vwap))
Sub(Constant(-5.0),$vwap)
$vwap
Log(Abs($close))
Add(Corr($open,$low,20),$low)
Div(Constant(0.01),Mul(Sub(Add($low,Constant(0.5)),Constant(-1.0)),Constant(-0.01)))
Add(Constant(-2.0),Add(Add(Add($vwap,Constant(30.0)),Constant(0.5)),Var($close,10)))
Sub(Sum(Sub(Constant(-10.0),$volume),50),Add(Mul($close,Constant(-0.01)),Constant(-0.01)))
Mean(Mul(Constant(-1.0),$high),20)
Std(Add($close,Constant(2.0)),50)
Var($low,30)
Sub(Constant(-30.0),$low)
Sub(Constant(30.0),$close)
Std(WMA(Mul(Sub(Constant(0.01),$open),Constant(-1.0)),20),10)
Mad(WMA(Sub(Less(Add(Log(Div(Constant(-1.0),$low)),Constant(2.0)),Constant(1.0)),$low),50),50)
Sub(Sub(Div($volume,Div(Less($close,Constant(10.0)),$volume)),$close),Constant(-0.01))
Add(Constant(-30.0),$vwap)
WMA($open,20)
$low
Log(Add($vwap,Constant(0.01)))
Std(Sum(Mul(Add(Sub(Sub(Constant(5.0),Div($close,Mul($open,Constant(30.0)))),$vwap),Constant(-30.0)),Add($low,Constant(-0.5))),20),10)
Abs(Mul(Add(Constant(5.0),WMA($low,40)),Mul($vwap,$high)))
WMA(Sub(Mul(Var(Sum(Add(Constant(-0.5),Add($vwap,Constant(30.0))),30),50),Log($volume)),Constant(-30.0)),40)
EMA(Mean(Mad(Add(Constant(0.01),$volume),30),20),10)
Mul(Constant(-5.0),$low)
Med(Add(Sub(Constant(-5.0),$high),Constant(0.5)),40)
Mul(Std($low,10),Constant(-0.5))
Max(Mul(Greater(Constant(-0.01),$low),$open),40)
Sub(Mul(EMA(Log(Sub(Mad(Div(Log(Div(Constant(5.0),Add($high,Constant(-2.0)))),Constant(5.0)),10),Constant(-5.0))),30),$close),Constant(0.01))
Add(Greater(Mul(Constant(-2.0),$volume),Constant(-0.01)),Sub($vwap,$high))
Add(Max(Mul(Constant(-1.0),$volume),10),Constant(30.0))
Var(Div(Greater($volume,Constant(0.01)),$low),20)
Div(Mul(Mul(Add(Add($volume,$low),Constant(0.5)),Constant(-1.0)),Constant(-2.0)),Constant(-1.0))
Mul(Med(Med(Mul(Sub(Constant(10.0),Std($high,50)),Constant(-5.0)),40),20),Constant(0.01))
Mul(Add(Constant(0.01),$low),Constant(30.0))
Div(Mul(Constant(-0.01),WMA($high,20)),Constant(0.5))
Div(Max(Sub($open,Sub(Mul(Mul($volume,Constant(-1.0)),Constant(-0.5)),Constant(0.5))),20),Constant(-2.0))
Mul(Sub(Mul(Abs(Var(Add(Add(Var($open,50),Mul(Constant(-1.0),$vwap)),Constant(-5.0)),40)),Constant(-1.0)),Constant(30.0)),Constant(2.0))
Mul(Sum(Sum(Sub(Std(Sub(Div(Constant(2.0),$volume),Div($open,$low)),10),$open),50),20),Constant(0.01))
Std(Mul(Constant(10.0),Add(Max($close,10),Constant(10.0))),30)
Add(Constant(2.0),$low)
Sub($close,Constant(2.0))
EMA(Sub(Constant(-1.0),WMA(Max($volume,30),20)),20)
Med($low,20)
Mul($high,Add(Sub($volume,$low),$low))
Sub(Mul(Constant(10.0),$high),$volume)
Abs(Sub($open,Constant(0.5)))
Std(Ref(Var(Max(Div(Constant(-2.0),Mad($high,10)),20),40),30),40)
Var(Log(Add(Abs(Delta(Sub(Constant(0.01),Std(Less(WMA($high,40),$vwap),30)),10)),Sub($high,Constant(-1.0)))),10)
Std(Add(Constant(-1.0),$open),50)
$high
Std(Mad(Abs(Div($vwap,Constant(-30.0))),50),10)
Delta(Mul(Mul(Div(Constant(-10.0),$open),Add(Constant(-5.0),$low)),WMA(Mul(Constant(-0.01),Abs(Add($open,$vwap))),40)),20)
Less(Med(Sub(Constant(-1.0),$low),20),$volume)
Cov(Div(Sub(Sub(Var(Add(Constant(2.0),$volume),20),Constant(-5.0)),Constant(-1.0)),Sub(Constant(-0.01),$vwap)),Abs(Div($high,Constant(1.0))),40)
Sub(Add($open,Mul(Greater($vwap,Constant(5.0)),$volume)),Constant(0.5))
Add(Constant(2.0),Mul($vwap,$low))
Mul(Greater(Mul(Mul(Add(Constant(-5.0),$open),Constant(-10.0)),Constant(1.0)),Constant(-1.0)),$high)
Mul(Constant(-2.0),Var($low,10))
$high
Sub(Constant(-0.01),$close)
Mad(Mul(Div(Sum(WMA(Med(Mul(Constant(-0.5),Mul($vwap,Constant(-30.0))),30),10),10),Mul(Constant(-0.01),$vwap)),Constant(-2.0)),30)
Div(Constant(5.0),Add(Min(Div(Add(Med($open,10),Sub($high,Add($vwap,Constant(-5.0)))),Log($volume)),20),Constant(-5.0)))
Sub(Mul(Max(Mul(Constant(-30.0),$low),20),Std(Mul(Mul(Constant(0.01),Min($high,10)),Constant(-0.01)),20)),Constant(-0.01))
Mul(Less(Sub(Add($open,Constant(-5.0)),Add(Add(Constant(-0.5),$high),Constant(0.01))),Constant(1.0)),Med(Log($close),50))
$open
Abs(Mul(Sum(Mul(Constant(30.0),Max(Add($high,$open),10)),10),Constant(-2.0)))
Sum(Mul(Sum(Std(Sub(Constant(-2.0),$volume),10),30),Constant(-0.5)),30)
Div($open,Constant(-1.0))
Mul(Less(WMA(Add($volume,Greater($volume,Constant(0.01))),10),Constant(-30.0)),Min($low,50))
Std(Std(Mul($volume,Constant(5.0)),20),10)
Add(Div(Mean($volume,20),Constant(-30.0)),Constant(5.0))
Div(Constant(5.0),$volume)
Div(Mul(Abs($volume),$open),Add(Mul(Var(Add(Constant(-30.0),$high),50),Constant(-30.0)),$low))
WMA(Add(Add(Med(Max(Div(Constant(0.01),$volume),10),30),$low),Ref($close,30)),20)
Std(Mul(Mul(Div(Sub(Mul(Constant(-1.0),Div(Std(Max($vwap,20),10),Constant(-30.0))),Constant(30.0)),$volume),$low),Constant(0.01)),10)
Add(Sub(Constant(10.0),$close),Sub(EMA(Add(Mul($high,$low),Abs($volume)),50),$vwap))
Log(Mul(Constant(-2.0),$volume))
Sub(Mul(Less(Constant(-2.0),Mul($close,Constant(5.0))),Abs($close)),Constant(-0.01))
Mul(Add(Constant(0.01),Div($close,Greater(Constant(-1.0),Std($volume,50)))),Constant(-1.0))
Sub(Add(Constant(-10.0),Log(Abs(Ref($vwap,10)))),Log($low))
Add(Constant(-0.01),$high)
Add(Std(Med(Med(Sum(Add(Constant(30.0),Std($high,40)),20),20),30),10),Mul(Mul($open,Constant(-30.0)),Constant(0.01)))
$open
Sub(Mul(Constant(2.0),$high),Constant(0.01))
Mul(Constant(2.0),$high)
Add(Mul(Constant(-2.0),$high),Div(Add(Max($close,20),Constant(5.0)),Constant(5.0)))
Max(Abs(Sub(Mul(Greater(Constant(0.01),Std(Mul($vwap,Log($high)),20)),Min($close,20)),Add($open,Constant(1.0)))),50)
Mul(Ref(Add(Constant(-10.0),Mul($volume,Constant(2.0))),30),Sub(Constant(-30.0),Mul($low,$low)))
Div(Sum($open,10),Mul($low,Constant(-2.0)))
Add(Less(Min(Add(Constant(10.0),$vwap),30),Sub(Var($vwap,10),$high)),Sub($high,$vwap))
Mul(Constant(30.0),$vwap)
$close
Max(Sub(Med(Mean(Sub(Std(Add(Mul(Mul($volume,$vwap),Constant(-5.0)),$low),10),$open),20),40),Constant(-30.0)),10)
Add(Constant(-2.0),$close)
Add(Constant(-10.0),Mul(Add($open,Constant(5.0)),$low))
Mad(Mul(Constant(2.0),Div($low,Constant(0.01))),20)
Mul(Constant(1.0),Std($volume,20))
Mul(Greater(Abs(Mul(Constant(-5.0),$volume)),Add(Less(Constant(5.0),$volume),$low)),Constant(10.0))
Sub(Add(Constant(2.0),Sub(Add($open,Constant(-30.0)),Constant(-0.01))),$open)
Var(Sub(Less(Constant(-1.0),Mul(Less(Std($low,20),Constant(-2.0)),Sub(Delta($high,30),Constant(0.01)))),$vwap),40)
Mul(Div(Sub(Constant(30.0),Sub(EMA($close,20),$close)),$volume),Constant(-5.0))
Sub(Mul(Div(Constant(30.0),$high),Mul(Constant(-5.0),$volume)),Constant(0.01))
Div(Constant(-1.0),$volume)
Mad(Div(Constant(-10.0),$open),40)
$close
Mul(Constant(-30.0),Div($high,Constant(-30.0)))
Mul(Constant(2.0),$low)
Sub(Mean(Mul(Sub(Div(Constant(-0.5),$low),Sum(Std($open,50),50)),Mul($high,Constant(30.0))),20),Constant(5.0))
Mul(Max(Min(Div(Sub(Constant(-30.0),$high),$vwap),50),40),Constant(-0.01))
Sub(Constant(-2.0),Var(Add($high,Add($vwap,Constant(0.01))),50))
Add($low,Less(Div(Constant(-1.0),Min(Mul(Sub(Var($close,30),Constant(-10.0)),Constant(-30.0)),30)),Sub($open,Constant(-0.5))))
Mul(Constant(-0.01),Greater($close,$high))
Std(Add(Sub(Div(Constant(5.0),$open),Constant(2.0)),$volume),40)
Div(Sub(Med(Div(Mul(Sub(Constant(-0.01),Div($close,Constant(2.0))),WMA($vwap,20)),$high),40),Constant(0.5)),Add(Constant(2.0),$high))
Add(Div(Min(WMA(Mul($volume,Constant(1.0)),10),40),Div($low,Constant(30.0))),Constant(-10.0))
Sub(Sub(Mul(Sub(Mul(Constant(-10.0),$high),$vwap),Constant(2.0)),Constant(-1.0)),Div(Add($volume,Constant(-5.0)),Constant(2.0)))
Sub(Sub(Less(Mul(Std(Mul(Mul(Constant(0.5),Add(Med($high,30),Constant(1.0))),Constant(-10.0)),30),Constant(-5.0)),$high),Constant(2.0)),$volume)
WMA(Sub(Less(Sub($vwap,Constant(-10.0)),Constant(-5.0)),$low),40)
Mul(Std(Med(Div(Sub(Add(Constant(-0.01),$low),Constant(-1.0)),Constant(2.0)),30),20),$high)
Add(Mul(Constant(5.0),$high),Constant(-30.0))
$low
Mean(Sub(Add(Constant(-0.5),Med(Div(Less($close,Mul($volume,Constant(-5.0))),Constant(-5.0)),20)),$vwap),20)
Sub(Mad(Mul(Min(Mul(Add(Constant(5.0),$low),Constant(-30.0)),10),Mean($volume,30)),20),Constant(-30.0))
Var(Log(Mul(Add(Constant(-10.0),$open),$close)),10)
$close
Add(Constant(2.0),$open)
Add(Max(Add(Sub(Mul(Mul(Constant(30.0),$volume),Constant(-0.5)),Sub(Mul(Div($open,Constant(10.0)),Constant(10.0)),Constant(5.0))),Constant(0.01)),10),Constant(-0.01))
Sub($low,Constant(-2.0))
Mean(Mul(Add(Constant(5.0),Add($high,$high)),$volume),50)
Add(Add($vwap,Constant(2.0)),Constant(2.0))
Med(Div(Constant(-0.5),Div(Sub(Add($open,Constant(30.0)),$high),Constant(10.0))),10)
Mul(Constant(0.01),Div($low,Std(Cov(Sub($volume,Constant(5.0)),Less(Sub(Constant(2.0),$volume),Add(Constant(-2.0),$high)),50),10)))
Div(Mad(Sub(Med(Max(Div(Add(Constant(5.0),$high),Less(Constant(1.0),$close)),50),40),Constant(-1.0)),40),Constant(-0.5))
$close
Add(Log(Mul(Constant(0.5),Mul(Min(Mul(Div($low,$vwap),$low),40),Constant(30.0)))),Add($vwap,Constant(-2.0)))
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104232632/20480_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.101       |
|    eval_cnt             | 6           |
|    significant          | 6           |
|    size                 | 6           |
| rollout/                |             |
|    ep_len_mean          | 12          |
|    ep_rew_mean          | -0.14       |
| test/                   |             |
|    ic                   | 0.0325      |
|    rank_ic              | 0.031       |
| time/                   |             |
|    fps                  | 44          |
|    iterations           | 10          |
|    time_elapsed         | 462         |
|    total_timesteps      | 20480       |
| train/                  |             |
|    approx_kl            | 0.013329009 |
|    clip_fraction        | 0.179       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.74       |
|    explained_variance   | 2.38e-07    |
|    learning_rate        | 0.001       |
|    loss                 | -0.238      |
|    n_updates            | 90          |
|    policy_gradient_loss | -0.0282     |
|    value_loss           | 0.129       |
-----------------------------------------
Mean(Sub(Constant(-5.0),$close),20)
Mul(Cov(Std(Mul(Constant(0.01),$volume),20),$high,40),$low)
Add(Constant(30.0),WMA($close,40))
Sub(Min(Mul(Div(Std(Div(Constant(-10.0),Ref($vwap,30)),10),Constant(1.0)),Constant(-5.0)),20),Constant(2.0))
WMA(Mean(Add(Less(Greater(Log($close),Constant(-2.0)),Sub(Add(Mul($volume,Constant(0.5)),Constant(2.0)),Constant(-0.01))),Log($low)),20),10)
Mean(Log(Med(Div(Mul(Constant(0.5),$low),Constant(-2.0)),50)),20)
Mul(Less(Constant(10.0),Add($close,Var($open,10))),$low)
Div(Div(Log(Sub($high,Constant(1.0))),$high),Constant(2.0))
Log(Sub($volume,Sub($open,Constant(-30.0))))
Sub(Div(Abs(WMA(Add(Log(Var(Mul(Greater(Constant(5.0),$close),$vwap),30)),$open),20)),Constant(30.0)),$low)
Med(Mul(Constant(-1.0),Add($volume,Constant(-10.0))),30)
Sub(Div(Div(Constant(-0.5),$close),$vwap),Sum($close,30))
EMA(Add(Sub(Constant(-10.0),Delta($open,50)),Mul(Constant(5.0),$volume)),50)
Div(Mul(Sum(Add(Constant(0.01),$open),10),Constant(-5.0)),Constant(5.0))
$open
Sub(Constant(5.0),Abs(Max($low,20)))
Div(Add(Sub(Constant(5.0),Div($low,Add($close,Mul(Mul(EMA(Mul($volume,Constant(2.0)),30),Constant(10.0)),Constant(2.0))))),Constant(-1.0)),Constant(-10.0))
Mul(Add(Max(Div(Constant(-5.0),Corr(Add($vwap,$vwap),$volume,40)),20),Constant(10.0)),Constant(0.01))
Mul(Add(Add(Constant(-30.0),$low),Constant(-1.0)),Constant(-30.0))
Var(Add(Max(Corr(Add(Mean($vwap,30),$volume),Mul($high,Log(Var($high,10))),50),10),$volume),40)
Add(Constant(-2.0),$low)
Add(Constant(-10.0),Add(Sub(Greater($open,Constant(-30.0)),Mul(Abs(Sub($open,Less($close,$volume))),Constant(-30.0))),Constant(-2.0)))
WMA(Sub(Greater(Div(Min(Mad($volume,30),30),Mean(Sub(Constant(0.01),$volume),20)),Constant(-1.0)),Abs($open)),20)
$close
Mul(WMA(Div(Add(Abs(Mul($high,Constant(-1.0))),Add($vwap,Constant(0.01))),Constant(2.0)),10),Constant(5.0))
Var(Div(Constant(1.0),Div(Abs($low),Constant(1.0))),10)
Add(Add(Mul(Div(Max(Div(Constant(0.01),$vwap),30),$close),$low),Constant(-0.01)),Constant(0.01))
EMA(Add(Mul(Constant(-10.0),$open),Constant(1.0)),50)
Div(Mul(Less(Constant(-5.0),$open),$vwap),Var(Div(Constant(1.0),Mul($open,$volume)),50))
Max(Sub(Constant(-0.5),$low),40)
Div(Constant(-0.01),$low)
Sub(Constant(-2.0),Add(Greater($volume,Constant(5.0)),$high))
Mul(Mul(Med(Add($high,Constant(0.5)),40),Constant(-10.0)),Constant(30.0))
Add($low,Constant(-10.0))
Div(Sub(Greater(Constant(0.5),$high),Std(Add(Sub(Mul($high,Greater($open,Constant(-2.0))),Constant(-30.0)),Var($vwap,10)),20)),Constant(-0.01))
Sub(Mul(Constant(1.0),$vwap),Constant(-10.0))
Var(Sum(Std($close,40),10),20)
Div(Sub(Constant(0.01),Mad($low,10)),$high)
Mul(Constant(-2.0),$vwap)
Div(Less($volume,Constant(-10.0)),$vwap)
Var(WMA(Div(Delta(Std(Sub(Mul(Med($vwap,50),Constant(5.0)),Med($vwap,30)),40),50),Constant(-5.0)),40),20)
Mul(Mad(Abs(Mul(Add(Ref(Add(Constant(5.0),Sub($close,Constant(30.0))),20),$volume),Constant(10.0))),20),Constant(-1.0))
Sub(Sum(Add(Constant(30.0),$volume),10),$low)
Sub(Mean(Mul(Constant(-0.5),$vwap),40),Constant(0.01))
Mul(Std(Add(Med(Add(Constant(-2.0),Add($vwap,Constant(-30.0))),30),$close),20),Constant(-5.0))
$low
Add(Constant(2.0),$close)
EMA(Sum(Mul(Max(Sub(Constant(1.0),Div(Log($volume),Mean($high,30))),20),$open),20),30)
Add(Greater(Ref($close,20),Constant(2.0)),$vwap)
Mad(Mean(Div(Constant(0.01),$close),30),10)
$low
Add(Add(Constant(-10.0),Log(Sub(Abs($vwap),Constant(10.0)))),Constant(0.01))
$low
Var(Add(Less(Add(Constant(-30.0),$close),Constant(0.5)),$volume),30)
$high
Add(Constant(-30.0),Sub($volume,$low))
Mean(Mul(WMA(Add(Abs(Sub(Constant(0.01),$volume)),Constant(-0.5)),20),Constant(-30.0)),10)
Std(Sub(Var(Std(Mean(Add(Constant(2.0),$volume),20),20),30),Constant(-0.5)),20)
Std(Add(Constant(-1.0),$low),50)
Mul(Add(Constant(2.0),Div($vwap,Add(Constant(-0.5),$vwap))),Mul(Mul(EMA(Sub(Constant(-30.0),Mul($high,$vwap)),10),$volume),Constant(-0.01)))
$volume
Div($close,Constant(-10.0))
$high
Div(Less(WMA(Mul(Constant(1.0),$high),10),Constant(30.0)),$volume)
Abs(Mul(Sub(Sum(Std(Mad(Mul(Add(Sub(Constant(2.0),$high),$volume),Constant(0.5)),10),30),20),$open),Constant(10.0)))
Div(Mul(Constant(-2.0),Mul($open,Add(Sub($high,Mul($volume,Constant(0.01))),Constant(0.01)))),Constant(1.0))
Min(Div(Constant(-10.0),$high),40)
Sub(Constant(-1.0),Mul(Ref($open,40),Constant(-30.0)))
Mul(Constant(-1.0),$close)
Add(Add(Mul(Sub($volume,Constant(0.5)),Constant(1.0)),Div(Mad(Mul($high,Constant(10.0)),30),Constant(1.0))),Constant(5.0))
Mul(Mul($high,Add(Var(Add(Constant(-2.0),Log(Delta(Mad(Add(Abs($low),Constant(-30.0)),20),30))),50),Constant(2.0))),$vwap)
Sub(Mul(Constant(-0.01),$open),$volume)
Mul(Mean(Sub(Add(Max(Abs(Mul(Mul(Constant(0.01),Min(Log($low),20)),$low)),20),Constant(0.01)),Constant(-10.0)),30),Constant(-1.0))
Mul(Constant(-1.0),$low)
Var(Add(Constant(-1.0),Add(Add(Med(Add($high,Add($volume,Constant(2.0))),20),Constant(-5.0)),Constant(0.5))),30)
Add(Greater(Less(Std(Div(Constant(-0.01),$low),50),Add(Constant(-30.0),$low)),Constant(30.0)),Std($volume,20))
$close
Mul(Add(Med(WMA(Max($low,10),20),10),$low),Constant(2.0))
Var(Add($close,Constant(-5.0)),10)
Sub(Sub(Add(Add(Constant(-10.0),$volume),Constant(0.01)),Constant(1.0)),Constant(1.0))
Log(Mul(Log(Div(Constant(-1.0),Add(Sub($open,Mul($open,Constant(5.0))),Constant(0.5)))),Constant(-1.0)))
Add(Max(WMA(Mad(Div(Div(Add(Mul(Constant(-2.0),Sub($close,$high)),Constant(10.0)),Constant(1.0)),Constant(-30.0)),40),20),10),Constant(0.01))
Mul(Mul(Constant(30.0),Sub($vwap,Constant(-30.0))),Constant(-1.0))
WMA(Sub(Mul(Sub(Std(Mul(Constant(-30.0),Mad($low,40)),10),Constant(-2.0)),Constant(1.0)),Constant(-30.0)),20)
Div(Greater(Constant(-10.0),$vwap),$vwap)
Sub(Greater(Add($open,$vwap),$close),$low)
Mean(WMA(Mul(Delta(Sub(Min(Mul(Greater(Constant(30.0),$close),$open),50),Constant(1.0)),50),Constant(1.0)),20),10)
Sub(Constant(-1.0),Add($close,$low))
$open
$low
Add(Div(Abs($low),Constant(-10.0)),Constant(-1.0))
Sub(EMA(Sum(Div(Std(EMA(Mul(Constant(0.5),$vwap),20),10),$open),10),50),Constant(1.0))
$close
Add(Constant(-10.0),Mul(Less($close,$low),Constant(0.01)))
Sub(Log(Add(Constant(2.0),Delta($low,20))),$high)
Sub(Constant(0.5),Mul($low,Add(Constant(1.0),Med(Add($low,Constant(10.0)),40))))
Add(Mul(Constant(30.0),Mul($low,$vwap)),Constant(0.01))
Log(Mul(Less(Constant(-30.0),Var(Sub(Div($volume,Constant(0.01)),Constant(0.01)),40)),$high))
Add($low,Constant(30.0))
EMA(Div(Constant(10.0),Mul($high,Sub(Mul(Constant(-1.0),$vwap),$high))),20)
Add(Mean(Ref(Add(Constant(-5.0),$volume),50),20),Constant(2.0))
Add(Mul(Add(Sub(Add(Less(Sub(Mul(Add(Constant(2.0),$volume),$high),Constant(-2.0)),Constant(30.0)),$open),Constant(0.01)),$close),Constant(-1.0)),Constant(-1.0))
Sub(Mul(Add(Mul(Less(Constant(-1.0),$volume),Var($volume,10)),$volume),Constant(2.0)),Constant(0.01))
Div(Greater(Add(Sub(Sub(Constant(-30.0),$vwap),Med(Sub(EMA(Div($volume,Constant(0.5)),50),Constant(30.0)),40)),$vwap),$volume),Constant(-1.0))
Mul(Constant(-0.01),$low)
$open
Div(Add(Add(Add(Constant(-2.0),$close),Constant(0.01)),Constant(2.0)),Mul(Sub(Ref($volume,10),$high),Constant(-0.01)))
$vwap
Std(Med(Mul(Sub(Mean(Delta(Med(Add(Constant(10.0),Std($volume,50)),10),30),20),Constant(-2.0)),$close),50),30)
Mul(Constant(10.0),$vwap)
Add(Greater(Constant(0.01),$open),$volume)
Mul(Constant(-30.0),Mean(Abs(Mul(Sub($close,Sub(Mul(Div($vwap,Constant(-10.0)),Constant(1.0)),$volume)),Constant(0.01))),10))
Med(Mul(Constant(-5.0),Mean(Mul(Sub(Med($close,10),Constant(-0.01)),Constant(-5.0)),10)),10)
Std($vwap,20)
Sub(Med(Sub(Sum(Add(Constant(0.01),$low),20),Constant(-2.0)),50),Constant(-1.0))
Div(Sub(Constant(1.0),$high),Constant(-0.01))
Add(Mul(Sub(Ref(Var(Min(Div(Constant(30.0),$close),10),30),50),Constant(-0.01)),Constant(5.0)),$open)
Min(Add(Div(Less(Less(Constant(-1.0),$close),Mul(Mul($open,Sub(Constant(-1.0),$close)),Constant(-0.5))),$high),Add($close,Constant(-0.01))),40)
Div(Div(Add(Constant(1.0),Mean(Mean($high,20),20)),Constant(-5.0)),Constant(2.0))
Mul(Max($high,50),$high)
Sub(Constant(30.0),$vwap)
Div(Sub(Sub($close,$close),$high),Constant(-5.0))
Add(Constant(10.0),$high)
Sub(Std(Sub(Less(Sub($volume,Constant(0.01)),Constant(-2.0)),Var($vwap,40)),20),Constant(-0.01))
Corr(Mul(Constant(-10.0),$high),$close,50)
Mad(Add($open,Constant(10.0)),50)
$close
Mul(Constant(2.0),$high)
Sub(Sub(Constant(-0.5),$vwap),$volume)
Add(Constant(-10.0),$open)
Mad(Div($open,Add(Med($close,50),Constant(1.0))),10)
Add(Constant(2.0),Sub(Add($high,Mul(Constant(-1.0),Mean($volume,30))),Mul(Add($low,Constant(5.0)),Constant(0.01))))
Add($high,Constant(-1.0))
Mul(Constant(-2.0),$high)
Var(Abs(Add(Constant(5.0),$vwap)),30)
Mul(Constant(-30.0),$open)
Add($high,Constant(0.01))
Sub(Less(Constant(2.0),$high),$high)
WMA(Sub(Div(Constant(30.0),Abs(Greater($vwap,Mul(Sub(Constant(0.01),$high),Constant(10.0))))),Constant(1.0)),30)
Mul(Add(Less(Constant(0.01),Abs($low)),$high),$open)
Sub(Mul($high,Constant(30.0)),Constant(-1.0))
Mul(Constant(10.0),$close)
Sub(Div(Abs(EMA(Sub(WMA(Sub(Constant(-10.0),$high),20),Mul(Add(Constant(-5.0),$high),Constant(1.0))),20)),Constant(-2.0)),Constant(1.0))
Add(Constant(-2.0),Sub($high,Constant(-1.0)))
$high
Var(WMA(Med(Div(Constant(5.0),Max($close,20)),50),30),50)
Add(Constant(1.0),Var(Var($low,30),20))
Mul(Add($vwap,Less($volume,Constant(30.0))),Ref(Add($vwap,Constant(1.0)),20))
Mul(Add(Add(Sub(Log($low),Constant(5.0)),Add(Div(Constant(0.5),$high),Constant(-10.0))),Log($low)),Constant(-5.0))
Add(Add(Min(Add(Div(Constant(-1.0),Mean(Sum(EMA($volume,30),10),30)),Constant(0.01)),20),Constant(0.01)),Less(Constant(-2.0),$vwap))
Div(Add(Add(Add(Constant(-10.0),$open),Constant(2.0)),Constant(-1.0)),Constant(-0.5))
Sub(Constant(0.5),$close)
$high
Log(Max(Mean($vwap,40),10))
Add(Add(Mul(Constant(-5.0),Cov($volume,Mul($vwap,$volume),10)),Constant(2.0)),Constant(-5.0))
Var(Sub(Add(Constant(-10.0),Sub($vwap,Constant(5.0))),Constant(-1.0)),40)
Add(Constant(0.01),$open)
$vwap
Mul(Constant(-5.0),$volume)
Ref(Abs(Sub(Constant(-2.0),$high)),10)
Div(Med(Mean(Mul(Constant(-10.0),Ref($low,10)),10),10),Sub(Div(Sub(Constant(-0.01),$high),Log(Log($volume))),$low))
Add(Constant(1.0),$close)
Add(Min(Add(Sub(Add(Constant(1.0),Sub($high,$high)),Constant(-1.0)),Constant(-5.0)),40),Constant(-1.0))
Add(Greater(Add(Constant(2.0),Std(Add(Div(Add(WMA($volume,10),$open),Constant(30.0)),Constant(-10.0)),20)),Greater($high,Constant(-10.0))),$high)
WMA(Sub(Add(Div(Med(Div(Sub(Sub(Div(Constant(-10.0),$low),Constant(10.0)),Constant(-5.0)),$high),10),Constant(1.0)),Constant(-0.5)),Constant(-0.5)),50)
Delta(Delta(Cov(Mul(Add(Constant(0.01),Var($open,20)),Constant(10.0)),$high,50),40),40)
Add(Mean(Max(Div(Constant(30.0),Add($low,Mul(Constant(-2.0),$high))),30),30),Constant(1.0))
Log(Mul(Constant(5.0),$low))
Add(Constant(1.0),$volume)
Sub(Std(Add(Mul(Mul(Sub(Mul(Constant(1.0),$vwap),Constant(-30.0)),Constant(2.0)),$vwap),Constant(-10.0)),20),Constant(1.0))
Var(Sub(Constant(-10.0),Div($close,Mul($volume,Constant(-5.0)))),20)
Add(Mul(Add(WMA(Sub(Constant(-30.0),$high),20),Constant(-30.0)),Constant(-10.0)),Constant(2.0))
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104232632/22528_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.101       |
|    eval_cnt             | 6           |
|    significant          | 6           |
|    size                 | 6           |
| rollout/                |             |
|    ep_len_mean          | 10.4        |
|    ep_rew_mean          | -0.1        |
| test/                   |             |
|    ic                   | 0.0325      |
|    rank_ic              | 0.031       |
| time/                   |             |
|    fps                  | 43          |
|    iterations           | 11          |
|    time_elapsed         | 514         |
|    total_timesteps      | 22528       |
| train/                  |             |
|    approx_kl            | 0.010817203 |
|    clip_fraction        | 0.166       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.67       |
|    explained_variance   | 2.98e-07    |
|    learning_rate        | 0.001       |
|    loss                 | -0.246      |
|    n_updates            | 100         |
|    policy_gradient_loss | -0.027      |
|    value_loss           | 0.106       |
-----------------------------------------
Add(Constant(-30.0),Sub(Div(Mean(Mul(Less($high,Constant(2.0)),Div(Mad(Max($open,40),20),Constant(-2.0))),20),$volume),Constant(-2.0)))
Max(Log(Log(Med(Sub(Sub(Constant(0.01),$vwap),Mul($low,Constant(0.5))),30))),30)
Mul(Constant(-5.0),$low)
$close
Div(Div(Constant(0.01),Add($high,Constant(0.5))),Constant(-10.0))
Mul(Constant(2.0),$high)
$vwap
Mul(Constant(-0.01),$close)
Log(Std(Mul(Constant(1.0),Add($open,$low)),50))
Mul(Constant(10.0),$high)
Corr(Div(Constant(-10.0),$volume),$close,30)
Add(Constant(-0.5),EMA($low,10))
Mean(Mul(Greater(Log(Std(Add(Greater(Constant(30.0),$high),$open),40)),Add(Sub($open,$low),Constant(0.5))),$close),20)
WMA(Mul(Mul($low,Constant(-2.0)),$close),40)
Add(Constant(2.0),Mad($low,40))
Div(Mul(Constant(5.0),$volume),$open)
Ref(Abs(Sub(Ref(Abs($low),30),Constant(2.0))),20)
Add(Greater($volume,Constant(30.0)),Add($high,Constant(-2.0)))
$volume
Add(Constant(0.01),$volume)
Sub(Constant(-2.0),$low)
Sub(Div(Constant(-1.0),$low),Constant(2.0))
Mean($open,30)
Mul(Constant(1.0),$close)
Sub(Constant(1.0),Div($volume,Mul($volume,Constant(-5.0))))
Var(Abs(Mul(Mul(Constant(30.0),Sub($high,Constant(0.01))),Cov($high,$close,10))),20)
Corr(Sub(Div(Constant(-0.5),Var(Sub(Mul(Std(Sub($high,$low),20),Constant(5.0)),Constant(2.0)),20)),$vwap),$low,10)
Abs(Mul(Add(Div(Add(Constant(30.0),Mean($low,50)),Constant(0.01)),Mul(Constant(5.0),Med($open,40))),Constant(-30.0)))
Mul(Constant(-2.0),$high)
Div(Constant(10.0),$vwap)
Abs(Sub(Constant(-5.0),Mul($close,Sum($close,20))))
$close
Mad(Mul(Var(Sub(Sum($low,10),$low),10),Constant(-30.0)),40)
Sub(Div(Constant(-0.5),Abs($open)),Mul(Constant(0.01),$close))
Mul(Constant(0.5),$low)
$close
Sub(Constant(-10.0),Med(Log($vwap),20))
WMA(Mul(Abs(Ref(Sub(Constant(-0.5),$open),50)),Abs($close)),10)
Med(Std(Div(Constant(-10.0),Mad($open,40)),30),10)
Delta(Mul(Sum($close,50),Constant(-10.0)),10)
Min($volume,40)
Var(Mul($close,Constant(0.01)),50)
Sub(Constant(-0.5),$vwap)
Mul(Constant(-1.0),$open)
Med(Mul(Div(Constant(-2.0),$high),Constant(-0.01)),40)
$low
Add(Sub(Greater(Greater(Constant(-2.0),Add(Sub(Max($low,50),Constant(-5.0)),$open)),$close),$close),Add(Div(Constant(1.0),$open),Constant(30.0)))
Mul(Mul(Constant(-1.0),$close),Constant(-30.0))
WMA(Mul(Constant(0.01),WMA(Max($low,20),20)),20)
Add(Min(Sub(Constant(0.01),Div($low,Constant(-1.0))),50),$high)
Med(Sub(Greater(Sub(Abs(Div(Constant(5.0),$close)),$low),Constant(-0.01)),$volume),10)
Sub(Std(Add(Div(Add(Constant(5.0),$high),Mul($close,Constant(2.0))),Div($low,Constant(2.0))),20),Constant(0.01))
Div(Constant(5.0),$close)
Mul(Mul(Div(Constant(1.0),Sub(Delta($close,20),Constant(10.0))),Constant(-2.0)),Constant(-2.0))
Sub(Greater(Constant(-1.0),Div(Med($low,30),Constant(10.0))),$vwap)
Abs(Sub(Constant(-0.5),$vwap))
Var(Mul(Ref(Div(Sub(Add(Constant(0.01),Sub($vwap,Constant(-5.0))),Constant(2.0)),Constant(-2.0)),10),Constant(-10.0)),40)
$volume
Mul(Constant(-30.0),$low)
Div(Constant(-0.5),$low)
Div(Log(Sub(Constant(0.01),$volume)),Constant(-1.0))
Mad(Std(Sub(Constant(5.0),Add($high,Constant(-10.0))),30),40)
Std(Mul(Constant(-5.0),Add($open,Mul($open,Greater(Constant(-2.0),EMA($volume,20))))),20)
Sub(Greater(Constant(-5.0),$vwap),$volume)
Mul(Constant(10.0),$high)
Sum(Mul(Constant(-10.0),$volume),20)
Div(Constant(5.0),$high)
Mul(Add(Add(Var(Min(Mul(Mul($high,Mul($volume,$low)),Constant(-2.0)),50),50),Abs($low)),Constant(30.0)),$high)
Sub(Constant(0.01),$low)
Delta(Mul(Sub(Sub($low,Sub(Constant(0.01),Med($close,20))),Constant(-2.0)),Constant(30.0)),40)
Sub(Abs(Div(Constant(30.0),$volume)),$open)
Sub(Add(Abs(Max(Abs(Mul(Constant(-5.0),WMA($open,20))),10)),Greater($volume,Constant(-10.0))),Constant(1.0))
Mean(Mul(Constant(30.0),Var($low,30)),20)
Div(Constant(10.0),Var($close,30))
Mul(Constant(5.0),$high)
Mul(Add(Div(Var(Add(Mul(Constant(-1.0),Min($open,10)),Constant(10.0)),30),Constant(-10.0)),Constant(2.0)),Constant(10.0))
Abs(Add(Constant(-5.0),$open))
Var(Mean($high,20),30)
Delta(Add(Mul(Max(Sub(Std(EMA(Mul(Add(Constant(-10.0),$low),Constant(2.0)),10),30),Constant(-2.0)),40),Constant(-1.0)),Constant(2.0)),40)
Div(Sub(Greater(Add(Constant(-30.0),Mul($low,Constant(-1.0))),Constant(-30.0)),EMA(Max($low,40),40)),Constant(-10.0))
$low
Div(Sub(Constant(0.01),Med(Div(Add(Greater($high,Constant(-30.0)),Greater($low,Add($volume,$volume))),Mul($close,Constant(-5.0))),40)),Constant(30.0))
Div(Constant(1.0),$close)
$high
Sub(Add(Mean(Sum($close,10),50),$vwap),Sub(Sub($close,Constant(-2.0)),Constant(0.01)))
$open
Log(Mul(Constant(30.0),$volume))
Div(Greater(Sub(Add(Div(Constant(-5.0),Max($close,30)),Constant(-5.0)),Constant(0.01)),$high),$high)
Add(Constant(0.01),$low)
Std(Log(WMA(Std(Var(Div(Constant(-30.0),$low),20),10),20)),30)
Mean(Mul(Constant(-5.0),Div(Greater(Sub($volume,Constant(0.01)),Constant(0.5)),$open)),30)
Mul(Sub(Mul(Constant(-0.01),$low),Constant(-10.0)),Div($volume,$volume))
Div(Std(Div(Sub(Mul(Sub(Constant(-2.0),$vwap),Div($low,Constant(-10.0))),Constant(0.01)),$vwap),20),Constant(-2.0))
Add(Constant(5.0),Sub($vwap,Constant(1.0)))
Sub(Add($low,Constant(-10.0)),Sub(Constant(-0.5),$low))
Add(Constant(10.0),$high)
Mul(Constant(0.01),$close)
Sub(Abs(Add(Constant(5.0),$close)),Constant(5.0))
$close
Var(Sub(Constant(-5.0),$low),30)
Max(Mul(Max(Sub(Sub($volume,Constant(-0.01)),Constant(0.01)),20),Constant(1.0)),30)
$close
Mul(Greater(Constant(2.0),$close),Med($open,50))
Mean(EMA(Add(Add($low,Constant(0.01)),Constant(0.01)),30),30)
Add($close,Constant(-1.0))
Mul(Constant(-10.0),Mean($high,20))
Div(Constant(-1.0),Var($low,50))
Sub(Constant(-5.0),$high)
Mean(Div(Less(Med(Med(Mul(Constant(-0.01),Abs(Greater($vwap,$low))),10),50),Constant(-30.0)),$volume),20)
Sum(Sub(Constant(-5.0),$high),40)
Mul($high,Constant(0.01))
$low
Sub($vwap,Constant(-5.0))
Sub(Sub(Greater(Log($volume),Constant(10.0)),$close),$volume)
Max(Cov(Log(Add(Var(Add(Less(Constant(2.0),Var($vwap,20)),$volume),20),$vwap)),Add($vwap,Constant(-2.0)),10),20)
Div(Greater(Mad(Mul(Constant(-0.01),$open),20),Abs($volume)),Constant(-0.5))
Med(Add(Constant(-2.0),$close),30)
Sub(Div(Constant(-10.0),EMA(Mul($low,Constant(-1.0)),40)),Constant(0.01))
Abs(Sub(Mul(Mul(Sum(Add(Mul(Constant(10.0),$low),Constant(2.0)),30),$close),Sub(Constant(5.0),$close)),$open))
Sub(Greater(Sub(Less(Abs($high),$volume),Constant(-0.01)),Constant(5.0)),$volume)
Add(Mul(Less(Constant(-10.0),Mul(Div($close,Constant(-0.01)),$volume)),Med(Min(Greater($open,$low),10),30)),Constant(-0.5))
Min(Add(Constant(-2.0),Div($volume,Constant(-1.0))),50)
EMA(Add(Mul(Abs(Sub($close,$volume)),Mul($vwap,Constant(30.0))),$low),40)
Med(Less(Div(Sub(Constant(10.0),$low),Constant(-10.0)),$volume),50)
Sub(Constant(1.0),$high)
Var(Add(Med(Div(Constant(1.0),Std(Sub($volume,Constant(0.01)),20)),20),Div($low,Constant(-5.0))),20)
Med(Add($open,Constant(2.0)),30)
Sub(Less(WMA(Div(Constant(2.0),Std($vwap,10)),20),Constant(-1.0)),$vwap)
Sub(Constant(-10.0),$open)
Std(Add(Sub(Constant(0.01),$close),Constant(-0.5)),10)
WMA(Mul(Min($low,30),Constant(30.0)),10)
$open
Add(Constant(-5.0),Var(Max(Mul($low,Constant(5.0)),20),20))
Sub(Constant(-5.0),$low)
Max(Add(Add(Sub(Mul(Div(Mul($close,Constant(0.01)),Constant(0.01)),Constant(-2.0)),Constant(-2.0)),WMA(Var($high,30),40)),Constant(1.0)),10)
Ref(Add(Constant(-1.0),Var($low,40)),30)
Mad($high,20)
$close
Add(Mul(Mean(Mul(Cov(Med(EMA($open,10),30),$volume,30),Constant(1.0)),40),Sub($volume,Constant(-5.0))),Constant(0.01))
Mul(Constant(-30.0),$vwap)
Sub(Constant(-0.01),Cov($open,$volume,20))
Log(Mul(Constant(0.5),$low))
Mul(Less(Constant(-1.0),Max($vwap,10)),$vwap)
Mul(Ref(Sub(Constant(5.0),$vwap),20),Var($high,30))
Mul(Constant(-1.0),$open)
Mul(Sub(Constant(-1.0),$low),Constant(-10.0))
Div(Constant(2.0),$volume)
Var(WMA(Sub(Constant(-5.0),$high),40),50)
Add(Abs($high),Constant(-10.0))
Sub(Constant(-5.0),$close)
Std(Sum(Mul(Constant(-10.0),Abs(Mul($open,Constant(5.0)))),20),40)
Add(Constant(-30.0),Med(Std($close,20),20))
Sub(Constant(30.0),$high)
Sub(Constant(-0.5),$close)
Mul(Sub(Sub(Constant(-5.0),WMA($volume,30)),Constant(-10.0)),$low)
Mul(Less(Less(Constant(1.0),$open),$high),Mad($close,20))
Sub(Constant(0.5),$vwap)
Abs(Std(Delta(Sub(Std(Sub(Sum(Corr(Sub(Constant(2.0),$close),$low,30),20),$high),20),Constant(0.5)),20),50))
Mul(Constant(-0.5),Mad(Div($low,Constant(2.0)),20))
Sub(Constant(0.01),$close)
Div(Constant(-0.5),$volume)
Sub(Constant(0.01),$vwap)
$high
Mul(Constant(-5.0),$volume)
Mul(Sub(Constant(0.5),$low),Constant(-5.0))
Add(Log(Med(Add(Sub(Sub(Constant(0.01),Med($open,10)),Constant(1.0)),Constant(2.0)),20)),Constant(-0.01))
Sub(Div(Div(Constant(10.0),$vwap),$close),Mul(Constant(-0.5),$high))
Sub(Constant(-0.5),Mad($vwap,10))
Add(Constant(10.0),Mean(Std($high,50),20))
Mul(Mul(Div(Greater(Mul(WMA(Add(Constant(-0.01),Ref($open,40)),20),Constant(10.0)),Constant(-5.0)),$close),Constant(30.0)),Constant(10.0))
Add(Constant(-0.01),Log($close))
Add(Constant(-5.0),Div($volume,Constant(-0.01)))
EMA(Div(Mul(Constant(2.0),Min($vwap,30)),Sub(Add(Constant(1.0),Mul($volume,Constant(-5.0))),Constant(30.0))),20)
Add(Add(Constant(1.0),$open),Constant(-0.01))
Add(Constant(2.0),Log($high))
Add(Constant(-2.0),Max(Mul($open,Constant(0.01)),10))
Div(Constant(-0.5),$high)
$low
$low
Sub(Constant(0.5),Sum(Mul($vwap,Constant(5.0)),30))
Add(Constant(-10.0),$vwap)
Log(Mul(Constant(-30.0),$low))
Sub(Sub(Greater(Greater(Sub(Div(Mul(Constant(30.0),$vwap),Sub($open,Constant(-0.5))),$volume),Constant(-1.0)),$close),Sum($high,10)),Constant(-30.0))
Add(Constant(-5.0),$volume)
Sub(Constant(30.0),$high)
Med(Div(Constant(-10.0),Div(Greater($low,Constant(30.0)),$open)),20)
$low
Add(Constant(-2.0),$low)
Sub(Corr(Add(Div(Div(Constant(5.0),$vwap),$open),Constant(5.0)),$low,30),Greater($close,Constant(0.01)))
Mul(Constant(-2.0),Sum($volume,10))
Mul($volume,Constant(10.0))
$low
$open
Mul(Constant(-2.0),$close)
Abs(Div(Constant(-30.0),$volume))
Med(Div(Div(Greater(Constant(-30.0),Std($high,40)),Div(Sub($low,$high),Constant(-2.0))),Constant(30.0)),20)
$close
Sum(WMA(Add(Constant(0.5),Var(Var(WMA($high,30),10),20)),20),40)
Sum(Std(Sub(Constant(5.0),Greater($open,$low)),30),30)
Add($vwap,Constant(-1.0))
Add(Constant(1.0),$low)
Abs(Mul(Constant(-2.0),$close))
Div($high,Greater($close,Constant(-1.0)))
Mul(Sub(Delta(Add(Constant(10.0),$volume),20),Less(Constant(-0.01),Sub($low,Constant(-10.0)))),Sub(Constant(-1.0),$low))
Mul(Sub(Add(Less(Constant(-2.0),$low),$close),$close),Sum($low,30))
Mad(Log(Med(Mul($high,Constant(-2.0)),20)),10)
Delta(Sum(EMA(Div(Add(Constant(-5.0),Sub(Sub($low,Constant(-2.0)),Constant(0.01))),Constant(0.5)),30),50),50)
Div(Constant(2.0),Div(Mean($low,20),Constant(0.01)))
$close
Var($close,20)
Abs(Mul(Constant(0.5),$open))
Abs(Sub(Constant(-0.5),Abs($open)))
Sub(Constant(0.5),$vwap)
Sum(Sum(Sub(Less(Constant(0.01),WMA($vwap,30)),$high),50),20)
Mul(Sum(Var(Var(Sub(Min(Div(Constant(2.0),$volume),10),Constant(-1.0)),50),50),40),Constant(-2.0))
Mul(Constant(2.0),Delta($volume,20))
Mean(Mul(Constant(-30.0),$vwap),30)
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104232632/24576_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.101       |
|    eval_cnt             | 7           |
|    significant          | 6           |
|    size                 | 7           |
| rollout/                |             |
|    ep_len_mean          | 8.18        |
|    ep_rew_mean          | -0.059      |
| test/                   |             |
|    ic                   | 0.0325      |
|    rank_ic              | 0.031       |
| time/                   |             |
|    fps                  | 43          |
|    iterations           | 12          |
|    time_elapsed         | 567         |
|    total_timesteps      | 24576       |
| train/                  |             |
|    approx_kl            | 0.016578212 |
|    clip_fraction        | 0.2         |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.6        |
|    explained_variance   | 1.79e-07    |
|    learning_rate        | 0.001       |
|    loss                 | -0.259      |
|    n_updates            | 110         |
|    policy_gradient_loss | -0.0258     |
|    value_loss           | 0.0735      |
-----------------------------------------
Mul(Sub(Constant(-30.0),$volume),$low)
Add(Constant(-2.0),$high)
Mad($close,40)
$vwap
Mad($open,10)
Log(Div($low,Greater(Sub($low,Constant(10.0)),Constant(-10.0))))
Add(EMA(Mul(Constant(-30.0),$volume),20),$high)
Div(Constant(5.0),Min($vwap,30))
Mean(Mul(Greater(Constant(-2.0),Var($low,10)),Less(Mad($open,40),Div($vwap,Constant(30.0)))),10)
Sub(Constant(2.0),Add($low,$low))
Sub(Constant(-10.0),$low)
Mul(Constant(-1.0),Sub($volume,$close))
Sum(Sub(Sub(Constant(-30.0),Var(Mul($low,$close),40)),Constant(-5.0)),20)
Var(Add(Sub(Constant(5.0),Sub($low,Constant(-2.0))),Std(Var(Mean($vwap,20),30),20)),10)
Sub($close,$volume)
Mul(Constant(0.5),$high)
$volume
Ref(Add(Constant(-2.0),Abs($low)),20)
Sum(Add(Constant(10.0),$volume),40)
Delta(Div(Constant(-10.0),Sub($high,$high)),10)
Mul(Mul(Mean(Sum(Sub(Div(Constant(-2.0),$volume),Constant(1.0)),40),10),Constant(0.01)),Constant(-10.0))
Var(Med(Div(Delta(Sub(Sum($low,20),$low),20),Constant(-30.0)),10),20)
Log(Div(Constant(-30.0),$volume))
Add(Constant(0.01),$open)
Sub(Constant(-2.0),$high)
Sub(Constant(-5.0),Mul(Std($vwap,20),Less(Constant(0.01),Add(Sum($close,30),Constant(2.0)))))
$low
Sub(Sum($low,40),Constant(2.0))
Sub(Sub(Constant(0.01),Div($vwap,Constant(2.0))),Constant(-2.0))
Div(Greater(Mul(Greater(Constant(0.5),$low),$low),Constant(-2.0)),$close)
Var($close,20)
Var(Mul(Constant(-30.0),$volume),10)
Div(Greater(Med(Var(Mul($volume,Constant(-0.01)),30),20),Constant(-10.0)),$high)
Add(Constant(-30.0),$high)
Mul($high,Constant(30.0))
Add(Constant(-1.0),$close)
Mul(Constant(0.5),$high)
$close
Mul(Greater($high,Constant(0.01)),$vwap)
$vwap
Add(Greater(Constant(0.01),$close),$high)
Corr(Mul(Div(Var(Add(Constant(-30.0),$high),50),Add($low,Add(Constant(-2.0),$volume))),Div($vwap,Constant(-1.0))),$low,40)
Add(Constant(-10.0),Log($volume))
Var(Add(Cov(Mul(WMA(Sum(Sub(Constant(-1.0),Max($low,40)),50),20),Constant(-0.5)),$close,10),Constant(-1.0)),10)
Add(Mul(Add(Log(Div(Div(Constant(5.0),$low),Sub(Mul($vwap,$close),Constant(1.0)))),Constant(10.0)),Constant(-10.0)),Constant(-10.0))
Add(Add(Min(Abs(Delta(Add(Constant(5.0),$open),50)),40),Constant(-5.0)),$low)
Log(Sum(Std(Mul(Constant(-10.0),$high),20),30))
Mul(Constant(0.5),Med(Abs($vwap),30))
$close
Add(Med(Add(Add(Mul($close,$low),$close),Constant(-2.0)),20),Constant(0.5))
Sub(Mul(Max(Div(Constant(-10.0),$close),20),Constant(-1.0)),Constant(0.01))
Sub(Greater(Add(Constant(30.0),Mul(Div($high,Constant(-10.0)),Constant(0.01))),Constant(-10.0)),Add($low,Mul($low,Sub($close,Constant(-10.0)))))
Mul(Constant(-0.5),Min(Mul($low,Constant(-10.0)),50))
Div(Constant(-0.01),$high)
Div(Greater(Constant(10.0),Div($close,Constant(-10.0))),$volume)
Less(Mul(Constant(-1.0),Add($close,$vwap)),$open)
Mul(Constant(-2.0),$high)
Add(Sub(Constant(0.5),Sub(Mul(Greater($close,Constant(-2.0)),$high),$close)),$high)
Sub(Sum(Sub(Constant(-2.0),$high),20),Sub($volume,Constant(0.01)))
Mul(Sub(Sub(Add(Constant(0.01),$vwap),$low),Div(Add(Sub($low,$vwap),Constant(5.0)),$high)),Constant(2.0))
Div(Div(Sub(Constant(-0.5),$vwap),Constant(2.0)),Constant(5.0))
Log($close)
Add(Constant(-10.0),$volume)
Div(Mean(Sub(Constant(0.5),Add(Mul($volume,EMA(WMA(Mul(Add(Constant(-30.0),$close),$vwap),20),40)),$vwap)),20),Constant(-1.0))
Div(Log($vwap),Constant(10.0))
Sum(Std(Sub(Greater(Constant(-10.0),$close),$low),40),10)
Div($close,Add(Constant(-5.0),$vwap))
Log(Sum(Div(Greater(Constant(30.0),$low),$low),20))
Div(Constant(-0.5),$volume)
Mul(Less($volume,Constant(-5.0)),$low)
Add(Div(Sub(Constant(30.0),$close),Constant(-2.0)),Constant(-2.0))
Std(Abs(Mul(Constant(2.0),$volume)),30)
Sub(EMA($low,20),Constant(-1.0))
Sub(Greater(Constant(-10.0),$close),$volume)
Mul(Constant(-30.0),Div($close,Constant(-0.01)))
Std(Sub(Mul(Constant(-1.0),Add(Min($vwap,30),Abs($low))),$low),40)
Sub(Greater(Mul(Add(Constant(0.01),$volume),$vwap),Constant(-10.0)),Mul($high,Constant(-1.0)))
Mul(Constant(-5.0),Sub($high,$open))
Mul(Add(Greater(Constant(-10.0),Mul($close,$vwap)),Var($high,20)),Constant(-10.0))
Div(Constant(5.0),Mul($high,Constant(-10.0)))
Mul($low,Constant(1.0))
$vwap
Var(Mul(Add(Mul(Sub(Add(Constant(30.0),$high),Constant(2.0)),$vwap),Max($high,30)),Constant(30.0)),10)
Sub(Sub(Add(Constant(5.0),$vwap),Constant(0.01)),Constant(-30.0))
Add(Sub(Greater(Constant(-5.0),Add(Abs(Sub($open,$close)),Constant(-30.0))),Div(Greater($close,Constant(-1.0)),$vwap)),Constant(-10.0))
$volume
Ref(Div(Constant(-30.0),$vwap),30)
Sub(Mul(Add($close,$close),Constant(2.0)),$high)
Med(Mad(Div(Sum(Mul(Constant(-5.0),$low),50),$high),30),40)
Mad(Mul(Constant(-1.0),$close),30)
Mul(Std(Add(Constant(-10.0),$high),20),$close)
Add(Constant(0.01),$high)
Var(Mul($volume,$low),30)
Add(Constant(-30.0),$close)
Mul(Sum(Add(Constant(2.0),Var(Div($volume,$high),30)),50),$low)
Sub(Constant(2.0),Sub(Sub($close,Constant(5.0)),$volume))
Greater(Var(Mul(Constant(-30.0),$high),30),Ref($low,40))
Mul($close,Constant(-0.01))
Div(Constant(-30.0),$close)
Add(Constant(-0.5),$close)
Add(Div(Sub(Mul(Constant(-1.0),Mul(Greater($vwap,Constant(-0.01)),$low)),Constant(0.5)),Constant(-1.0)),Div($high,Abs(Add($open,Constant(2.0)))))
$low
Div(Constant(-0.01),Mul(Std(Delta(Mad($open,40),10),20),Constant(-30.0)))
$volume
Mul(Mul(Greater(Constant(-5.0),$close),Max($vwap,10)),Constant(-0.01))
Log(Log($volume))
Mul(Add(Constant(30.0),$open),Sub(Constant(-10.0),$vwap))
WMA(Sub(Mul($open,Constant(0.5)),Constant(0.01)),30)
$high
Div(Var($close,50),Constant(2.0))
Sub(Log(Var(Var(Var(Mul(Constant(5.0),Div($high,Constant(30.0))),20),30),10)),Constant(2.0))
Add(Mul(Div(Mul(Constant(5.0),Sub($open,$high)),$low),Constant(-0.5)),Constant(2.0))
Corr($vwap,$vwap,40)
Add(Add($close,Constant(-2.0)),$low)
$close
Sub(Delta(Div(Constant(30.0),$vwap),40),Constant(-1.0))
Std(Mul($vwap,Constant(30.0)),20)
$volume
$volume
Div(Constant(0.01),$close)
Med(Mad(Add(Mad(Sub(Constant(0.01),$low),30),$high),20),30)
Add($high,$vwap)
Mul($close,Constant(1.0))
Log(Div(Constant(-1.0),$close))
Sum(Add(Div(Constant(-1.0),Sub(Div($high,Constant(0.01)),Constant(-10.0))),Constant(0.01)),50)
$low
Add(Constant(2.0),Std($close,50))
Mul(Min(Sum(WMA(Ref(Add(Constant(-5.0),$open),20),20),40),30),Constant(2.0))
Sub($low,Constant(30.0))
Sub(Add(Mul(Constant(1.0),$high),Abs(Sub(Constant(2.0),$open))),Constant(-0.01))
Sub(Constant(-10.0),Abs(Delta($low,10)))
Sub(Constant(-0.5),$high)
EMA($vwap,30)
Sub(Constant(1.0),$high)
Add(Constant(0.01),$low)
Mul(Add(Mul(Constant(-5.0),Add($low,$volume)),$low),Abs(Add(Add(Constant(0.5),$vwap),Constant(5.0))))
Div(Constant(30.0),Add($volume,Constant(30.0)))
$close
Med(WMA(Abs(Delta(Add(Sub(Constant(-1.0),Min($volume,20)),Mul($vwap,Constant(-5.0))),20)),40),30)
Add(Constant(-5.0),$high)
Mul(Constant(0.01),$close)
Add(Constant(-5.0),$high)
Sub(Greater(Constant(1.0),$low),Sub(Greater(Greater($low,Constant(-0.01)),Sub(Abs($vwap),Med($low,30))),Log(Mul($high,$close))))
Sub(Div(Mul(Div(Add(Constant(-0.5),Log($volume)),Constant(-10.0)),Constant(-5.0)),Add($low,Constant(30.0))),Constant(-10.0))
Mul(Constant(0.01),Sub(Add(Add($volume,Constant(0.01)),$low),$close))
Mean(Std($high,50),40)
Mul(Less(Greater(Sub(WMA(Add(Constant(-0.5),$volume),30),Std(Sub(Med($volume,30),Constant(-0.5)),20)),Constant(5.0)),$low),$close)
Delta(Min(Div(Delta(Delta(Sub(Constant(-1.0),Sub(Greater(Mul($open,$vwap),Constant(-10.0)),$close)),20),20),$low),20),10)
Mean(Sub(Log(Mul(Greater(Greater(Var($high,40),Constant(-1.0)),$volume),$volume)),Less(Constant(10.0),$open)),50)
$volume
Delta(Var(Sub(Mul(Constant(-0.01),Mad($vwap,10)),Constant(-10.0)),20),20)
Sub(Sub(Sub(Constant(-1.0),$volume),Constant(-10.0)),Constant(30.0))
Mad(Less(Mul(Constant(30.0),$high),Sub(Constant(-10.0),$close)),20)
Mul(Constant(10.0),$open)
$vwap
Div(Constant(5.0),Sub($close,Constant(-1.0)))
Mean(Log(Std($high,10)),10)
Sub(Constant(2.0),Sum($close,40))
Sub(Constant(-1.0),$low)
Add(Greater(Constant(0.5),$close),Div($low,$close))
$volume
$open
Mul($high,Constant(-0.5))
Mul(Sub($close,Var(Min(Min($close,20),40),30)),Add(Add($high,$high),Constant(2.0)))
$close
Div(Constant(-0.01),$open)
$high
Abs(Mad(Mul(Constant(-0.01),$close),10))
$volume
Div(Div(Constant(0.01),$low),Constant(-1.0))
Mul(Add(Mul(Constant(-10.0),$volume),Constant(-30.0)),Constant(-0.01))
Add(Sum(Add(Mul(Constant(0.01),$low),Constant(-2.0)),10),Constant(-2.0))
Add(Constant(-0.5),$low)
$high
Add(Constant(-0.5),Var($vwap,20))
WMA(Var(Var(Div(Div(Less(Constant(-0.01),Abs($low)),$close),Constant(-10.0)),50),30),10)
Sub(Std(Mean(Mul(Cov($close,Mul($open,Constant(2.0)),50),Constant(1.0)),30),20),Constant(-10.0))
Min(Std(Abs(Mul($low,Constant(0.01))),40),20)
Delta(Add($close,Constant(-1.0)),30)
Var(Div(Constant(0.5),$low),10)
Delta(Sum(Add(Mul(Less(Constant(-2.0),Sub($low,Constant(1.0))),Mul(Mul(Div($open,Constant(-5.0)),$low),Constant(-0.01))),Constant(-0.01)),10),30)
Add(Mad(Min($volume,30),30),Constant(-10.0))
Cov(Abs(Min($low,50)),Sub(Constant(10.0),$vwap),30)
$close
Abs(Abs(Sub(Constant(0.5),Add(Med($low,50),$open))))
Add($high,Constant(0.5))
Div(Constant(1.0),$close)
$low
Sub(Abs(Mean(Sub(Div(Constant(2.0),$vwap),Constant(10.0)),40)),Constant(-0.01))
Med(Add(Greater(Constant(-1.0),$volume),Add($low,Constant(2.0))),50)
Var(Mul(Mul(Constant(-5.0),Sum($low,30)),Constant(10.0)),30)
WMA($low,20)
Min(Max(Sub(Constant(2.0),$close),20),30)
Add($volume,$vwap)
Log(Div(Less(Constant(-1.0),$vwap),Add($close,$low)))
Sub(Var(Sub(Constant(0.01),Var($vwap,20)),20),Constant(-1.0))
$high
Abs(Mad(Mul(Constant(-5.0),Div($close,Constant(1.0))),20))
Div(Constant(-5.0),$close)
Sub(Min(Abs(Mul(Mul(Constant(-30.0),Abs($high)),Constant(-1.0))),20),Constant(-10.0))
Mul(Constant(-30.0),$close)
Abs(Cov($close,$low,30))
WMA(Add(Greater(Constant(-0.5),$close),$low),10)
Sub(Mean(Sub(Add(Constant(-1.0),$close),Constant(2.0)),10),Constant(-5.0))
Add(Add(Sub(Mul(Constant(-10.0),$vwap),Constant(2.0)),Constant(-5.0)),Constant(10.0))
Sub(Constant(1.0),$volume)
Sub(Constant(-1.0),$high)
Med(Sub(Constant(0.01),$vwap),40)
Abs(Add(Constant(-30.0),$low))
Mul(Constant(0.01),$low)
$volume
Abs(Mul(Constant(1.0),$volume))
Std(Mul(Constant(-1.0),Var(WMA(Max($open,50),30),30)),20)
Add(Constant(-1.0),$vwap)
Mul(Add(Add(Sub(Greater(Constant(-5.0),Div($high,Constant(-10.0))),Add($vwap,Sum($close,20))),Constant(1.0)),Constant(-30.0)),Constant(-30.0))
Add(Greater(Sum(Div($open,Constant(-0.5)),10),Constant(0.5)),$volume)
Sub(Add(Add(Sub(Constant(-5.0),$high),$low),Add(Mul(Div(Constant(-5.0),$low),Constant(-30.0)),$high)),Constant(5.0))
Mean(Mul(Abs(Add(Constant(1.0),Sub($open,Constant(-10.0)))),Mul(Sub($low,Constant(30.0)),Constant(-10.0))),50)
Div(Constant(-5.0),$volume)
Sub(Med(Div(Div($close,Constant(10.0)),$low),20),Constant(-10.0))
Mean(Delta(Add(Less(Greater(Constant(-5.0),$vwap),Delta($low,10)),Sum(Max($high,20),20)),30),50)
$open
Sub(Greater(Ref(Mul(Var(Add(Constant(-1.0),$vwap),50),Constant(-5.0)),40),Constant(-2.0)),Med($low,20))
Sub(Greater(Constant(-0.5),$high),$vwap)
Log(Min(Div(Less(Constant(-10.0),Add(Greater(Sub($vwap,Add(Constant(-10.0),Mul($close,Constant(-10.0)))),Constant(10.0)),$volume)),$low),40))
Mul(Div(Sub(Div(Constant(0.01),$low),Constant(-0.5)),$low),Constant(-1.0))
Sum(Ref(Var(EMA(Div(Log(Log(Div(Mul($vwap,Sub(Constant(-30.0),$low)),$vwap))),Constant(-1.0)),30),20),20),10)
Med($vwap,30)
$low
Med(Mul(Sub($close,$volume),Constant(1.0)),40)
Sub(Constant(-10.0),$close)
$high
Mul(Div(Constant(-5.0),$low),Constant(1.0))
Abs(Sub(Constant(30.0),Mean($volume,10)))
WMA(Sum(Div(Sub(Constant(-1.0),$low),$low),50),20)
Sub(Constant(-30.0),Add(Delta(Std($low,20),10),Constant(-1.0)))
Add(Abs($volume),Add(Constant(-2.0),$close))
Sub(Constant(-10.0),$low)
Mul(Constant(-1.0),Sub(Add($vwap,Constant(-0.01)),Constant(0.5)))
Sub(Mul(Sub(Mul(Add(Constant(10.0),Mul(WMA($close,20),Constant(-1.0))),$close),$vwap),Constant(1.0)),Constant(-2.0))
Mul(Abs(Div($volume,Constant(-5.0))),Constant(-0.5))
Div(Sub(Mul(Sub($low,Constant(-1.0)),Constant(-1.0)),Constant(-1.0)),$low)
Div(Constant(30.0),Add($low,Constant(-0.5)))
$open
Add(Constant(0.5),Sum($volume,20))
Sub(Constant(-10.0),$low)
Sub(Constant(0.01),Sub($high,Constant(0.01)))
$low
Div(Add(Add(Constant(30.0),$vwap),$vwap),Constant(0.01))
$low
$close
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104232632/26624_steps
------------------------------------------
| pool/                   |              |
|    best_ic_ret          | 0.102        |
|    eval_cnt             | 8            |
|    significant          | 7            |
|    size                 | 8            |
| rollout/                |              |
|    ep_len_mean          | 7.65         |
|    ep_rew_mean          | -0.03        |
| test/                   |              |
|    ic                   | 0.0323       |
|    rank_ic              | 0.0302       |
| time/                   |              |
|    fps                  | 42           |
|    iterations           | 13           |
|    time_elapsed         | 621          |
|    total_timesteps      | 26624        |
| train/                  |              |
|    approx_kl            | 0.0133643765 |
|    clip_fraction        | 0.172        |
|    clip_range           | 0.2          |
|    entropy_loss         | -2.49        |
|    explained_variance   | 4.17e-07     |
|    learning_rate        | 0.001        |
|    loss                 | -0.241       |
|    n_updates            | 120          |
|    policy_gradient_loss | -0.0287      |
|    value_loss           | 0.068        |
------------------------------------------
WMA($volume,40)
Mul(WMA(Mul(Constant(2.0),$vwap),20),Mul($volume,Constant(2.0)))
EMA($high,20)
Med(Mean(Ref(Div(Constant(5.0),$high),20),10),30)
Div($close,$high)
Add(Constant(-0.5),$low)
Div(Constant(-1.0),$vwap)
$high
Div(Constant(-2.0),Add(Sub(Mad($close,50),Sum($high,30)),Constant(-10.0)))
$close
Div($close,Constant(-0.01))
Sum(Add(Less(Constant(-1.0),$open),WMA($low,50)),10)
Abs(Sub(Constant(10.0),$low))
Div(Mul(Constant(-10.0),Mean(Sub($close,Constant(1.0)),40)),Abs(Mul($vwap,Constant(-30.0))))
Add(Constant(0.5),$high)
Mul(Greater(Greater(Constant(0.5),$volume),$high),$volume)
Div(Sub(Constant(-5.0),$volume),Add(Mad($volume,20),$open))
Sub(Constant(-5.0),$open)
Sub($close,Constant(-10.0))
Med(Sub(Constant(-10.0),$volume),30)
$volume
Add(Constant(30.0),Add($high,Constant(30.0)))
Mul(Constant(-10.0),$volume)
Sub(Div(Div($close,Div(Constant(-2.0),Abs(Div(Abs($close),Constant(-1.0))))),Constant(30.0)),$open)
Log(Div(Constant(-5.0),$vwap))
$vwap
Abs(Div(Constant(-1.0),Abs($close)))
EMA(Mad(Cov(Div(Constant(2.0),Add($high,Constant(-2.0))),Add($close,Sub($close,$volume)),40),40),50)
Med(Add(Sub(Sub(Greater(Constant(0.5),Var($open,40)),Sub($open,$vwap)),Constant(-10.0)),Constant(5.0)),50)
Add(Constant(-5.0),$low)
Add(Constant(1.0),Mean($vwap,10))
$vwap
Sub(Std(Add(Div(Constant(-10.0),Mul($close,$low)),Constant(0.5)),30),Constant(0.5))
Sum(Std(Sub(Mul(Mul(Add(Constant(-10.0),$low),Constant(-5.0)),$volume),Constant(30.0)),30),10)
Add(Constant(-1.0),$low)
$low
Mul($high,$low)
Add(Constant(-30.0),Abs(Std($high,10)))
Add(EMA(Greater(Mul(Constant(0.5),$close),$volume),40),Add($high,Constant(5.0)))
Add(Mean(Div(Add(Constant(10.0),$high),Constant(-5.0)),40),Sub(Constant(-0.5),$volume))
Abs(Mul(Add(Sub(Constant(-1.0),Mad($high,10)),Constant(-0.01)),Constant(-10.0)))
$high
Add(Constant(2.0),$low)
Mul(Constant(-30.0),Mul($vwap,$high))
Mean(Add(Constant(-2.0),$close),10)
Mul(Constant(0.5),$open)
Div(Constant(0.01),$low)
Add(Constant(-5.0),$close)
Sub(Constant(-5.0),$vwap)
Add(Add(Constant(-30.0),$vwap),Constant(-10.0))
Sub(Constant(30.0),$volume)
Add(Sub(Constant(-0.01),$low),Constant(10.0))
Div($volume,Constant(5.0))
Mul(Constant(-30.0),Abs($close))
Mul(Div(Sub(Greater(Div(Greater(Constant(-0.01),$close),$volume),Constant(-5.0)),$high),Constant(0.01)),Constant(-5.0))
Div(Mul(Constant(10.0),Var($high,40)),Constant(-5.0))
Div(Constant(0.5),Abs($low))
Add(Constant(-0.01),$low)
Std(Std($low,40),40)
Mean(Sub($volume,Constant(-5.0)),30)
Mean(Mul(Constant(-1.0),Max(Sub($volume,$volume),10)),40)
Add(Div(Less(Constant(-0.5),$low),$volume),Constant(5.0))
Div(Constant(1.0),$close)
Add(Mul(Add(Add(Constant(-30.0),$low),Constant(-1.0)),Constant(0.01)),Constant(-1.0))
Mul(Constant(-2.0),$close)
Mul(Sub(Constant(-10.0),$volume),$close)
$volume
Div($vwap,Less(Mean($close,40),Max(Div($close,$vwap),40)))
Add(Constant(10.0),$high)
Add(Add(Constant(-10.0),$low),Constant(-0.5))
Add(Constant(5.0),WMA($low,20))
Div(Constant(-30.0),$low)
$high
Mul(Mul(Var(Greater(Add(Constant(-30.0),$low),$vwap),40),Constant(0.5)),$vwap)
Add(Constant(-30.0),WMA(Abs($low),10))
$volume
Mul(Constant(-1.0),$volume)
Sub(Constant(2.0),Div(Log($close),Constant(-1.0)))
Abs($low)
Div(Div(Add(Constant(-1.0),Sum($high,10)),Std(Div($volume,Constant(0.01)),10)),Sub(Constant(-1.0),$volume))
Div(Constant(-10.0),Div(Max($vwap,30),Constant(0.01)))
Abs(Div(Mul(Constant(-1.0),$volume),Constant(0.01)))
Mul(Constant(-0.5),$volume)
Sub(Div(Constant(-5.0),$high),Constant(-10.0))
$close
Log($volume)
Ref(Div(Mul(Constant(2.0),Sub($high,Constant(-10.0))),Constant(10.0)),10)
Sub(Constant(0.5),$close)
Sub($high,Constant(-1.0))
Div(Constant(-0.5),$volume)
Min(Div(Mean(Mul(Constant(2.0),$low),50),Constant(2.0)),30)
Add(Constant(0.5),Max($vwap,20))
Add($vwap,Mul($close,$vwap))
Div(Constant(10.0),$close)
Std(Add(Constant(30.0),$volume),50)
Add(Constant(-0.01),Log($close))
Mul(Sub(Constant(-5.0),Add($open,Constant(-0.01))),Constant(1.0))
$vwap
Abs($volume)
Mul(Mul(Greater(Constant(2.0),$low),$close),$close)
$low
$volume
Greater(Sub(Add(Greater(Add(Constant(1.0),$close),Constant(-0.01)),Sum(Var($low,30),30)),Constant(-0.5)),$close)
$volume
Less(Div(Constant(10.0),$high),Sub(Constant(-1.0),$open))
Sub(Constant(30.0),$high)
Mul(Greater(Greater(Constant(5.0),Cov($close,$high,40)),$volume),$close)
$high
$volume
Log(Add(Constant(0.01),Add($vwap,$close)))
Mul(Constant(1.0),$vwap)
Log($low)
Div(Constant(-1.0),Sum(Sub($vwap,$close),20))
$low
Mul(Constant(0.01),$volume)
WMA(Add(Constant(-10.0),Mul($low,Constant(0.5))),20)
Sub(Constant(5.0),$vwap)
$volume
Log(Med($open,40))
Div(Sub(Constant(0.01),Delta($low,10)),Constant(5.0))
Mad(Mul(Constant(1.0),Sub($open,$close)),10)
$high
$low
Mul(Constant(2.0),Sum(Med($open,20),30))
Add(Mul(Constant(10.0),$low),Constant(0.01))
$volume
Mul(Div(Constant(-10.0),Med($vwap,10)),$close)
Std(Mul(Constant(2.0),$low),30)
$high
Add(Constant(5.0),Div(Mean($close,20),Constant(-5.0)))
Mean(Std(Add(Constant(-10.0),Mean($volume,40)),20),40)
Div(Constant(10.0),Sub(Mul($vwap,Constant(0.01)),Constant(-2.0)))
Add(Add(Constant(0.5),$open),Greater(Mul(Constant(-0.5),Mul(Min($open,40),Constant(-2.0))),Constant(-1.0)))
Add(Constant(-2.0),$vwap)
Sub(Constant(-0.01),Add($low,Constant(5.0)))
Sub(Greater(Constant(0.01),$volume),$low)
Sub(Add(Constant(1.0),$low),Constant(0.5))
$high
Abs(Add(Sub(Constant(-2.0),$close),$close))
Add(Constant(-10.0),$high)
$high
$volume
Std(Add(Constant(-1.0),$high),30)
Sub(Div(Less(Constant(-2.0),$vwap),$close),Constant(-5.0))
Mean($volume,30)
Med($low,40)
$close
WMA(EMA(Abs(Div(Constant(-1.0),$vwap)),20),40)
Var(Mul(Div(Constant(-0.5),$low),Constant(1.0)),30)
Mul(Constant(10.0),Mean($volume,20))
Div(Constant(-10.0),Sub(Sub($open,Constant(0.01)),$open))
Mul(Constant(2.0),$open)
Add(Constant(5.0),$volume)
Log(Med(Div(Constant(-10.0),$open),20))
Div(Constant(2.0),$close)
Sub(Constant(2.0),$low)
Div(Greater(Constant(1.0),$volume),Ref($high,40))
Med(Div(Constant(-1.0),$volume),10)
Min(Sub(Mean(Mul(Constant(1.0),$volume),20),Div($high,Constant(1.0))),40)
Add(Less(Constant(10.0),$high),Std(Sub(Log($volume),$high),10))
Sub(Constant(1.0),$close)
Add($high,$vwap)
Sub(Mul(Constant(-10.0),$close),Constant(5.0))
Sum(Sub(Constant(-1.0),$low),20)
$low
$open
Sub(Constant(30.0),$low)
Add(Constant(2.0),$low)
Sum(Sub(Add(Constant(2.0),$high),$volume),20)
$volume
Var(Mul(Constant(0.01),$low),30)
$close
Div(Constant(-10.0),$low)
$vwap
WMA(Mul($close,$high),40)
Mean(Mul(Constant(1.0),$low),10)
$close
Ref(Add(Constant(10.0),$high),20)
Sub(Constant(10.0),$high)
Div(Greater(Greater(Greater(Constant(-0.5),$close),$vwap),$volume),$close)
Mean(Log(Mul(Constant(-2.0),$high)),10)
Add(Constant(5.0),$vwap)
$volume
Div(Constant(-30.0),Sub($close,Div($open,Constant(-10.0))))
Std(Add(Constant(-10.0),$vwap),40)
Sub(Constant(-0.01),$high)
Div(Constant(-0.5),$close)
Greater(Max(Add(Constant(0.01),$close),10),Div($open,Constant(1.0)))
Abs(Add(Constant(-1.0),Mad($close,10)))
Std(Add(Constant(-5.0),$close),40)
$low
$vwap
Mean(Med(Mul(Greater(Constant(-0.01),$volume),$high),30),40)
Med(Add(Constant(-10.0),$vwap),20)
Abs(WMA(Abs(Mul(Sum(Sub(Greater(Constant(-1.0),$high),$volume),30),Log(Mul($close,$volume)))),10))
Sub(Constant(-5.0),$volume)
Div(Constant(0.5),$low)
Div(Constant(-0.01),$low)
Div(Constant(5.0),$low)
Mul(Sub(Add(Mul(Constant(-1.0),$volume),Constant(-1.0)),Constant(-10.0)),Constant(-30.0))
Abs(Max(Greater(Mean(Abs(Mul(Greater(Mul(Div(Constant(-1.0),$close),Constant(-5.0)),Constant(0.5)),$high)),50),$close),30))
Add(Constant(0.5),Add(Add($open,$close),Constant(5.0)))
$low
Mean(Var($close,20),30)
Std(Add(Constant(-0.01),Add($volume,Constant(-2.0))),10)
Add(Greater(Constant(0.5),Mean($vwap,20)),Sub($close,$open))
Max($high,30)
Mad(Mad(Add(Constant(0.5),$high),20),30)
Div(Greater(Med(Div(Constant(-1.0),$close),40),Constant(5.0)),Abs($high))
Add(Less(Constant(-0.01),Add(Greater($close,Constant(30.0)),$close)),Min($low,20))
Div(Abs(Abs($low)),Constant(-10.0))
Sub(Constant(-2.0),$low)
Sub(Greater(Greater(Constant(-0.5),$high),Abs($high)),$vwap)
Add(Log(Var(Sub(Add(Log(Mul(Less(Constant(-30.0),$volume),Add($high,Constant(10.0)))),Constant(0.01)),Constant(-10.0)),50)),Constant(-0.5))
Mul(Constant(-5.0),Div($volume,Constant(-1.0)))
Mean(Div(Constant(1.0),$low),20)
Var(Sub(Constant(2.0),Mean(Mul($high,Constant(-0.01)),30)),40)
Std($low,20)
Mul(Max(Mul(Constant(-0.01),Abs($low)),20),Constant(-0.01))
Div(Greater(Corr(Div(Add(Abs(Std(Add(Constant(-10.0),$open),30)),Constant(-0.5)),Constant(2.0)),Mul($low,$close),10),Constant(-0.5)),$close)
Div(Constant(-10.0),$low)
Mul(Constant(-10.0),Add(Greater($close,Mul(Constant(5.0),$close)),$low))
Add(Add(Add(Constant(2.0),$low),$close),Constant(-10.0))
$low
Std(Add(Add(Constant(-10.0),$vwap),Constant(30.0)),30)
Abs($high)
Log(Abs(Sub(Sub(Constant(-10.0),$close),Constant(0.5))))
Add(Abs(Add(Constant(0.01),Mul($low,$volume))),Constant(-0.01))
Add(Constant(30.0),$high)
Std(Med($open,20),40)
Div(Mean(Mul(Constant(-10.0),$low),40),Constant(-1.0))
$vwap
Mul(Constant(-0.01),$vwap)
Mul(Abs(Add(Constant(0.5),$volume)),Constant(-2.0))
$low
$close
$vwap
$volume
$volume
Mul(Constant(30.0),$low)
$high
$high
Div(Less(Max(WMA(Div(Less(Constant(-0.5),$vwap),Std($low,30)),20),20),Constant(-10.0)),Sum(Mean($close,50),30))
WMA(Sub(Constant(-10.0),Add($volume,Constant(-1.0))),20)
Div(Constant(10.0),$volume)
Add(Mul(Constant(-0.01),Sub($vwap,Constant(5.0))),Constant(-5.0))
$close
Mul(Greater(Constant(-1.0),$vwap),Add($high,Constant(30.0)))
Add(Sub(Sub(Mad(Add(Constant(2.0),Div($close,Constant(-30.0))),30),Constant(-10.0)),Constant(10.0)),Constant(0.01))
Abs($volume)
Div(Constant(-30.0),Sum($low,30))
Mul(Min(Sub(Greater(Constant(-1.0),Std($high,30)),Abs(Mean(Add($open,Add($close,Constant(-10.0))),50))),40),Constant(-5.0))
Add(Constant(0.01),$high)
Add(Div(Constant(-0.5),$high),Constant(5.0))
$close
Div(Mul(Mul(Add(Constant(-30.0),Sub($volume,Constant(30.0))),Constant(30.0)),Constant(-2.0)),Constant(-30.0))
Add(Mul($volume,Constant(-10.0)),Constant(-10.0))
Add($open,Constant(-30.0))
Add(Greater(Greater(Greater(Greater(Add(Sub(Constant(-1.0),Add($low,Constant(-1.0))),Constant(-10.0)),Constant(-2.0)),$volume),$high),$vwap),$volume)
Mul(Mul(Constant(0.5),$high),Constant(-1.0))
Sub(Sub(Constant(-1.0),WMA(Add(Sub($close,Constant(-10.0)),Constant(-10.0)),10)),Constant(5.0))
$close
Sub(Log(Add(Constant(-10.0),$volume)),Constant(-10.0))
Std(Mean($vwap,50),10)
WMA(Mul(Constant(-0.5),Sub($close,$close)),10)
Sub(Constant(-0.5),Sub($close,Constant(-10.0)))
Mul(Mean(Mean(Div(Sub($low,Constant(-10.0)),Constant(10.0)),30),10),Constant(10.0))
Mean(Mul(Constant(-1.0),$vwap),20)
$vwap
Add(Greater(Constant(-0.01),$high),$open)
Add(Less(Div(Mul(Constant(-5.0),$close),Mul($volume,Constant(-0.01))),Constant(0.01)),$volume)
Mul(Greater(Constant(-2.0),$low),$low)
Add(Sub(Greater(Mul(Constant(2.0),$close),Constant(1.0)),$low),$low)
$low
$open
Std($close,40)
Sub(Constant(30.0),$low)
Mul(Constant(1.0),Med($vwap,20))
Div(Constant(5.0),$low)
$high
Var(Log(Mul(Constant(-10.0),$close)),30)
Mul(Add(Sum(Med(Min(WMA(Div($volume,$volume),30),20),20),10),Constant(-1.0)),Constant(-0.5))
Var(Div(Mul(Constant(30.0),$close),Constant(-10.0)),30)
Add(Constant(-0.01),$low)
$close
WMA($close,10)
Mul(Constant(-5.0),$high)
Add(Less(Constant(-10.0),Div($volume,Constant(-2.0))),Sub(Less(Div(Std($vwap,20),Constant(0.5)),Constant(30.0)),$low))
Add($close,Constant(-10.0))
$high
Add(Add($low,Constant(-30.0)),$low)
Delta(Mul(Greater($high,Constant(-10.0)),Min($high,30)),50)
$close
Min(Mul(Constant(10.0),Mul(Mul($open,Constant(-5.0)),Constant(-30.0))),50)
Mul(Greater(Constant(-5.0),$close),Less(Abs($close),$vwap))
Add(Constant(-0.01),$close)
Med(Add(Mad(Med(Add($close,$low),30),40),Constant(30.0)),10)
$high
Div(Constant(5.0),$high)
$vwap
Mul(Constant(-1.0),Mul($high,Constant(10.0)))
Cov(Mean(Div(Constant(-1.0),$open),10),$high,10)
Mul(Constant(-5.0),$high)
Div(Constant(-30.0),$low)
$low
Std(Std(Mean($low,30),40),20)
Div(Add(Add(WMA(WMA(Mul($low,$vwap),10),10),Constant(-5.0)),Constant(2.0)),Constant(30.0))
Med(Std(Mul(Greater(Constant(-0.5),$vwap),Add(Mean($high,20),Constant(-0.01))),30),10)
Sub(Constant(0.5),$low)
Mean(Add(Sub(Constant(-10.0),Mean($close,10)),Constant(2.0)),30)
Mad(Sub(Constant(-0.5),$high),30)
Div($open,Constant(1.0))
Sub(Constant(-30.0),$low)
Div(Constant(5.0),$volume)
Mul(Div(Constant(0.5),$low),Constant(30.0))
Mad(Mul(Constant(-0.01),Add(Std(Abs($low),30),Div(Constant(-30.0),$open))),30)
Mean(Div(Constant(-5.0),Min(Max($close,20),20)),20)
Add(Sub(Constant(10.0),$volume),Constant(2.0))
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104232632/28672_steps
-----------------------------------------
| pool/                   |             |
|    best_ic_ret          | 0.102       |
|    eval_cnt             | 8           |
|    significant          | 7           |
|    size                 | 8           |
| rollout/                |             |
|    ep_len_mean          | 6.66        |
|    ep_rew_mean          | -0.02       |
| test/                   |             |
|    ic                   | 0.0323      |
|    rank_ic              | 0.0302      |
| time/                   |             |
|    fps                  | 42          |
|    iterations           | 14          |
|    time_elapsed         | 675         |
|    total_timesteps      | 28672       |
| train/                  |             |
|    approx_kl            | 0.017635316 |
|    clip_fraction        | 0.204       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.43       |
|    explained_variance   | 2.98e-07    |
|    learning_rate        | 0.001       |
|    loss                 | -0.256      |
|    n_updates            | 130         |
|    policy_gradient_loss | -0.0186     |
|    value_loss           | 0.0304      |
-----------------------------------------
Div(Less(Constant(0.01),$vwap),Std(Mul(Add($close,Constant(-10.0)),Constant(-5.0)),50))
Mul(Constant(-30.0),$high)
Add(Constant(-1.0),$low)
Log(Greater(Add(Less(Greater(Constant(-1.0),$open),Add(Mean(Mean($low,10),20),Constant(-1.0))),$low),$vwap))
Add(Constant(10.0),Mul($high,$vwap))
$high
Sub(Constant(-1.0),$low)
$close
$vwap
Mul($high,Constant(1.0))
Add(Less(Constant(-0.01),$close),$low)
Abs(Sub(Constant(-0.5),$low))
Med(Mul(Constant(5.0),Std($close,10)),20)
Mad(Div(Mul(Add(Constant(30.0),$vwap),$open),Constant(-0.5)),20)
Abs(Delta(Greater(Div(Constant(30.0),$high),Div(Constant(-1.0),$high)),20))
$close
$low
Var(Mul(Constant(30.0),$volume),40)
Sub(Less(Add(Add(Sub(Constant(30.0),Mul(Greater($low,Constant(-1.0)),$close)),Constant(-0.5)),Constant(-10.0)),Constant(1.0)),Mul(Log($close),Constant(-30.0)))
Div(Greater(Less(Greater(Constant(5.0),$vwap),$open),$vwap),$vwap)
Log($open)
Sub(Less(Constant(10.0),Max($high,20)),$low)
Mul(Constant(-1.0),Mul(Log($low),Mul($open,Constant(-10.0))))
Log(Mul($vwap,Constant(-2.0)))
Div(Greater(Std(WMA(Mul(Abs(Div(Constant(-5.0),$vwap)),Constant(1.0)),20),10),Constant(-5.0)),Cov(Std($low,10),$low,10))
Mul(Constant(1.0),Mul($close,Constant(-0.5)))
Mean(Div(Less(Constant(-10.0),Std(Div(Mul(Greater(WMA($low,40),Constant(-10.0)),$vwap),$high),10)),$close),40)
Div(Add(Constant(-1.0),Std(Mul(Mul($low,Constant(-0.01)),Constant(2.0)),50)),Constant(-2.0))
Div(Constant(-2.0),Min($vwap,50))
Abs(Sub(Constant(10.0),$vwap))
Add(Constant(-10.0),$high)
Med(Add(Constant(-0.5),$open),40)
Mean(Add(Constant(-1.0),$low),10)
Add(Constant(-10.0),Mul(Greater(Mul(Log(Max(Ref($open,20),40)),Mul(Constant(0.5),$close)),Constant(1.0)),$open))
$open
Add(Constant(2.0),$close)
$low
Mul(Constant(-10.0),$high)
$high
Sub(Greater(Greater(Constant(-30.0),$close),Ref($close,50)),$volume)
Add(Constant(0.01),$close)
Div(Greater(Greater(WMA(Mul(Var($high,40),Constant(-30.0)),40),Constant(-1.0)),$open),Var($high,20))
Sub(Greater(Constant(-0.5),$low),$volume)
Mul(Greater(Mean(Abs(Mean(Div(Div($volume,Constant(10.0)),Constant(-2.0)),30)),20),Constant(-10.0)),Abs($close))
Mul(Div(Constant(0.5),Ref(Add(Greater(Less(Mad($close,50),Constant(5.0)),Sub($volume,Constant(-0.01))),$close),30)),Constant(-0.5))
Div($close,$volume)
Std(Abs(Mul(Mul(Constant(-30.0),Cov(Mul(Greater(Greater($low,Constant(5.0)),Var($vwap,20)),$close),$low,50)),$high)),40)
Var($close,20)
Div(Mad(Mul(Constant(-0.5),Delta($volume,20)),40),Constant(10.0))
Ref(Mul(Add(Greater(Less(Constant(1.0),$low),$volume),Min($low,10)),Constant(2.0)),20)
Abs(Mul(Less(Less($open,Constant(5.0)),Mul($vwap,Constant(-10.0))),Mean(Med(Log($high),20),40)))
Mean(Std(Add(Constant(30.0),$vwap),40),50)
Add(Div(Sub(Mul(Constant(-1.0),$low),Constant(30.0)),Constant(-2.0)),Constant(2.0))
$open
Log(Mul(Std(Add(Constant(-10.0),$vwap),50),Constant(0.5)))
Abs(Log(Sub(Abs(Div(Greater(Constant(30.0),$volume),$low)),Constant(5.0))))
Div(Mul(Less(Med(Sub(Div(Less(Constant(-2.0),$high),$close),Constant(0.01)),30),Constant(5.0)),Add(Add($vwap,Constant(0.01)),Constant(-0.01))),$vwap)
Log(Max(Add(Greater(Constant(0.5),$vwap),$volume),40))
$close
$vwap
Mul(Less(Mul(Less(Constant(1.0),$low),Cov(Mul($vwap,Constant(1.0)),$volume,20)),Constant(2.0)),$volume)
Mul(Sub(Constant(30.0),$vwap),$volume)
Sub(Constant(-0.5),$low)
Less($open,$high)
Var(Add(Constant(-0.5),$low),20)
Div(Abs(Abs(Add(Greater(Constant(0.01),$low),$vwap))),$vwap)
Abs(Div(Constant(-10.0),$close))
Mul(Constant(10.0),Var($low,40))
Mul(Constant(-10.0),Div(Log($low),Constant(-0.5)))
Div(Constant(-10.0),$high)
Add(Less(Constant(0.01),Div(Greater(Greater($volume,Constant(-0.5)),Sub(Greater($volume,$open),$low)),Med($low,30))),Sum($close,50))
Sub(Log(Sub(Constant(-2.0),$low)),Constant(-2.0))
$volume
Add(Greater(Constant(30.0),WMA(Add($volume,Mul(Constant(0.01),$high)),40)),Sub(Greater($close,Constant(-1.0)),Abs(Sub($low,Constant(1.0)))))
Add(Less(Constant(1.0),$volume),$volume)
Div(Constant(-10.0),$open)
Add(Greater(Constant(-30.0),Std(Mad(Abs($open),10),30)),$vwap)
Sub(Greater($high,Constant(-30.0)),$vwap)
Ref(Var(Add(Mul(Constant(-30.0),$open),$high),20),10)
Mul(Less(Greater($low,Constant(-1.0)),Mul(Div($open,$low),Constant(-10.0))),Mul(Less(Greater($close,Constant(30.0)),Add($low,Constant(-10.0))),$low))
Std(Mul(Constant(2.0),$low),40)
Mul(Add(Constant(30.0),Abs($vwap)),Constant(-0.5))
Mean(Abs(Mul(Div(Constant(-1.0),$close),Constant(0.01))),10)
Mad(Add(Constant(0.01),$high),20)
Add(Div(Constant(30.0),Add($low,Sub($vwap,Constant(-10.0)))),Constant(-1.0))
Abs(Mul(Greater(Constant(0.5),Mean($low,40)),Med($open,10)))
Greater(Log(Add(Constant(-0.5),$high)),$open)
Mul(Greater(Sub(Less(Constant(2.0),$low),$volume),Constant(1.0)),$close)
Sub(Abs(Add(Constant(30.0),$vwap)),Constant(-30.0))
Min(Sub(Div(Constant(-0.01),$high),Constant(-0.5)),50)
Log($vwap)
Var(Med($vwap,40),30)
Sub(Constant(-5.0),Mul($low,Constant(-0.5)))
Abs(Add(Greater(Std(Add(Constant(-30.0),Ref(Std($high,40),20)),30),Constant(-5.0)),$high))
Mul(Constant(-30.0),$close)
Add(Constant(-0.01),$close)
Sub(Less(Add(Sub(Constant(-10.0),$volume),Constant(1.0)),Constant(-0.5)),$open)
Sub(Constant(-2.0),$volume)
Add($high,Constant(-0.01))
Ref(Add(Constant(0.01),$open),20)
Add(Log(Add(Greater($vwap,Constant(0.01)),$high)),Constant(0.5))
Var(Min(Add(Constant(-5.0),$volume),10),50)
$vwap
Div(Mul(Constant(-1.0),$open),Constant(0.01))
Mul(Log(Mul(Constant(5.0),$vwap)),Constant(2.0))
Div(Delta($open,40),Constant(2.0))
Log(Sum(Less(WMA(Add(Constant(0.5),$open),20),Mul($low,Greater(Constant(-2.0),$vwap))),40))
Div(Sub(Constant(0.5),$low),Constant(-0.01))
Mean(Mul(Abs(Div(Constant(-0.5),$volume)),Constant(-10.0)),10)
Mean(Med(Div(Constant(-0.5),$low),10),30)
Div(Less(Greater(Constant(-30.0),$volume),Mul($close,$high)),$volume)
Mul(Mul(Ref(Mad(Sub(Constant(-5.0),$volume),20),50),Constant(-10.0)),Constant(-0.5))
WMA(Add(Mean(Sub(Abs(Add(Constant(30.0),$close)),Constant(0.01)),40),Constant(0.01)),40)
Sum(Add(Constant(-10.0),Mul(Greater(Abs($vwap),Constant(0.01)),Sum($high,20))),20)
Greater(Add(Constant(-5.0),Mul($volume,Constant(2.0))),$open)
Add(Less(Greater(Constant(0.01),$volume),Mad($open,10)),$low)
Abs(Add(Constant(30.0),Std($open,50)))
Less(Sub(Constant(-0.5),Sub(Greater(Std(Div($high,Constant(-10.0)),40),Constant(30.0)),$open)),$high)
Mul(Mul(Greater(Constant(-1.0),$close),$vwap),Greater($volume,Mul(Mul($high,Constant(-2.0)),Constant(0.01))))
Div(Constant(1.0),$close)
$close
Add(Div(Constant(-2.0),$low),$high)
$open
Add(Mean(Mul(Constant(2.0),$vwap),20),Constant(-1.0))
Var(Sub(Abs($volume),Constant(30.0)),10)
$high
Mul(Greater(Constant(5.0),Abs(Add(Sub($open,$open),Constant(-30.0)))),$low)
Div(Greater(Greater(Sub(Div(Constant(-5.0),$vwap),Constant(-0.5)),Constant(1.0)),$low),$close)
Mul(Sub(Greater(Mul(Less(Constant(30.0),$low),Abs($open)),Constant(10.0)),$vwap),Constant(-1.0))
Add(Constant(10.0),Mul(Greater($close,Constant(-10.0)),$high))
$low
Mul(Constant(0.5),$high)
Mul(Constant(2.0),$volume)
Mean(Mad(Mean(Mul(Add(Constant(-30.0),Abs($close)),Constant(-0.5)),30),40),40)
Div(Greater(Sub(Greater(Greater(Sub(Constant(-1.0),$vwap),Constant(-0.01)),Log($low)),Mad($low,40)),Constant(-0.5)),Min($high,10))
Greater(WMA(Abs(Mul(Mul($close,$vwap),$volume)),40),$close)
$close
Div(Constant(-10.0),$low)
Add(Constant(-1.0),$low)
Ref(Div($close,Constant(30.0)),10)
Mul(Div(Mul(Greater(Log(Sum($close,20)),Constant(-0.01)),$low),Min($vwap,40)),Constant(0.5))
Mul(Greater(Constant(-5.0),$vwap),$vwap)
Max(Sub(Constant(-2.0),$open),40)
$vwap
Add(Std($vwap,20),$low)
Mul(Less(Constant(30.0),$low),$low)
Mul(Constant(-0.5),Max($low,20))
Add(Constant(-10.0),$volume)
Mul(Constant(0.01),$low)
Sub(Constant(5.0),$close)
Sub(Greater(Div(Constant(30.0),Abs(Div(Corr(Mul(Greater($volume,Constant(-2.0)),$low),$close,40),$high))),Constant(-10.0)),Mul($low,Constant(-2.0)))
Div(Constant(0.01),Div(Add(Sub(Greater($volume,Constant(-1.0)),$high),Abs($low)),Constant(1.0)))
Greater(Abs(Log(Div(Constant(-30.0),$close))),Log(Abs($vwap)))
WMA(Sub(Greater(Constant(0.01),$high),Log(Sub(Mul($high,$open),Constant(0.01)))),20)
Add(Div(Less(Add(Constant(0.01),$low),Constant(5.0)),$low),Constant(30.0))
Sub(Min(Div(Constant(30.0),$open),40),Constant(-2.0))
Sub(Constant(10.0),Sub(Sub($high,Constant(-0.01)),$vwap))
Add(Constant(-10.0),$vwap)
Add(Less(Less($close,Constant(-1.0)),$volume),$vwap)
Add($close,Constant(5.0))
Mul(Constant(2.0),$close)
Mul(Ref(Mul(Constant(-5.0),$volume),20),Constant(-30.0))
Sub(Constant(-1.0),$vwap)
Div(Greater(Constant(-0.5),Add(Log($open),Constant(-30.0))),$low)
Mul(Greater(Div(Mul(Mul($volume,Constant(-1.0)),Constant(10.0)),Constant(-10.0)),Constant(-2.0)),$volume)
Abs(Log(Max(Mul($low,Mul($low,Constant(0.01))),20)))
$vwap
$vwap
Med(Sub(Constant(0.01),$volume),50)
$volume
Mul(Less(Constant(5.0),WMA($low,50)),Max($high,40))
Sub(Med(Mul(Cov(Add(Constant(-0.5),Mean($close,40)),$volume,40),Constant(-0.01)),20),Constant(5.0))
Sub(Less(Constant(-30.0),$volume),$open)
Div(Constant(-5.0),$close)
Abs(Add(Constant(-10.0),$open))
Mul(Greater(Constant(-0.5),$volume),Add(Greater(Greater(Less($volume,Constant(5.0)),Sub(Cov($vwap,$vwap,40),Constant(10.0))),$vwap),$close))
Add(Sub(Greater(Add(Add(Greater(Constant(10.0),Abs($volume)),$volume),Constant(1.0)),$high),Constant(-1.0)),$close)
Max(Div(Less($low,Constant(-1.0)),$open),30)
Div(Mul(Greater(Add(Constant(-30.0),$volume),Constant(0.01)),Mul($vwap,Abs(Div(Constant(0.5),$volume)))),Greater($close,Constant(-10.0)))
Sub(Less(Var(Div(Constant(0.01),Abs($volume)),50),Constant(5.0)),$high)
Less(Add(Constant(-1.0),$low),$low)
Log(Sub(Greater(Greater(Constant(30.0),Sub($open,$low)),$open),$open))
Less(Greater($vwap,$low),$low)
$close
Add(Greater(Med(Mul(Constant(0.5),$low),20),Greater(Constant(-1.0),$low)),Add($close,Constant(-0.5)))
Mul(Less(Greater(Constant(1.0),$volume),$volume),Mul($volume,Constant(30.0)))
Div(Constant(0.01),$close)
$low
Mul(Mul(Delta(Mean(Add(Constant(2.0),$low),40),20),Constant(-0.01)),Constant(-1.0))
Sum(Abs($low),40)
$close
Mul(Constant(10.0),$vwap)
Less(Sub(Constant(10.0),Mul($close,Constant(1.0))),Abs($vwap))
Greater(Log(Div(Constant(-0.01),Add(Greater(Less($close,Constant(10.0)),$low),$open))),$open)
Div(Add(Constant(-5.0),$low),Constant(30.0))
Div(Constant(10.0),$low)
Mul(Constant(-2.0),$low)
Mad(Add(Constant(5.0),$close),20)
Add(Constant(-0.01),$low)
Abs($close)
Add(Greater($close,Constant(-1.0)),Abs(Sub($volume,Constant(-0.01))))
Div(Sub(Less(Mul(Mul(Add(Constant(-5.0),Abs(Sub(Greater(Log($volume),Constant(0.01)),$volume))),Constant(-5.0)),Constant(30.0)),Constant(-30.0)),$volume),$close)
Sub(Constant(-1.0),Div($vwap,Constant(-1.0)))
Add(Constant(-1.0),Sub(Greater(Log(Med($volume,20)),Constant(1.0)),$close))
Mul(Constant(-10.0),$open)
Add(Constant(0.01),$close)
Abs(Med(Sub(Constant(-1.0),Add($close,Constant(-30.0))),20))
Med(Add(Less(Constant(2.0),Add($vwap,Constant(0.01))),Greater(Greater($high,$volume),$high)),40)
Mul(Constant(-1.0),$high)
Add(Add(Greater(Constant(0.01),Abs($high)),Greater(Sub($close,Constant(1.0)),$volume)),Constant(-1.0))
Max($vwap,20)
Add(Constant(-5.0),$low)
Mul(Div(Constant(-2.0),Cov($volume,$low,20)),Constant(-1.0))
Log(Sub(Constant(1.0),$low))
Abs($vwap)
Med(Div(Constant(-0.01),Add($open,Constant(-1.0))),30)
$volume
Mul($low,Constant(5.0))
Sub(Constant(-5.0),$close)
Sub(Greater(Constant(1.0),$close),Add(Div(Abs($high),$vwap),$high))
Sub(Constant(-1.0),$high)
$volume
$vwap
Mul(Constant(-2.0),Mul(Add($volume,Constant(-5.0)),Mul($low,$open)))
Sub(Constant(-30.0),$open)
Mul(Greater(Add(Mul(Add(Constant(2.0),Log($vwap)),Constant(5.0)),$open),Constant(2.0)),Abs(Mul(Less($vwap,Constant(10.0)),$low)))
Mul(Sub(Mean(Add(Add(Constant(-30.0),Add(Abs(Log(Add(Greater($high,Constant(-1.0)),$close))),Constant(1.0))),$high),40),Constant(-0.01)),Constant(-2.0))
$volume
Add(Constant(-0.5),$high)
Mul(Mul(Constant(2.0),$high),Constant(-1.0))
Mul(Less(Constant(-2.0),Mean($open,30)),$high)
Add(Sub(Greater(Greater(Less(Constant(-1.0),$low),$open),Add($low,Greater(Constant(-1.0),$high))),$volume),Constant(-0.5))
Delta(Add(Constant(-0.01),Greater($high,Add($close,Max($high,50)))),40)
Div($open,$low)
Add(Constant(-30.0),$vwap)
Mul(Sub(Abs(Mul(Add(Constant(5.0),$vwap),Less(Constant(-10.0),$low))),Constant(-10.0)),Constant(-5.0))
Add(Abs($low),Constant(-1.0))
$volume
Sub(Greater(Constant(-30.0),$high),$volume)
Mul(Add(Log(Sub(Constant(0.5),Sub($vwap,Constant(-0.01)))),Constant(-10.0)),Var($high,20))
Mul(Constant(-1.0),Div(Cov($high,$low,40),$vwap))
Div(Constant(1.0),Mul($high,Constant(0.01)))
$open
Saving model checkpoint to /Users/yangguangyu/Projects/QuantLearning/research/test_result/alphagen/new_hs300_200_5_20240104232632/30720_steps
----------------------------------------
| pool/                   |            |
|    best_ic_ret          | 0.102      |
|    eval_cnt             | 8          |
|    significant          | 7          |
|    size                 | 8          |
| rollout/                |            |
|    ep_len_mean          | 8.06       |
|    ep_rew_mean          | -0.04      |
| test/                   |            |
|    ic                   | 0.0323     |
|    rank_ic              | 0.0302     |
| time/                   |            |
|    fps                  | 42         |
|    iterations           | 15         |
|    time_elapsed         | 727        |
|    total_timesteps      | 30720      |
| train/                  |            |
|    approx_kl            | 0.03313314 |
|    clip_fraction        | 0.264      |
|    clip_range           | 0.2        |
|    entropy_loss         | -2.47      |
|    explained_variance   | 7.15e-07   |
|    learning_rate        | 0.001      |
|    loss                 | -0.263     |
|    n_updates            | 140        |
|    policy_gradient_loss | -0.0124    |
|    value_loss           | 0.0132     |
----------------------------------------
[75248:MainThread](2024-01-04 23:39:23,532) ERROR - qlib.workflow - [utils.py:41] - An exception has been raised[NameError: name 'minmax_proc' is not defined].
  File "/Users/yangguangyu/Projects/QuantLearning/research/alphagen/train_maskable_ppo.py", line 252, in <module>
    fire.Fire(fire_helper)
  File "/Users/yangguangyu/anaconda3/envs/quant_dev/lib/python3.9/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/Users/yangguangyu/anaconda3/envs/quant_dev/lib/python3.9/site-packages/fire/core.py", line 475, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/Users/yangguangyu/anaconda3/envs/quant_dev/lib/python3.9/site-packages/fire/core.py", line 691, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/Users/yangguangyu/Projects/QuantLearning/research/alphagen/train_maskable_ppo.py", line 244, in fire_helper
    main(_seed,
  File "/Users/yangguangyu/Projects/QuantLearning/research/alphagen/train_maskable_ppo.py", line 226, in main
    joblib.dump(minmax_proc, f'{name_prefix}_{timestamp}_minmax.pkl')
NameError: name 'minmax_proc' is not defined
